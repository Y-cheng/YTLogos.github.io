<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="R,visualization,ggplot2," />





  <link rel="alternate" href="/atom.xml" title="Logos" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="简介本文内容基本是来源于STHDA，这是一份十分详细的ggplot2使用指南，因此我将其翻译成中文，一是有助于我自己学习理解，另外其他R语言爱好者或者可视化爱好者可以用来学习。翻译过程肯定不能十全十美，各位读者有建议或改进的话，十分欢迎发Email(tyan@zju.edu.cn)给我。">
<meta name="keywords" content="R,visualization,ggplot2">
<meta property="og:type" content="article">
<meta property="og:title" content="ggplot2高效实用指南">
<meta property="og:url" content="https://ytlogos.github.io/2017/09/19/ggplot2高效实用指南/index.html">
<meta property="og:site_name" content="Logos">
<meta property="og:description" content="简介本文内容基本是来源于STHDA，这是一份十分详细的ggplot2使用指南，因此我将其翻译成中文，一是有助于我自己学习理解，另外其他R语言爱好者或者可视化爱好者可以用来学习。翻译过程肯定不能十全十美，各位读者有建议或改进的话，十分欢迎发Email(tyan@zju.edu.cn)给我。">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/emJBf4A306.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/DlJaE4eke3.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/i3lHIh2jdD.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/D6Aflkkhab.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/92K2e20idg.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/3m8H660Cl9.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/Hb7G4J8875.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/gd448CcLDb.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/dl77b5BDdm.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/80fkCC4Kgh.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/6LbL12Jmhm.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/D3ca6EAf3F.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170916/gcLBC7cG47.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/J288ccH2m5.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/LIj4mJbKb2.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/kkCc85KCeJ.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/c1EL7I2a49.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/72Ahbf7K6h.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/ejijLE9IfG.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/mAFhH7lleK.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/H1mDL0HCJI.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/6bfHaEcBAl.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/kiE9Lci30h.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/K40Fch448J.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/CgCf1eAgf8.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/jaaBibcFjH.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/bHilai3a9l.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/eD7iLDJId1.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/f83Imkm4jm.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/e7G7hbeLID.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/b4FJFb7H99.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/ih6I2ammG4.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170916/ld1EAJgd88.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/796GlJi3Al.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/J6dfJ1EL33.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/3695bEj0Ha.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/1hJGKGeLc2.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/Gl47fkb2c2.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/6jaCLAL3Fc.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/7hjfJ89K4c.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/l0F005kgih.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/7H7BlJE35k.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/Ad2aBaaEED.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/DmKBbIGK2c.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/L6CaLD26ga.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170916/mIdJKh6F1G.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/BgC3g377mE.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/4ejegHkcbF.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/f9Fbl2IAKj.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/bIc44CGdC8.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/imG9fLLlb6.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/dj4fHa6Kh2.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/DhLc531J92.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/l5lHl5944G.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170916/3F447J6d7L.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/37J7f7hfCJ.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/952cibHB9E.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/15dJjbIGkB.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/Am1A6Efaa6.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/jfFFF1Hh99.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/fG1DmbmaIB.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/GAkDaEHJe2.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/igef2H376K.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/g6G0aI5DaE.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/60aB2FKkBj.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/B1A5h69HDF.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/JkebcfeiHH.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/DGm19F7hde.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/AGABHiI43E.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/KE0EHFl7h0.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/GF9c4kHDKI.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/238j5KGmEB.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/lEADE3fA1h.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/7lKfKkE5d6.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/Bjl125A2Im.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/j9e39B9cKB.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/FF7A37l9j4.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/hBa9871IE9.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/HIGAAJLiFl.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/LGFlfJGmHi.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/dLGm6lij04.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/Di23jj9kC9.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/c8Fh5DI7cE.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/521m2AHCDg.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/18EIA26lgI.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/jH5eDIHjHL.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/jcBCFdKlmH.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/6c5A4l9d2D.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/3e3Ic9486G.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/HLJe8aLajg.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/2E0aKa6GgJ.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/1GllA47ajF.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/2KAK9FgCDF.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/G3cJmg13EI.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/95BJEFgb1c.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/5kAAd2dhJl.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/gb1G7K8D25.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/HBjmlf502b.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/E3K5E0cg9B.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/I05fI783fH.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/LL96JDbLi4.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/FDdmmgjJL5.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/Gj3I6E4Kh6.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/hKCeGeja0m.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/FKG84CB8f1.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/c5iBDliiKB.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/lF9GiCg023.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/ebGE0KdHlc.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/BHJd8191Am.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/h0dhdgD0H5.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/28K0J6j688.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/0Fe5dGADJi.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/Afhm8Dbaa3.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/dLAe8a3a7K.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/52gIJkL4Fj.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/akg12aak7l.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/7AgB3J5C56.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/jB9CJj91hj.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/AbFBaAl2a3.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/AcKFcEl5j4.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/L09ec6fJdi.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/dm838FcDID.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/39aG8c99CA.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/6lAKJH6FcI.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/5l8CkJeG3b.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/mlmKH9mDm0.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/fdgD6lfCLK.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/I4K7c25E00.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170917/2mh2le2j13.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/el4C3gckcd.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/5B3cgiFbH6.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/DfKHLjH6mm.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/g4mj6HBA2d.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/jemKdg7ai2.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170917/g7gjFCb420.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/EG65iAcdaI.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/mKAb95CAk6.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/Cj4aedai9j.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/0EAk2aFEJG.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/8A620eJKDl.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/D6ick1LI9i.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/80EK39ebBA.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/cdfK8keKee.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170917/2gAL9gilee.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/leH2fj5jf7.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/j9EajEBa9b.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/hj1eIbED8J.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/DIL3A3j3H0.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/dllCEkgbJd.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/HIE1djID57.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/DldJFIi1jG.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/kdb786kHb6.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/mhE0cglig4.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/45E5EkIbmH.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/cbia8kk48E.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/cbia8kk48E.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/m44Dlla2Cl.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/90aD77ldKb.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/mI8LDhgJE9.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/F94egDhaID.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/L68AbbdeH9.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/22F52FHA0H.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/7k09a4DhDb.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/lmmg7BEa1m.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/EFbiHLHg4H.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/7b8a55d8e6.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/KEBgH9eL6A.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/6mAgGel8FI.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/1Gfa1ki6jd.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/67LdJdeHJJ.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/lKBLj42Fmb.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/klELKdJ7h2.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/5cIFlhkK0E.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/Jci00jI819.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/1gAEcm93JF.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/CgC7HHLid5.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/hD4HaiCDJI.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/HCFl1ha75C.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/3AfigK2AIl.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/e5hdDE7FE0.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/F3BgFeHc3C.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/9112kbBA9g.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/bjm9fk0k79.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/65F4K0ajaI.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/13Cf1kA3Jc.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/J2bH42IjHA.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/1iblgciCm8.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/01D9L4A8Ld.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/DaHcfl9dId.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/KE5JcFmdhl.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/LHeG17JljH.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/8AK62ii9Ib.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/HBF135cLAA.png?imageslim">
<meta property="og:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/DhI4Ha1m91.png?imageslim">
<meta property="og:updated_time" content="2017-09-19T04:22:05.904Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ggplot2高效实用指南">
<meta name="twitter:description" content="简介本文内容基本是来源于STHDA，这是一份十分详细的ggplot2使用指南，因此我将其翻译成中文，一是有助于我自己学习理解，另外其他R语言爱好者或者可视化爱好者可以用来学习。翻译过程肯定不能十全十美，各位读者有建议或改进的话，十分欢迎发Email(tyan@zju.edu.cn)给我。">
<meta name="twitter:image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/emJBf4A306.png?imageslim">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://ytlogos.github.io/2017/09/19/ggplot2高效实用指南/"/>




<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    .pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style>

  <title>ggplot2高效实用指南 | Logos</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'true', 'auto');
  ga('send', 'pageview');
</script>











</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>
  <a href="https://github.com/YTLogos"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Logos</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Stay hungry,Stay foolish</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      
        
        <li class="menu-item menu-item-guestbook">
          <a href="/guestbook" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            留言
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://ytlogos.github.io/2017/09/19/ggplot2高效实用指南/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="TaoYan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://ov520p4qw.bkt.clouddn.com/ytlogos/171017/Kh4BagCbCG.png?imageslim">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Logos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">ggplot2高效实用指南</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-19T08:29:46+08:00">
                2017-09-19
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2017-09-19T12:22:05+08:00">
                2017-09-19
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/可视化/" itemprop="url" rel="index">
                    <span itemprop="name">可视化</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/09/19/ggplot2高效实用指南/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/09/19/ggplot2高效实用指南/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/09/19/ggplot2高效实用指南/" class="leancloud_visitors" data-flag-title="ggplot2高效实用指南">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">热度 </span>
               
                 <span class="leancloud-visitors-count"></span>
				  <span>℃</span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  8,439
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  41
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/emJBf4A306.png?imageslim" alt="mark"></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>本文内容基本是来源于<a href="http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization" target="_blank" rel="external">STHDA</a>，这是一份十分详细的<strong>ggplot2</strong>使用指南，因此我将其翻译成中文，一是有助于我自己学习理解，另外其他R语言爱好者或者可视化爱好者可以用来学习。翻译过程肯定不能十全十美，各位读者有建议或改进的话，十分欢迎发<strong>Email</strong>(tyan@zju.edu.cn)给我。</p>
<a id="more"></a>
<p><a href="https://ggplot2.tidyverse.org/reference/" target="_blank" rel="external"><strong>ggplot2</strong></a>是由<strong>Hadley Wickham</strong>创建的一个十分强大的可视化R包。按照<strong>ggplot2</strong>的绘图理念，Plot(图)= data(数据集)+ Aesthetics(美学映射)+ Geometry(几何对象)：</p>
<ul>
<li>data: 数据集，主要是data frame；</li>
<li>Aesthetics: 美学映射，比如将变量映射给x,y坐标轴，或者映射给颜色、大小、形状等图形属性；</li>
<li>Geometry: 几何对象，比如柱形图、直方图、散点图、线图、密度图等。</li>
</ul>
<p>在<strong>ggplot2</strong>中有两个主要绘图函数：qplot()以及ggplot()。</p>
<ul>
<li>qplot(): 顾名思义，快速绘图；</li>
<li>ggplot()：此函数才是<strong>ggplot2</strong>的精髓，远比qplot()强大，可以一步步绘制十分复杂的图形。</li>
</ul>
<p>由<strong>ggplot2</strong>绘制出来的ggplot图可以作为一个变量，然后由print()显示出来。</p>
<h2 id="图形类型"><a href="#图形类型" class="headerlink" title="图形类型"></a>图形类型</h2><p>根据数据集，<strong>ggplot2</strong>提供不同的方法绘制图形，主要是为下面几类数据类型提供绘图方法：</p>
<ul>
<li>一个变量x: 连续或离散</li>
<li>两个变量x&amp;y：连续和(或)离散</li>
<li>连续双变量分布x&amp;y: 都是连续</li>
<li>误差棒</li>
<li>地图</li>
<li>三变量</li>
</ul>
<h2 id="安装及加载"><a href="#安装及加载" class="headerlink" title="安装及加载"></a>安装及加载</h2><p>安装<strong>ggplot2</strong>提供三种方式：</p>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#直接安装tidyverse，一劳永逸（推荐,数据分析大礼包）</span></div><div class="line">install.packages(<span class="string">"tidyverse"</span>)</div><div class="line"><span class="meta">#直接安装ggplot2</span></div><div class="line">install.packages(<span class="string">"ggplot2"</span>)</div><div class="line"><span class="meta">#从Github上安装最新的版本，先安装devtools(如果没安装的话)</span></div><div class="line">devtools::install_github(<span class="string">"tidyverse/ggplot2"</span>)</div></pre></td></tr></table></figure>
<p>加载<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">library(ggplot2)</div></pre></td></tr></table></figure></p>
<h2 id="数据准备"><a href="#数据准备" class="headerlink" title="数据准备"></a>数据准备</h2><blockquote>
<p>数据集应该数据框data.frame</p>
</blockquote>
<p>本文将使用数据集<strong>mtcars</strong>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#load the data set</div><div class="line">data(mtcars)</div><div class="line">df &lt;- mtcars[, c(&quot;mpg&quot;,&quot;cyl&quot;,&quot;wt&quot;)]</div><div class="line">#将cyl转为因子型factor</div><div class="line">df$cyl &lt;- as.factor(df$cyl)</div><div class="line">head(df)</div></pre></td></tr></table></figure></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                    mpg cyl    wt</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Mazda RX4         21.0   6 2.620</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Mazda RX4 Wag     21.0   6 2.875</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Datsun 710        22.8   4 2.320</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Hornet 4 Drive    21.4   6 3.215</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Hornet Sportabout 18.7   8 3.440</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Valiant           18.1   6 3.460</span></span></div></pre></td></tr></table></figure>
<h2 id="qplot"><a href="#qplot" class="headerlink" title="qplot()"></a>qplot()</h2><p>qplot()类似于R基本绘图函数plot(),可以快速绘制常见的几种图形：散点图、箱线图、小提琴图、直方图以及密度曲线图。其绘图格式为：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qplot(x, <span class="attribute">y</span>=<span class="literal">NULL</span>, data, <span class="attribute">geom</span>=<span class="string">"auto"</span>)</div></pre></td></tr></table></figure></p>
<p>其中：</p>
<ul>
<li>x,y: 根据需要绘制的图形使用;</li>
<li>data：数据集;</li>
<li>geom：几何图形，变量x,y同时指定的话默认为散点图，只指定x的话默认为直方图。</li>
</ul>
<h3 id="散点图"><a href="#散点图" class="headerlink" title="散点图"></a>散点图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qplot(x=mpg, y=wt, data=df, geom = &quot;point&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/DlJaE4eke3.png?imageslim" alt=""><br>也可以添加平滑曲线<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qplot(x=mpg, y=wt, data = df, geom = c(&quot;point&quot;, &quot;smooth&quot;))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/i3lHIh2jdD.png?imageslim" alt=""><br>还有其他参数可以修改，比如点的形状、大小、颜色等<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#将变量cyl映射给颜色和形状</div><div class="line">qplot(x=mpg, y=wt, data = df, colour=cyl, shape=cyl)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/D6Aflkkhab.png?imageslim" alt=""></p>
<h3 id="箱线图、小提琴图、点图"><a href="#箱线图、小提琴图、点图" class="headerlink" title="箱线图、小提琴图、点图"></a>箱线图、小提琴图、点图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#构造数据集</div><div class="line">set.seed(1234)</div><div class="line">wdata &lt;- data.frame(</div><div class="line">  sex=factor(rep(c(&quot;F&quot;, &quot;M&quot;), each=200)),</div><div class="line">  weight=c(rnorm(200, 55), rnorm(200, 58))</div><div class="line">)</div><div class="line">head(wdata)</div></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   sex   weight</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 1   F 53.79293</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2   F 55.27743</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 3   F 56.08444</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 4   F 52.65430</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 5   F 55.42912</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 6   F 55.50606</span></span></div></pre></td></tr></table></figure>
<p>箱线图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qplot(sex, weight, data = wdata, geom = &quot;boxplot&quot;, fill=sex)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/92K2e20idg.png?imageslim" alt=""></p>
<p>小提琴图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qplot(sex, weight, data = wdata, geom = &quot;violin&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/3m8H660Cl9.png?imageslim" alt=""></p>
<p>点图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qplot(sex, weight, data = wdata, geom = &quot;dotplot&quot;, stackdir=&quot;center&quot;, binaxis=&quot;y&quot;, dotsize=0.5, color=sex)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/Hb7G4J8875.png?imageslim" alt=""></p>
<h3 id="直方图、密度图"><a href="#直方图、密度图" class="headerlink" title="直方图、密度图"></a>直方图、密度图</h3><p>直方图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qplot(weight, data = wdata, geom = &quot;histogram&quot;, fill=sex)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/gd448CcLDb.png?imageslim" alt=""></p>
<p>密度图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qplot(weight, data = wdata, geom = &quot;density&quot;, color=sex, linetype=sex)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/dl77b5BDdm.png?imageslim" alt=""></p>
<h2 id="ggplot"><a href="#ggplot" class="headerlink" title="ggplot()"></a>ggplot()</h2><p>上文中的qplot()绘制散点图：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qplot(<span class="attribute">x</span>=mpg, <span class="attribute">y</span>=wt, <span class="attribute">data</span>=df, geom = <span class="string">"point"</span>)</div></pre></td></tr></table></figure></p>
<p>在ggplot()中完全可以如下实现：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ggplot(data=df, aes(x=mpg, y=wt))+</div><div class="line">  geom_point()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/80fkCC4Kgh.png?imageslim" alt=""></p>
<p>改变点形状、大小、颜色等属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(data=df, aes(x=mpg, y=wt))+geom_point(color=&quot;blue&quot;, size=2, shape=23)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/6LbL12Jmhm.png?imageslim" alt=""></p>
<p>绘图过程中常常要用到转换(transformation),这时添加图层的另一个方法是用stat_*()函数。<br>下例中的geom_density()与stat_density()是等价的<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(<span class="name">wdata</span>, aes(<span class="name">x=weight</span>))+geom_density()</div></pre></td></tr></table></figure></p>
<p>等价于<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(wdata, aes(x=weight))+stat_density()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/D3ca6EAf3F.png?imageslim" alt=""></p>
<blockquote>
<p>对于每一种几何图形。<strong>ggplot2</strong> 基本都提供了 geom<em><em>()</em>和 stat</em><em>()</em></p>
</blockquote>
<h3 id="一个变量：连续型"><a href="#一个变量：连续型" class="headerlink" title="一个变量：连续型"></a>一个变量：连续型</h3><p>使用数据集wdata，先计算出不同性别的体重平均值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(plyr)</div><div class="line">mu &lt;- ddply(wdata, &quot;sex&quot;, summarise, grp.mean=mean(weight))</div></pre></td></tr></table></figure></p>
<p>先绘制一个图层a,后面逐步添加图层<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a &lt;- ggplot(wdata, aes(x=weight))</div></pre></td></tr></table></figure></p>
<p>可能添加的图层有：</p>
<ul>
<li>对于一个连续变量：<ul>
<li>面积图geom_area()</li>
<li>密度图geom_density()</li>
<li>点图geom_dotplot()</li>
<li>频率多边图geom_freqpoly()</li>
<li>直方图geom_histogram()</li>
<li>经验累积密度图stat_ecdf()</li>
<li>QQ图stat_qq()</li>
</ul>
</li>
<li>对于一个离散变量：<ul>
<li>条形图geom_bar()</li>
</ul>
</li>
</ul>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170916/gcLBC7cG47.png?imageslim" alt=""></p>
<h4 id="面积图"><a href="#面积图" class="headerlink" title="面积图"></a>面积图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a+geom_area(stat = &quot;bin&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/J288ccH2m5.png?imageslim" alt=""></p>
<p>改变颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">a+geom_area(aes(fill=sex), stat = &quot;bin&quot;, alpha=0.6)+</div><div class="line">  theme_classic()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/LIj4mJbKb2.png?imageslim" alt=""></p>
<blockquote>
<p>注意：y轴默认为变量weight的数量即count，如果y轴要显示密度，可用以下代码：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a+geom_area(aes(y=..density..), stat = &quot;bin&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/kkCc85KCeJ.png?imageslim" alt=""></p>
<p>可以通过修改不同属性如透明度、填充颜色、大小、线型等自定义图形：</p>
<h4 id="密度图"><a href="#密度图" class="headerlink" title="密度图"></a>密度图</h4><p>使用以下函数：</p>
<ul>
<li>geom_density():绘制密度图</li>
<li>geom_vline():添加竖直线</li>
<li>scale_color_manual():手动修改颜色</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a+geom_density()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/c1EL7I2a49.png?imageslim" alt=""></p>
<p>根据sex修改颜色，将sex映射给line颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a+geom_density(aes(color=sex))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/72Ahbf7K6h.png?imageslim" alt=""></p>
<p>修改填充颜色以及透明度<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a+geom_density(aes(fill=sex), alpha=0.4)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/ejijLE9IfG.png?imageslim" alt=""></p>
<p>添加均值线以及手动修改颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">a+geom_density(aes(color=sex))+</div><div class="line">  geom_vline(data=mu, aes(xintercept=grp.mean, color=sex), linetype=&quot;dashed&quot;)+</div><div class="line">  scale_color_manual(values = c(&quot;red&quot;, &quot;blue&quot;))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/mAFhH7lleK.png?imageslim" alt=""></p>
<h4 id="点图"><a href="#点图" class="headerlink" title="点图"></a>点图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a+geom_dotplot()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/H1mDL0HCJI.png?imageslim" alt=""></p>
<p>将sex映射给颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a+geom_dotplot(aes(fill=sex))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/6bfHaEcBAl.png?imageslim" alt=""></p>
<p>手动修改颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">a+geom_dotplot(aes(fill=sex))+</div><div class="line">  scale_fill_manual(values=c(&quot;#999999&quot;, &quot;#E69F00&quot;))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/kiE9Lci30h.png?imageslim" alt=""></p>
<h4 id="频率多边图"><a href="#频率多边图" class="headerlink" title="频率多边图"></a>频率多边图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a+geom_freqpoly()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/K40Fch448J.png?imageslim" alt=""></p>
<p>y轴显示为密度<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">a+geom_freqpoly(aes(y=..density..))+</div><div class="line">  theme_minimal()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/CgCf1eAgf8.png?imageslim" alt=""></p>
<p>修改颜色以及线型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">a+geom_freqpoly(aes(color=sex, linetype=sex))+</div><div class="line">  theme_minimal()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/jaaBibcFjH.png?imageslim" alt=""></p>
<h4 id="直方图"><a href="#直方图" class="headerlink" title="直方图"></a>直方图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a+geom_histogram()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/bHilai3a9l.png?imageslim" alt=""></p>
<p>将sex映射给线颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a+geom_histogram(aes(color=sex), fill=&quot;white&quot;, position = &quot;dodge&quot;)+theme_classic()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/eD7iLDJId1.png?imageslim" alt=""></p>
<h4 id="经验累积密度图"><a href="#经验累积密度图" class="headerlink" title="经验累积密度图"></a>经验累积密度图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a+stat_ecdf()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/f83Imkm4jm.png?imageslim" alt=""></p>
<h4 id="QQ图"><a href="#QQ图" class="headerlink" title="QQ图"></a>QQ图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(data = mtcars, aes(sample=mpg))+stat_qq()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/e7G7hbeLID.png?imageslim" alt=""></p>
<h3 id="一个离散变量"><a href="#一个离散变量" class="headerlink" title="一个离散变量"></a>一个离散变量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#加载数据集</div><div class="line">data(mpg)</div><div class="line">b &lt;- ggplot(mpg, aes(x=fl))</div><div class="line">b+geom_bar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/b4FJFb7H99.png?imageslim" alt=""></p>
<p>修改填充颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">b+geom_bar(fill=&quot;steelblue&quot;, color=&quot;black&quot;)+theme_classic()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/ih6I2ammG4.png?imageslim" alt=""></p>
<h3 id="两个变量：x-y皆连续"><a href="#两个变量：x-y皆连续" class="headerlink" title="两个变量：x,y皆连续"></a>两个变量：x,y皆连续</h3><p>使用数据集mtcars， 先创建一个ggplot图层<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">b &lt;- ggplot(data = mtcars, aes(x=wt, y=mpg))</div></pre></td></tr></table></figure></p>
<p>可能添加的图层有：</p>
<ul>
<li>geom_point():散点图</li>
<li>geom_smooth():平滑线</li>
<li>geom_quantile():分位线</li>
<li>geom_rug():边际地毯线</li>
<li>geom_jitter():避免重叠</li>
<li>geom_text():添加文本注释</li>
</ul>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170916/ld1EAJgd88.png?imageslim" alt=""></p>
<h4 id="散点图-1"><a href="#散点图-1" class="headerlink" title="散点图"></a>散点图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">b+geom_point()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/796GlJi3Al.png?imageslim" alt=""></p>
<p>将变量cyl映射给点的颜色和形状<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">b + geom_point(aes(color = factor(cyl), shape = factor(cyl)))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/J6dfJ1EL33.png?imageslim" alt=""></p>
<p>自定义颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">b+geom_point(aes(color=factor(cyl), shape=factor(cyl)))+</div><div class="line">  scale_color_manual(values=c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;))+theme_classic()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/3695bEj0Ha.png?imageslim" alt=""></p>
<h4 id="平滑线"><a href="#平滑线" class="headerlink" title="平滑线"></a>平滑线</h4><p>可以添加回归曲线<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">b+geom_smooth()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/1hJGKGeLc2.png?imageslim" alt=""></p>
<p>散点图+回归线<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">b+geom_point()+</div><div class="line">  geom_smooth(method = &quot;lm&quot;, se=FALSE)#去掉置信区间</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/Gl47fkb2c2.png?imageslim" alt=""></p>
<p>使用loess方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">b+geom_point()+</div><div class="line">  geom_smooth(method = &quot;loess&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/6jaCLAL3Fc.png?imageslim" alt=""></p>
<p>将变量映射给颜色和形状<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">b+geom_point(aes(color=factor(cyl), shape=factor(cyl)))+</div><div class="line">  geom_smooth(aes(color=factor(cyl), shape=factor(cyl)), method = &quot;lm&quot;, se=FALSE, fullrange=TRUE)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/7hjfJ89K4c.png?imageslim" alt=""></p>
<h4 id="分位线"><a href="#分位线" class="headerlink" title="分位线"></a>分位线</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ggplot(data = mpg, aes(cty, hwy))+</div><div class="line">  geom_point()+geom_quantile()+</div><div class="line">  theme_minimal()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/l0F005kgih.png?imageslim" alt=""></p>
<h4 id="边际地毯线"><a href="#边际地毯线" class="headerlink" title="边际地毯线"></a>边际地毯线</h4><p>使用数据集<strong>faithful</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ggplot(data = faithful, aes(x=eruptions, y=waiting))+</div><div class="line">  geom_point()+geom_rug()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/7H7BlJE35k.png?imageslim" alt=""></p>
<h4 id="避免重叠"><a href="#避免重叠" class="headerlink" title="避免重叠"></a>避免重叠</h4><p>实际上<code>geom_jitter()</code>是<code>geom_point(position=&quot;jitter&quot;)</code>的简称,下面使用数据集<strong>mpg</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">p &lt;- ggplot(data = mpg, aes(displ, hwy))</div><div class="line">p+geom_point()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/Ad2aBaaEED.png?imageslim" alt=""><br>增加抖动防止重叠<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+geom_jitter(width = 0.5, height = 0.5)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/DmKBbIGK2c.png?imageslim" alt=""></p>
<p>其中两个参数：</p>
<ul>
<li>width：x轴方向的抖动幅度</li>
<li>height：y轴方向的抖动幅度</li>
</ul>
<h4 id="文本注释"><a href="#文本注释" class="headerlink" title="文本注释"></a>文本注释</h4><p>参数label用来指定注释标签<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">b+geom_text(aes(label=rownames(mtcars)))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/L6CaLD26ga.png?imageslim" alt=""></p>
<h3 id="两个变量：连续二元分布"><a href="#两个变量：连续二元分布" class="headerlink" title="两个变量：连续二元分布"></a>两个变量：连续二元分布</h3><p>使用数据集<strong>diamonds</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(diamonds[, c(&quot;carat&quot;, &quot;price&quot;)])</div></pre></td></tr></table></figure></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># # A tibble: 6 x 2</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   carat price</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   &lt;dbl&gt; &lt;int&gt;</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 1  0.23   326</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2  0.21   326</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 3  0.23   327</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 4  0.29   334</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 5  0.31   335</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 6  0.24   336</span></span></div></pre></td></tr></table></figure>
<p>创建ggplot图层,后面再逐步添加图层<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">c &lt;- ggplot(data=diamonds, aes(carat, price))</div></pre></td></tr></table></figure></p>
<p>可添加的图层有：</p>
<ul>
<li>geom_bin2d(): 二维封箱热图</li>
<li>geom_hex(): 六边形封箱图</li>
<li>geom_density_2d(): 二维等高线密度图</li>
</ul>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170916/mIdJKh6F1G.png?imageslim" alt=""></p>
<h4 id="二维封箱热图"><a href="#二维封箱热图" class="headerlink" title="二维封箱热图"></a>二维封箱热图</h4><p><code>geom_bin2d()</code>将点的数量用矩形封装起来，通过颜色深浅来反映点密度<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">c+geom_bin2d()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/BgC3g377mE.png?imageslim" alt=""><br>设置bin的数量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">c+geom_bin2d(bins=150)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/4ejegHkcbF.png?imageslim" alt=""></p>
<h4 id="六边形封箱图"><a href="#六边形封箱图" class="headerlink" title="六边形封箱图"></a>六边形封箱图</h4><p>geom_hex()依赖于另一个R包<strong>hexbin</strong>，所以没安装的先安装：<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">install</span>.packages(<span class="string">"hexbin"</span>)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(hexbin)</div><div class="line">c+geom_hex()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/f9Fbl2IAKj.png?imageslim" alt=""></p>
<p>修改bin的数目<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">c+geom_hex(bins=10)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/bIc44CGdC8.png?imageslim" alt=""></p>
<h4 id="二维等高线密度图"><a href="#二维等高线密度图" class="headerlink" title="二维等高线密度图"></a>二维等高线密度图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sp &lt;- ggplot(faithful, aes(x=eruptions, y=waiting))</div><div class="line">sp+geom_point()+ geom_density_2d()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/imG9fLLlb6.png?imageslim" alt=""></p>
<h3 id="两个变量：连续函数"><a href="#两个变量：连续函数" class="headerlink" title="两个变量：连续函数"></a>两个变量：连续函数</h3><p>主要是如何通过线来连接两个变量，使用数据集<strong>economics</strong>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(economics)</div></pre></td></tr></table></figure></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># # A tibble: 6 x 6</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#         date   pce    pop psavert uempmed unemploy</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#       &lt;date&gt; &lt;dbl&gt;  &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;int&gt;</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 1 1967-07-01 507.4 198712    12.5     4.5     2944</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2 1967-08-01 510.5 198911    12.5     4.7     2945</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 3 1967-09-01 516.3 199113    11.7     4.6     2958</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 4 1967-10-01 512.9 199311    12.5     4.9     3143</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 5 1967-11-01 518.1 199498    12.5     4.7     3066</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 6 1967-12-01 525.8 199657    12.1     4.8     3018</span></span></div></pre></td></tr></table></figure>
<p>先创建一个ggplot图层，后面逐步添加图层<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">d &lt;- ggplot(data = economics, aes(x=date, y=unemploy))</div></pre></td></tr></table></figure></p>
<p>可添加的图层有：</p>
<ul>
<li>geom_area():面积图</li>
<li>geom_line()：折线图</li>
<li>geom_step(): 阶梯图</li>
</ul>
<h4 id="面积图-1"><a href="#面积图-1" class="headerlink" title="面积图"></a>面积图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">d+geom_area()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/dj4fHa6Kh2.png?imageslim" alt=""></p>
<h4 id="线图"><a href="#线图" class="headerlink" title="线图"></a>线图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">d+geom_line()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/DhLc531J92.png?imageslim" alt=""></p>
<h4 id="阶梯图"><a href="#阶梯图" class="headerlink" title="阶梯图"></a>阶梯图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">set.seed(1111)</div><div class="line">ss &lt;- economics[sample(1:nrow(economics), 20),]</div><div class="line">ggplot(ss, aes(x=date, y=unemploy))+</div><div class="line">  geom_step()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/l5lHl5944G.png?imageslim" alt=""></p>
<h3 id="两个变量：x离散，y连续"><a href="#两个变量：x离散，y连续" class="headerlink" title="两个变量：x离散，y连续"></a>两个变量：x离散，y连续</h3><p>使用数据集<strong>ToothGrowth</strong>,其中的变量len(Tooth length)是连续变量，dose是离散变量。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)</div><div class="line">head(ToothGrowth)</div></pre></td></tr></table></figure></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    len supp dose</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 1  4.2   VC  0.5</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2 11.5   VC  0.5</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 3  7.3   VC  0.5</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 4  5.8   VC  0.5</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 5  6.4   VC  0.5</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 6 10.0   VC  0.5</span></span></div></pre></td></tr></table></figure>
<p>创建图层<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">e &lt;- ggplot(data = ToothGrowth, aes(x=dose, y=len))</div></pre></td></tr></table></figure></p>
<p>可添加的图层有：</p>
<ul>
<li>geom_boxplot(): 箱线图</li>
<li>geom_violin()：小提琴图</li>
<li>geom_dotplot()：点图</li>
<li>geom_jitter(): 带状图</li>
<li>geom_line(): 线图</li>
<li>geom_bar(): 条形图</li>
</ul>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170916/3F447J6d7L.png?imageslim" alt=""></p>
<h4 id="箱线图"><a href="#箱线图" class="headerlink" title="箱线图"></a>箱线图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">e+geom_boxplot()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/37J7f7hfCJ.png?imageslim" alt=""></p>
<p>添加有缺口的箱线图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">e+geom_boxplot(notch = TRUE)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/952cibHB9E.png?imageslim" alt=""></p>
<p>按dose分组映射给颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">e+geom_boxplot(aes(color=dose))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/15dJjbIGkB.png?imageslim" alt=""></p>
<p>将dose映射给填充颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">e+geom_boxplot(aes(fill=dose))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/Am1A6Efaa6.png?imageslim" alt=""></p>
<p>按supp进行分类并映射给填充颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(ToothGrowth, aes(x=dose, y=len))+ geom_boxplot(aes(fill=supp))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/jfFFF1Hh99.png?imageslim" alt=""></p>
<h4 id="小提琴图"><a href="#小提琴图" class="headerlink" title="小提琴图"></a>小提琴图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">e+geom_violin(trim = FALSE)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/fG1DmbmaIB.png?imageslim" alt=""></p>
<p>添加中值点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">e+geom_violin(trim = FALSE)+</div><div class="line">  stat_summary(fun.data = mean_sdl, fun.args = list(mult=1), </div><div class="line">               geom=&quot;pointrange&quot;, color=&quot;red&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/GAkDaEHJe2.png?imageslim" alt=""></p>
<p>与箱线图结合<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">e+geom_violin(trim = FALSE)+</div><div class="line">  geom_boxplot(width=0.2)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/igef2H376K.png?imageslim" alt=""></p>
<p>将dose映射给颜色进行分组<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">e+geom_violin(aes(color=dose), trim = FALSE)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/g6G0aI5DaE.png?imageslim" alt=""></p>
<h4 id="点图-1"><a href="#点图-1" class="headerlink" title="点图"></a>点图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">e+geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/60aB2FKkBj.png?imageslim" alt=""></p>
<p>添加中值点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">e + geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;) + </div><div class="line">  stat_summary(fun.data=mean_sdl, color = &quot;red&quot;,geom = &quot;pointrange&quot;,fun.args=list(mult=1))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/B1A5h69HDF.png?imageslim" alt=""></p>
<p>与箱线图结合<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">e + geom_boxplot() + </div><div class="line">  geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/JkebcfeiHH.png?imageslim" alt=""></p>
<p>添加小提琴图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">e + geom_violin(trim = FALSE) +</div><div class="line">  geom_dotplot(binaxis=&apos;y&apos;, stackdir=&apos;center&apos;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/DGm19F7hde.png?imageslim" alt=""></p>
<p>将dose映射给颜色以及填充色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">e + geom_dotplot(aes(color = dose, fill = dose), </div><div class="line">                 binaxis = &quot;y&quot;, stackdir = &quot;center&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/AGABHiI43E.png?imageslim" alt=""></p>
<h4 id="带状图"><a href="#带状图" class="headerlink" title="带状图"></a>带状图</h4><p>带状图是一种一维散点图，当样本量很小时，与箱线图相当<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">e + geom_jitter(position=position_jitter(0.2))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/KE0EHFl7h0.png?imageslim" alt=""></p>
<p>添加中值点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">e + geom_jitter(position=position_jitter(0.2)) + </div><div class="line">  stat_summary(fun.data=&quot;mean_sdl&quot;,  fun.args = list(mult=1), </div><div class="line">               geom=&quot;pointrange&quot;, color = &quot;red&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/GF9c4kHDKI.png?imageslim" alt="mark"></p>
<p>与点图结合<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">e + geom_jitter(position=position_jitter(0.2)) + </div><div class="line">  geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/238j5KGmEB.png?imageslim" alt="mark"></p>
<p>与小提琴图结合<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">e + geom_violin(trim = FALSE) +</div><div class="line">  geom_jitter(position=position_jitter(0.2))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/lEADE3fA1h.png?imageslim" alt="mark"></p>
<p>将dose映射给颜色和形状<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">e +  geom_jitter(aes(color = dose, shape = dose),</div><div class="line">                 position=position_jitter(0.2))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/7lKfKkE5d6.png?imageslim" alt="mark"></p>
<h4 id="线图-1"><a href="#线图-1" class="headerlink" title="线图"></a>线图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#构造数据集</div><div class="line">df &lt;- data.frame(supp=rep(c(&quot;VC&quot;, &quot;OJ&quot;), each=3),</div><div class="line">                dose=rep(c(&quot;D0.5&quot;, &quot;D1&quot;, &quot;D2&quot;),2),</div><div class="line">                len=c(6.8, 15, 33, 4.2, 10, 29.5))</div><div class="line">head(df)</div></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   supp dose  len</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 1   VC D0.5  6.8</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2   VC   D1 15.0</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 3   VC   D2 33.0</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 4   OJ D0.5  4.2</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 5   OJ   D1 10.0</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 6   OJ   D2 29.5</span></span></div></pre></td></tr></table></figure>
<p>将supp映射线型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ggplot(df, aes(x=dose, y=len, group=supp)) +</div><div class="line">  geom_line(aes(linetype=supp))+</div><div class="line">  geom_point()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/Bjl125A2Im.png?imageslim" alt="mark"></p>
<p>修改线型、点的形状以及颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ggplot(df, aes(x=dose, y=len, group=supp)) +</div><div class="line">  geom_line(aes(linetype=supp, color = supp))+</div><div class="line">  geom_point(aes(shape=supp, color = supp))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/j9e39B9cKB.png?imageslim" alt="mark"></p>
<h4 id="条形图"><a href="#条形图" class="headerlink" title="条形图"></a>条形图</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#构造数据集</div><div class="line">df &lt;- data.frame(dose=c(&quot;D0.5&quot;, &quot;D1&quot;, &quot;D2&quot;),</div><div class="line">                len=c(4.2, 10, 29.5))</div><div class="line">head(df)</div></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   dose  len</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 1 D0.5  4.2</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2   D1 10.0</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 3   D2 29.5</span></span></div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">df2 &lt;- data.frame(supp=rep(c(&quot;VC&quot;, &quot;OJ&quot;), each=3),</div><div class="line">                dose=rep(c(&quot;D0.5&quot;, &quot;D1&quot;, &quot;D2&quot;),2),</div><div class="line">                len=c(6.8, 15, 33, 4.2, 10, 29.5))</div><div class="line">head(df2)</div></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   supp dose  len</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 1   VC D0.5  6.8</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2   VC   D1 15.0</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 3   VC   D2 33.0</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 4   OJ D0.5  4.2</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 5   OJ   D1 10.0</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 6   OJ   D2 29.5</span></span></div></pre></td></tr></table></figure>
<p>创建图层<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">f &lt;- ggplot(df, aes(x = dose, y = len))</div><div class="line">f + geom_bar(stat = &quot;identity&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/FF7A37l9j4.png?imageslim" alt="mark"></p>
<p>修改填充色以及添加标签<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">f + geom_bar(stat=&quot;identity&quot;, fill=&quot;steelblue&quot;)+</div><div class="line">  geom_text(aes(label=len), vjust=-0.3, size=3.5)+</div><div class="line">  theme_minimal()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/hBa9871IE9.png?imageslim" alt="mark"></p>
<p>将dose映射给条形图颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">f + geom_bar(aes(color = dose),</div><div class="line">             stat=&quot;identity&quot;, fill=&quot;white&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/HIGAAJLiFl.png?imageslim" alt="mark"></p>
<p>修改填充色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f + geom_bar(aes(fill = dose), stat=&quot;identity&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/LGFlfJGmHi.png?imageslim" alt="mark"></p>
<p>将变量supp映射给填充色，从而达到分组效果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">g &lt;- ggplot(data=df2, aes(x=dose, y=len, fill=supp)) </div><div class="line">g + geom_bar(stat = &quot;identity&quot;)#position默认为stack</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/dLGm6lij04.png?imageslim" alt="mark"></p>
<p>修改position为dodge<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">g + geom_bar(stat=&quot;identity&quot;, position=position_dodge())</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/Di23jj9kC9.png?imageslim" alt="mark"></p>
<h3 id="两个变量：x、y皆离散"><a href="#两个变量：x、y皆离散" class="headerlink" title="两个变量：x、y皆离散"></a>两个变量：x、y皆离散</h3><p>使用数据集diamonds中的两个离散变量color以及cut<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ggplot(diamonds, aes(cut, color)) +</div><div class="line">  geom_jitter(aes(color = cut), size = 0.5)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/c8Fh5DI7cE.png?imageslim" alt="mark"></p>
<h3 id="两个变量：绘制误差图"><a href="#两个变量：绘制误差图" class="headerlink" title="两个变量：绘制误差图"></a>两个变量：绘制误差图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">df &lt;- ToothGrowth</div><div class="line">df$dose &lt;- as.factor(df$dose)</div><div class="line">head(df)</div></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    len supp dose</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 1  4.2   VC  0.5</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2 11.5   VC  0.5</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 3  7.3   VC  0.5</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 4  5.8   VC  0.5</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 5  6.4   VC  0.5</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 6 10.0   VC  0.5</span></span></div></pre></td></tr></table></figure>
<p>绘制误差图需要知道均值以及标准误，下面这个函数用来计算每组的均值以及标准误。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">data_summary &lt;- function(data, varname, grps)&#123;</div><div class="line">  require(plyr)</div><div class="line">  summary_func &lt;- function(x, col)&#123;</div><div class="line">    c(mean = mean(x[[col]], na.rm=TRUE),</div><div class="line">      sd = sd(x[[col]], na.rm=TRUE))</div><div class="line">  &#125;</div><div class="line">  data_sum&lt;-ddply(data, grps, .fun=summary_func, varname)</div><div class="line">  data_sum &lt;- rename(data_sum, c(&quot;mean&quot; = varname))</div><div class="line"> return(data_sum)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>计算均值以及标准误<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">df2 &lt;- data_summary(df, varname=&quot;len&quot;, grps= &quot;dose&quot;)</div><div class="line"># Convert dose to a factor variable</div><div class="line">df2$dose=as.factor(df2$dose)</div><div class="line">head(df2)</div></pre></td></tr></table></figure></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">##   dose    len       sd</div><div class="line">## <span class="number">1</span>  <span class="number">0.5</span> <span class="number">10.605</span> <span class="number">4.499763</span></div><div class="line">## <span class="number">2</span>    <span class="number">1</span> <span class="number">19.735</span> <span class="number">4.415436</span></div><div class="line">## <span class="number">3</span>    <span class="number">2</span> <span class="number">26.100</span> <span class="number">3.774150</span></div></pre></td></tr></table></figure>
<p>创建图层<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">f &lt;- ggplot(df2, aes(x = dose, y = len, </div><div class="line">                     ymin = len-sd, ymax = len+sd))</div></pre></td></tr></table></figure></p>
<p>可添加的图层有：</p>
<ul>
<li>geom_crossbar(): 空心柱，上中下三线分别代表ymax、mean、ymin</li>
<li>geom_errorbar(): 误差棒</li>
<li>geom_errorbarh(): 水平误差棒</li>
<li>geom_linerange()：竖直误差线</li>
<li>geom_pointrange()：中间为一点的误差线</li>
</ul>
<p>具体如下：</p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/521m2AHCDg.png?imageslim" alt=""></p>
<h4 id="geom-crossbar"><a href="#geom-crossbar" class="headerlink" title="geom_crossbar()"></a>geom_crossbar()</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f+geom_crossbar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/18EIA26lgI.png?imageslim" alt="mark"></p>
<p>将dose映射给颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f+geom_crossbar(aes(color=dose))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/jH5eDIHjHL.png?imageslim" alt="mark"></p>
<p>自定义颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">f+geom_crossbar(aes(color=dose))+</div><div class="line">  scale_color_manual(values = c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;))+theme_classic()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/jcBCFdKlmH.png?imageslim" alt="mark"></p>
<p>修改填充色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">f+geom_crossbar(aes(fill=dose))+</div><div class="line">  scale_fill_manual(values = c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;))+</div><div class="line">  theme_classic()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/6c5A4l9d2D.png?imageslim" alt="mark"></p>
<p>通过将supp映射给颜色实现分组，可以利用函数stat_summary()来计算mean和sd<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">f &lt;- ggplot(df, aes(x=dose, y=len, color=supp))</div><div class="line">f+stat_summary(fun.data = mean_sdl, fun.args = list(mult=1), geom=&quot;crossbar&quot;, width=0.6, position = position_dodge(0.8))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/3e3Ic9486G.png?imageslim" alt="mark"></p>
<h4 id="误差棒"><a href="#误差棒" class="headerlink" title="误差棒"></a>误差棒</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f &lt;- ggplot(df2, aes(x=dose, y=len, ymin=len-sd, ymax=len+sd))</div></pre></td></tr></table></figure>
<p>将dose映射给颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f+geom_errorbar(aes(color=dose), width=0.2)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/HLJe8aLajg.png?imageslim" alt="mark"></p>
<p>与线图结合<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">f+geom_line(aes(group=1))+</div><div class="line">  geom_errorbar(width=0.15)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/2E0aKa6GgJ.png?imageslim" alt="mark"></p>
<p>与条形图结合，并将变量dose映射给颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">f+geom_bar(aes(color=dose), stat = &quot;identity&quot;, fill=&quot;white&quot;)+</div><div class="line">  geom_errorbar(aes(color=dose), width=0.1)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170918/1GllA47ajF.png?imageslim" alt="mark"></p>
<h4 id="水平误差棒"><a href="#水平误差棒" class="headerlink" title="水平误差棒"></a>水平误差棒</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#构造数据集</div><div class="line">df2 &lt;- data_summary(ToothGrowth, varname=&quot;len&quot;, grps = &quot;dose&quot;)</div><div class="line">df2$dose &lt;- as.factor(df2$dose)</div><div class="line">head(df2)</div></pre></td></tr></table></figure>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">##   dose    len       sd</div><div class="line">## <span class="number">1</span>  <span class="number">0.5</span> <span class="number">10.605</span> <span class="number">4.499763</span></div><div class="line">## <span class="number">2</span>    <span class="number">1</span> <span class="number">19.735</span> <span class="number">4.415436</span></div><div class="line">## <span class="number">3</span>    <span class="number">2</span> <span class="number">26.100</span> <span class="number">3.774150</span></div></pre></td></tr></table></figure>
<p>创建图层<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f &lt;- ggplot(data = df2, aes(x=len, y=dose,xmin=len-sd, xmax=len+sd))</div></pre></td></tr></table></figure></p>
<p>参数xmin与xmax用来设置水平误差棒</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f+geom_errorbarh()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/2KAK9FgCDF.png?imageslim" alt="mark"></p>
<p>通过映射实现分组<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f+geom_errorbarh(aes(color=dose))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/G3cJmg13EI.png?imageslim" alt="mark"></p>
<h4 id="geom-linerange-与geom-pointrange"><a href="#geom-linerange-与geom-pointrange" class="headerlink" title="geom_linerange()与geom_pointrange()"></a>geom_linerange()与geom_pointrange()</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f &lt;- ggplot(df2, aes(x=dose, y=len, ymin=len-sd, ymax=len+sd))</div></pre></td></tr></table></figure>
<p>line range<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f+geom_linerange()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/95BJEFgb1c.png?imageslim" alt="mark"></p>
<p>point range<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f+geom_pointrange()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/5kAAd2dhJl.png?imageslim" alt="mark"></p>
<h4 id="点图-误差棒"><a href="#点图-误差棒" class="headerlink" title="点图+误差棒"></a>点图+误差棒</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">g &lt;- ggplot(df, aes(x=dose, y=len))+</div><div class="line">  geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;)</div></pre></td></tr></table></figure>
<p>添加geom_crossbar()<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">g+stat_summary(fun.data = mean_sdl, fun.args = list(mult=1), geom=&quot;crossbar&quot;, color=&quot;red&quot;, width=0.1)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/gb1G7K8D25.png?imageslim" alt="mark"></p>
<p>添加geom_errorbar()<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">g + stat_summary(fun.data=mean_sdl, fun.args = list(mult=1), </div><div class="line">        geom=&quot;errorbar&quot;, color=&quot;red&quot;, width=0.2) +</div><div class="line">  stat_summary(fun.y=mean, geom=&quot;point&quot;, color=&quot;red&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/HBjmlf502b.png?imageslim" alt="mark"></p>
<p>添加geom_pointrange()<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">g + stat_summary(fun.data=mean_sdl, fun.args = list(mult=1), </div><div class="line">                 geom=&quot;pointrange&quot;, color=&quot;red&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/E3K5E0cg9B.png?imageslim" alt="mark"></p>
<h3 id="两个变量：地图绘制"><a href="#两个变量：地图绘制" class="headerlink" title="两个变量：地图绘制"></a>两个变量：地图绘制</h3><p><strong>ggplot2</strong>提供了绘制地图的函数<code>geom_map()</code>，依赖于包<strong>maps</strong>提供地理信息。<br>安装<strong>map</strong><br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">install</span>.paclages(<span class="string">"maps"</span>)</div></pre></td></tr></table></figure></p>
<p>下面将绘制美国地图，数据集采用<strong>USArrests</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(maps)</div><div class="line">head(USArrests)</div></pre></td></tr></table></figure></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##            Murder Assault UrbanPop Rape</div><div class="line">## Alabama      <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span></div><div class="line">## Alaska       <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span></div><div class="line">## Arizona       <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span></div><div class="line">## Arkansas      <span class="number">8.8</span>     <span class="number">190</span>       <span class="number">50</span> <span class="number">19.5</span></div><div class="line">## California    <span class="number">9.0</span>     <span class="number">276</span>       <span class="number">91</span> <span class="number">40.6</span></div><div class="line">## Colorado      <span class="number">7.9</span>     <span class="number">204</span>       <span class="number">78</span> <span class="number">38.7</span></div></pre></td></tr></table></figure>
<p>对数据进行整理一下,添加一列state<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">crimes &lt;- data.frame(state=tolower(rownames(USArrests)), USArrests)</div><div class="line">head(crimes)</div></pre></td></tr></table></figure></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##            Murder Assault UrbanPop Rape</div><div class="line">## Alabama      <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span></div><div class="line">## Alaska       <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span></div><div class="line">## Arizona       <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span></div><div class="line">## Arkansas      <span class="number">8.8</span>     <span class="number">190</span>       <span class="number">50</span> <span class="number">19.5</span></div><div class="line">## California    <span class="number">9.0</span>     <span class="number">276</span>       <span class="number">91</span> <span class="number">40.6</span></div><div class="line">## Colorado      <span class="number">7.9</span>     <span class="number">204</span>       <span class="number">78</span> <span class="number">38.7</span></div></pre></td></tr></table></figure>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#数据重铸</div><div class="line"><span class="function"><span class="title">library</span><span class="params">(reshape2)</span></span></div><div class="line">crimesm &lt;- melt(crimes, id=<span class="number">1</span>)</div><div class="line"><span class="function"><span class="title">head</span><span class="params">(crimesm)</span></span></div></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#        state variable value</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 1    alabama   Murder  13.2</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2     alaska   Murder  10.0</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 3    arizona   Murder   8.1</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 4   arkansas   Murder   8.8</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 5 california   Murder   9.0</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 6   colorado   Murder   7.9</span></span></div></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">map_data &lt;- map_data(<span class="string">"state"</span>)</div><div class="line"><span class="comment">#绘制地图，使用Murder进行着色</span></div><div class="line">ggplot(crimes, aes(<span class="attribute">map_id</span>=state))+</div><div class="line">  geom_map(aes(<span class="attribute">fill</span>=Murder), <span class="attribute">map</span>=map_data)+</div><div class="line">  expand_limits(<span class="attribute">x</span>=map_data$long, <span class="attribute">y</span>=map_data$lat)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/I05fI783fH.png?imageslim" alt="mark"></p>
<h3 id="三个变量"><a href="#三个变量" class="headerlink" title="三个变量"></a>三个变量</h3><p>使用数据集<strong>mtcars</strong>，首先绘制一个相关性图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#构造数据</div><div class="line">df &lt;- mtcars[, c(1,3,4,5,6,7)]</div><div class="line">head(df)</div></pre></td></tr></table></figure></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##                    mpg disp  hp drat    wt  qsec</div><div class="line">## Mazda RX4         <span class="number">21.0</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span></div><div class="line">## Mazda RX4 Wag     <span class="number">21.0</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span></div><div class="line">## Datsun <span class="number">710</span>        <span class="number">22.8</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span></div><div class="line">## Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>  <span class="number">258</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span></div><div class="line">## Hornet Sportabout <span class="number">18.7</span>  <span class="number">360</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span></div><div class="line">## Valiant           <span class="number">18.1</span>  <span class="number">225</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span></div></pre></td></tr></table></figure>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cormat &lt;- round(<span class="name">cor</span>(<span class="name">df</span>), <span class="number">2</span>)</div><div class="line">cormat_melt &lt;- melt(<span class="name">cormat</span>)</div><div class="line">head(<span class="name">cormat</span>)</div></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##        <span class="selector-tag">mpg</span>  <span class="selector-tag">disp</span>    <span class="selector-tag">hp</span>  <span class="selector-tag">drat</span>    <span class="selector-tag">wt</span>  <span class="selector-tag">qsec</span></div><div class="line">## <span class="selector-tag">mpg</span>   1<span class="selector-class">.00</span> <span class="selector-tag">-0</span><span class="selector-class">.85</span> <span class="selector-tag">-0</span><span class="selector-class">.78</span>  0<span class="selector-class">.68</span> <span class="selector-tag">-0</span><span class="selector-class">.87</span>  0<span class="selector-class">.42</span></div><div class="line">## <span class="selector-tag">disp</span> <span class="selector-tag">-0</span><span class="selector-class">.85</span>  1<span class="selector-class">.00</span>  0<span class="selector-class">.79</span> <span class="selector-tag">-0</span><span class="selector-class">.71</span>  0<span class="selector-class">.89</span> <span class="selector-tag">-0</span><span class="selector-class">.43</span></div><div class="line">## <span class="selector-tag">hp</span>   <span class="selector-tag">-0</span><span class="selector-class">.78</span>  0<span class="selector-class">.79</span>  1<span class="selector-class">.00</span> <span class="selector-tag">-0</span><span class="selector-class">.45</span>  0<span class="selector-class">.66</span> <span class="selector-tag">-0</span><span class="selector-class">.71</span></div><div class="line">## <span class="selector-tag">drat</span>  0<span class="selector-class">.68</span> <span class="selector-tag">-0</span><span class="selector-class">.71</span> <span class="selector-tag">-0</span><span class="selector-class">.45</span>  1<span class="selector-class">.00</span> <span class="selector-tag">-0</span><span class="selector-class">.71</span>  0<span class="selector-class">.09</span></div><div class="line">## <span class="selector-tag">wt</span>   <span class="selector-tag">-0</span><span class="selector-class">.87</span>  0<span class="selector-class">.89</span>  0<span class="selector-class">.66</span> <span class="selector-tag">-0</span><span class="selector-class">.71</span>  1<span class="selector-class">.00</span> <span class="selector-tag">-0</span><span class="selector-class">.17</span></div><div class="line">## <span class="selector-tag">qsec</span>  0<span class="selector-class">.42</span> <span class="selector-tag">-0</span><span class="selector-class">.43</span> <span class="selector-tag">-0</span><span class="selector-class">.71</span>  0<span class="selector-class">.09</span> <span class="selector-tag">-0</span><span class="selector-class">.17</span>  1<span class="selector-class">.00</span></div></pre></td></tr></table></figure>
<p>创建图层：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">g &lt;- ggplot(cormat_melt, aes(x=Var1, y=Var2))</div></pre></td></tr></table></figure></p>
<p>在此基础上可添加的图层有：</p>
<ul>
<li>geom_tile(): 瓦片图</li>
<li>geom_raster(): 光栅图，瓦片图的一种，只不过所有的tiles都是一样的大小 </li>
</ul>
<p>现在使用使用geom_tile()绘制相关性矩阵图，我们这里这绘制下三角矩阵图，首先要整理数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#获得相关矩阵的下三角</div><div class="line">get_lower_tri &lt;- function(cormat)&#123;</div><div class="line">  cormat[upper.tri(cormat)] &lt;- NA</div><div class="line">  return(cormat)</div><div class="line">&#125;</div><div class="line">#获得相关矩阵的上三角</div><div class="line">get_upper_tri &lt;- function(cormat)&#123;</div><div class="line">  cormat[lower.tri(cormat)] &lt;- NA</div><div class="line">  return(cormat)</div><div class="line">&#125;</div><div class="line">upper_tri &lt;- get_upper_tri(cormat = cormat)</div><div class="line">head(upper_tri)</div></pre></td></tr></table></figure></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##      mpg  disp    hp  drat    wt  qsec</div><div class="line">## mpg    <span class="number">1</span> <span class="number">-0.85</span> <span class="number">-0.78</span>  <span class="number">0.68</span> <span class="number">-0.87</span>  <span class="number">0.42</span></div><div class="line">## disp  NA  <span class="number">1.00</span>  <span class="number">0.79</span> <span class="number">-0.71</span>  <span class="number">0.89</span> <span class="number">-0.43</span></div><div class="line">## hp    NA    NA  <span class="number">1.00</span> <span class="number">-0.45</span>  <span class="number">0.66</span> <span class="number">-0.71</span></div><div class="line">## drat  NA    NA    NA  <span class="number">1.00</span> <span class="number">-0.71</span>  <span class="number">0.09</span></div><div class="line">## wt    NA    NA    NA    NA  <span class="number">1.00</span> <span class="number">-0.17</span></div><div class="line">## qsec  NA    NA    NA    NA    NA  <span class="number">1.00</span></div></pre></td></tr></table></figure>
<p>绘制相关矩阵图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#数据重铸</div><div class="line">upper_tri_melt &lt;- melt(upper_tri, na.rm = TRUE)</div><div class="line">ggplot(data=upper_tri_melt, aes(Var1, y=Var2, fill=value))+</div><div class="line">  geom_tile(color=&quot;white&quot;)+</div><div class="line">  scale_fill_gradient2(low = &quot;blue&quot;, high = &quot;red&quot;, mid = &quot;white&quot;, midpoint = 0, limit=c(-1, 1), space = &quot;Lab&quot;, name=&quot;Person\nCorrelation&quot;)+</div><div class="line">  theme_minimal()+</div><div class="line">  theme(axis.text.x = element_text(angle = 45, vjust = 1, size = 12, hjust = 1))+</div><div class="line">  coord_fixed()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/LL96JDbLi4.png?imageslim" alt="mark"></p>
<blockquote>
<p>上图中蓝色代表互相关，红色代表正相关，至于coord_fixed()保证x，y轴比例为1</p>
</blockquote>
<p>可以看出上图顺序有点乱，我们可以对相关矩阵进行排序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">#构造函数</div><div class="line">reorder_cormat &lt;- function(cormat)&#123;</div><div class="line">  dd &lt;- as.dist((1-cormat)/2)</div><div class="line">  hc &lt;- hclust(dd)</div><div class="line">  cormat &lt;- cormat[hc$order, hc$order]</div><div class="line">&#125;</div><div class="line">cormat &lt;- reorder_cormat(cormat)</div><div class="line">lower_tri &lt;- get_lower_tri(cormat)</div><div class="line">lower_tri_melt &lt;- melt(lower_tri, na.rm = TRUE)</div><div class="line">head(lower_tri_melt)</div></pre></td></tr></table></figure></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   Var1 Var2 value</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 1   hp   hp  1.00</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2 disp   hp  0.79</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 3   wt   hp  0.66</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 4 qsec   hp -0.71</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 5  mpg   hp -0.78</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 6 drat   hp -0.45</span></span></div></pre></td></tr></table></figure>
<p>绘制图形<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">ggheatmap &lt;- ggplot(lower_tri_melt, aes(Var1, Var2, fill=value))+</div><div class="line">  geom_tile(color=&quot;white&quot;)+</div><div class="line">  scale_fill_gradient2(low = &quot;blue&quot;, high = &quot;red&quot;, mid = &quot;white&quot;, midpoint = 0, limit=c(-1, 1), space = &quot;Lab&quot;, name=&quot;Person\nCorrelation&quot;)+</div><div class="line">  theme_minimal()+</div><div class="line"> theme(axis.text.x = element_text(angle = 45, vjust = 1, </div><div class="line">    size = 12, hjust = 1))+</div><div class="line"> coord_fixed()</div><div class="line">print(ggheatmap)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/FDdmmgjJL5.png?imageslim" alt="mark"></p>
<h3 id="图元：多边形、路径、带状、射线（线段）、矩形等"><a href="#图元：多边形、路径、带状、射线（线段）、矩形等" class="headerlink" title="图元：多边形、路径、带状、射线（线段）、矩形等"></a>图元：多边形、路径、带状、射线（线段）、矩形等</h3><p>本节主要讲述的是添加图形元件，将用到一下函数：</p>
<ul>
<li>geom_polygon()：添加多边形</li>
<li>geom_path(): 路径</li>
<li>geom_ribbon(): 带状</li>
<li>geom_segment(): 射线、线段</li>
<li>geom_curve(): 曲线</li>
<li>geom_rect(): 二维矩形</li>
</ul>
<h4 id="添加多边形"><a href="#添加多边形" class="headerlink" title="添加多边形"></a>添加多边形</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(dplyr)</div><div class="line">map_data(&quot;world&quot;)%&gt;%</div><div class="line">  filter(region==c(&quot;China&quot;, &quot;Taiwan&quot;))%&gt;%</div><div class="line">  ggplot(aes(x=long, y=lat, group=group))+</div><div class="line">  geom_polygon(fill=&quot;red&quot;, color=&quot;black&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/Gj3I6E4Kh6.png?imageslim" alt="mark"></p>
<h4 id="添加路径、带状、矩形"><a href="#添加路径、带状、矩形" class="headerlink" title="添加路径、带状、矩形"></a>添加路径、带状、矩形</h4><p>创建图层<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">h &lt;- ggplot(economics, aes(date, unemploy))</div></pre></td></tr></table></figure></p>
<p>添加路径<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">h+geom_path()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/hKCeGeja0m.png?imageslim" alt="mark"></p>
<p>添加带状<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">h+geom_ribbon(aes(ymin=unemploy-800, ymax=unemploy+800), fill = &quot;grey70&quot;)+geom_line(aes(y=unemploy))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/FKG84CB8f1.png?imageslim" alt="mark"></p>
<p>添加矩形<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">h+</div><div class="line">  geom_path()+</div><div class="line">  geom_rect(aes(xmin=as.Date(&quot;1980-01-01&quot;), ymin=-Inf, xmax=as.Date(&quot;1985-01-01&quot;), ymax=Inf), fill=&quot;steelblue&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/c5iBDliiKB.png?imageslim" alt="mark"></p>
<h4 id="添加线段"><a href="#添加线段" class="headerlink" title="添加线段"></a>添加线段</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">i &lt;- ggplot(mtcars, aes(wt, mpg))+geom_point()</div><div class="line">#添加线段</div><div class="line">i+geom_segment(aes(x=2, y=15, xend=3, yend=15))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/lF9GiCg023.png?imageslim" alt="mark"></p>
<p>添加箭头<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">i+geom_segment(aes(x=5, y=30, xend=3.5, yend=25), arrow = arrow(length = unit(0.5, &quot;cm&quot;)))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/ebGE0KdHlc.png?imageslim" alt="mark"></p>
<h4 id="添加曲线"><a href="#添加曲线" class="headerlink" title="添加曲线"></a>添加曲线</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">i+geom_curve(aes(x=2, y=15, xend=3, yend=15), color=&quot;red&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/BHJd8191Am.png?imageslim" alt="mark"></p>
<h3 id="图形参数：主标题、坐标轴标签、图例标题"><a href="#图形参数：主标题、坐标轴标签、图例标题" class="headerlink" title="图形参数：主标题、坐标轴标签、图例标题"></a>图形参数：主标题、坐标轴标签、图例标题</h3><p>创建图层<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)</div><div class="line">p &lt;- ggplot(ToothGrowth, aes(x=dose, y=len))+geom_boxplot()</div></pre></td></tr></table></figure></p>
<p>修改标题以及标签的函数有：</p>
<ul>
<li>ggtitle(“New main title”): 添加主标题</li>
<li>xlab(“New X axis label”): 修改x轴标签</li>
<li>ylab(“New Y axis label”): 修改y轴标签</li>
<li>labs(title = “New main title”, x = “New X axis label”, y = “New Y axis label”): 可同时添加主标题以及坐标轴标签，另外，图例标题也可以用此函数修改</li>
</ul>
<h4 id="修改主标题以及标签"><a href="#修改主标题以及标签" class="headerlink" title="修改主标题以及标签"></a>修改主标题以及标签</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(p &lt;- p+labs(title=&quot;Plot of length\nby dose&quot;, x=&quot;Dose (mg)&quot;, y=&quot;teeth length&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/h0dhdgD0H5.png?imageslim" alt="mark"></p>
<h4 id="修改标签属性：颜色、字体、大小等"><a href="#修改标签属性：颜色、字体、大小等" class="headerlink" title="修改标签属性：颜色、字体、大小等"></a>修改标签属性：颜色、字体、大小等</h4><p>使用theme()修改,element_text()可以具体修改图形参数，element_blank()隐藏标签<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#修改标签</div><div class="line">p+theme(</div><div class="line">plot.title = element_text(color = &quot;red&quot;, size = 14, face = &quot;bold.italic&quot;),</div><div class="line">axis.title.x = element_text(color=&quot;blue&quot;, size = 14, face = &quot;bold&quot;),</div><div class="line">axis.title.y = element_text(color=&quot;#993333&quot;, size = 14, face = &quot;bold&quot;)</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/28K0J6j688.png?imageslim" alt="mark"></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#隐藏标签</div><div class="line">p+theme(</div><div class="line">  plot<span class="selector-class">.title</span> = element_blank(),</div><div class="line">  axis<span class="selector-class">.title</span><span class="selector-class">.x</span> = element_blank(),</div><div class="line">  axis<span class="selector-class">.title</span><span class="selector-class">.y</span> = element_blank()</div><div class="line">)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/0Fe5dGADJi.png?imageslim" alt="mark"></p>
<h4 id="修改图例标题"><a href="#修改图例标题" class="headerlink" title="修改图例标题"></a>修改图例标题</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">p &lt;- ggplot(ToothGrowth, aes(x=dose, y=len, fill=dose))+</div><div class="line">  geom_boxplot()</div><div class="line">p</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/Afhm8Dbaa3.png?imageslim" alt="mark"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#修改图例标题</span></div><div class="line">p+labs(<span class="attribute">fill</span>=<span class="string">"Dose (mg)"</span>)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/dLAe8a3a7K.png?imageslim" alt="mark"></p>
<h3 id="图例位置以及外观"><a href="#图例位置以及外观" class="headerlink" title="图例位置以及外观"></a>图例位置以及外观</h3><h4 id="修改图例位置以及外观"><a href="#修改图例位置以及外观" class="headerlink" title="修改图例位置以及外观"></a>修改图例位置以及外观</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#图例位置在最上面，有五个选项：&quot;left&quot;,&quot;top&quot;, &quot;right&quot;, &quot;bottom&quot;, &quot;none&quot;</div><div class="line">p+theme(legend.position = &quot;top&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/52gIJkL4Fj.png?imageslim" alt="mark"></p>
<p>移除图例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+theme(legend.position = &quot;none&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/akg12aak7l.png?imageslim" alt="mark"></p>
<p>修改图例标题以及标签外观<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">p+theme(</div><div class="line">  legend.title = element_text(color=&quot;blue&quot;),</div><div class="line">  legend.text = element_text(color=&quot;red&quot;)</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/7AgB3J5C56.png?imageslim" alt="mark"></p>
<p>修改图例背景<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+theme(legend.background = element_rect(fill=&quot;lightblue&quot;))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/jB9CJj91hj.png?imageslim" alt="mark"></p>
<h4 id="利用scale-函数自定义图例"><a href="#利用scale-函数自定义图例" class="headerlink" title="利用scale()函数自定义图例"></a>利用scale()函数自定义图例</h4><p>主要两个函数：</p>
<ul>
<li>scale_x_discrete()：修改图例标签顺序</li>
<li>scale_fill_discrete(): 修改图例标题以及标签</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#修改顺序</div><div class="line">p+scale_x_discrete(limits=c(&quot;2&quot;, &quot;0.5&quot;, &quot;1&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/AbFBaAl2a3.png?imageslim" alt="mark"></p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#修改标题以及标签</span></div><div class="line">p+scale_fill_discrete(name=<span class="string">"Dose"</span>, <span class="keyword">label</span><span class="bash">=c(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>))</span></div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/AcKFcEl5j4.png?imageslim" alt="mark"></p>
<h3 id="自动-手动修改颜色"><a href="#自动-手动修改颜色" class="headerlink" title="自动/手动修改颜色"></a>自动/手动修改颜色</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mtcars$cyl &lt;- as.factor(mtcars$cyl)</div></pre></td></tr></table></figure>
<p>创建图层<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># boxplot</div><div class="line">bp &lt;- ggplot(ToothGrowth, aes(x=dose, y=len))</div><div class="line"># scatter plot</div><div class="line">sp &lt;- ggplot(mtcars, aes(x=wt, y=mpg))</div></pre></td></tr></table></figure></p>
<h4 id="修改填充色、轮廓线颜色"><a href="#修改填充色、轮廓线颜色" class="headerlink" title="修改填充色、轮廓线颜色"></a>修改填充色、轮廓线颜色</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bp+geom_boxplot(fill=&quot;steelblue&quot;, color=&quot;red&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/L09ec6fJdi.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sp+geom_point(color=&quot;darkblue&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/dm838FcDID.png?imageslim" alt="mark"></p>
<h4 id="通过映射分组修改颜色"><a href="#通过映射分组修改颜色" class="headerlink" title="通过映射分组修改颜色"></a>通过映射分组修改颜色</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(bp &lt;- bp+geom_boxplot(aes(fill=dose)))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/39aG8c99CA.png?imageslim" alt="mark"></p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(<span class="name">sp</span> &lt;- sp+geom_point(<span class="name">aes</span>(<span class="name">color=cyl</span>)))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/6lAKJH6FcI.png?imageslim" alt="mark"></p>
<h4 id="手动修改颜色"><a href="#手动修改颜色" class="headerlink" title="手动修改颜色"></a>手动修改颜色</h4><p>主要两个函数：</p>
<ul>
<li>scale_fill_manual(): 填充色</li>
<li>scale_color_manual()：轮廓色，如点线</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># Box plot</div><div class="line">bp + scale_fill_manual(values=c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/5l8CkJeG3b.png?imageslim" alt="mark"></p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># Scatter plot</div><div class="line">sp + scale_color_manual(<span class="name">values=c</span>(<span class="string">"#999999"</span>, <span class="string">"#E69F00"</span>, <span class="string">"#56B4E9"</span>))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/mlmKH9mDm0.png?imageslim" alt="mark"></p>
<h4 id="使用RColorBrewer调色板"><a href="#使用RColorBrewer调色板" class="headerlink" title="使用RColorBrewer调色板"></a>使用<strong>RColorBrewer</strong>调色板</h4><ul>
<li>scale_fill_brewer(): 填充色</li>
<li>scale_color_brewer()：轮廓色，如点线</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># Box plot</div><div class="line">bp + scale_fill_brewer(palette=&quot;Dark2&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/fdgD6lfCLK.png?imageslim" alt="mark"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Scatter plot</span></div><div class="line">sp + scale_color_brewer(<span class="attribute">palette</span>=<span class="string">"Dark2"</span>)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/I4K7c25E00.png?imageslim" alt="mark"></p>
<p><strong>RColorBrewer</strong>包提供以下调色板</p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170917/2mh2le2j13.png?imageslim" alt=""></p>
<p>还专门有一个灰度调色板：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># Box plot</div><div class="line">bp + scale_fill_grey() + theme_classic()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/el4C3gckcd.png?imageslim" alt="mark"></p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Scatter plot</span></div><div class="line"><span class="built_in">sp</span> + <span class="keyword">scale_color_grey() </span>+ theme_classic()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/5B3cgiFbH6.png?imageslim" alt="mark"></p>
<h4 id="梯度或连续颜色"><a href="#梯度或连续颜色" class="headerlink" title="梯度或连续颜色"></a>梯度或连续颜色</h4><p>有时我们会将某个连续变量映射给颜色，这时修改这种梯度或连续型颜色就可以使用以下函数：</p>
<ul>
<li>scale_color_gradient(), scale_fill_gradient()：两种颜色的连续梯度</li>
<li>scale_color_gradient2(), scale_fill_gradient2()：不同梯度</li>
<li>scale_color_gradientn(), scale_fill_gradientn()：多种颜色梯度</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># Color by qsec values</div><div class="line">sp2&lt;-ggplot(mtcars, aes(x=wt, y=mpg)) +</div><div class="line">  geom_point(aes(color = qsec))</div><div class="line">sp2</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/DfKHLjH6mm.png?imageslim" alt="mark"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Change the low and high colors</span></div><div class="line"><span class="comment"># Sequential color scheme</span></div><div class="line">sp2+scale_color_gradient(<span class="attribute">low</span>=<span class="string">"blue"</span>, <span class="attribute">high</span>=<span class="string">"red"</span>)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/g4mj6HBA2d.png?imageslim" alt="mark"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Diverging color scheme</span></div><div class="line">mid&lt;-mean(mtcars<span class="variable">$qsec</span>)</div><div class="line">sp2+scale_color_gradient2(<span class="attribute">midpoint</span>=mid, <span class="attribute">low</span>=<span class="string">"blue"</span>, <span class="attribute">mid</span>=<span class="string">"white"</span>,</div><div class="line">                          <span class="attribute">high</span>=<span class="string">"red"</span>, space = <span class="string">"Lab"</span> )</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/jemKdg7ai2.png?imageslim" alt="mark"></p>
<h3 id="点颜色、大小、形状"><a href="#点颜色、大小、形状" class="headerlink" title="点颜色、大小、形状"></a>点颜色、大小、形状</h3><p>R提供的点形状是由数字表示的，具体如下：</p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170917/g7gjFCb420.png?imageslim" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># Basic scatter plot</div><div class="line">ggplot(mtcars, aes(x=wt, y=mpg)) +</div><div class="line">  geom_point(shape = 18, color = &quot;steelblue&quot;, size = 4)</div></pre></td></tr></table></figure>
<p>  <img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/EG65iAcdaI.png?imageslim" alt="mark"></p>
  <figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># Change point shapes and colors by groups</div><div class="line">ggplot(<span class="name">mtcars</span>, aes(<span class="name">x=wt</span>, y=mpg)) +</div><div class="line">  geom_point(<span class="name">aes</span>(<span class="name">shape</span> = cyl, color = cyl))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/mKAb95CAk6.png?imageslim" alt="mark"></p>
<p>可通过以下方法对点的颜色、大小、形状进行修改：</p>
<ul>
<li>scale_shape_manual() : to change point shapes</li>
<li>scale_color_manual() : to change point colors</li>
<li>scale_size_manual() : to change the size of points</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Change colors and shapes manually</div><div class="line">ggplot(mtcars, aes(x=wt, y=mpg, group=cyl)) +</div><div class="line">  geom_point(aes(shape=cyl, color=cyl), size=2)+</div><div class="line">  scale_shape_manual(values=c(3, 16, 17))+</div><div class="line">  scale_color_manual(values=c(&apos;#999999&apos;,&apos;#E69F00&apos;, &apos;#56B4E9&apos;))+</div><div class="line">  theme(legend.position=&quot;top&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/Cj4aedai9j.png?imageslim" alt="mark"></p>
<h3 id="文本注释-1"><a href="#文本注释-1" class="headerlink" title="文本注释"></a>文本注释</h3><p>对图形进行文本注释有以下方法：</p>
<ul>
<li>geom_text(): 文本注释</li>
<li>geom_label(): 文本注释,类似于geom_text(),只是多了个背景框</li>
<li>annotate(): 文本注释</li>
<li>annotation_custom(): 分面时可以在所有的面板进行文本注释</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">set.seed(1234)</div><div class="line">df &lt;- mtcars[sample(1:nrow(mtcars), 10), ]</div><div class="line">df$cyl &lt;- as.factor(df$cyl)</div></pre></td></tr></table></figure>
<p>散点图注释<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># Scatter plot</div><div class="line">sp &lt;- ggplot(df, aes(x=wt, y=mpg))+ geom_point() </div><div class="line"># Add text, change colors by groups</div><div class="line">sp + geom_text(aes(label = rownames(df), color = cyl),</div><div class="line">               size = 3, vjust = -1)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/0EAk2aFEJG.png?imageslim" alt="mark"></p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Add text at a particular coordinate</span></div><div class="line">sp + geom_text(x = <span class="number">3</span>, y = <span class="number">30</span>, <span class="keyword">label</span><span class="bash"> = <span class="string">"Scatter plot"</span>,</span></div><div class="line">              color=<span class="string">"red"</span>)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/8A620eJKDl.png?imageslim" alt="mark"></p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># geom_label()进行注释</span></div><div class="line">sp + geom_label(aes(<span class="keyword">label</span><span class="bash">=rownames(df)))</span></div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/D6ick1LI9i.png?imageslim" alt="mark"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># annotation_custom(),需要用到textGrob()</span></div><div class="line">library(grid)</div><div class="line"><span class="comment"># Create a text</span></div><div class="line">grob &lt;- grobTree(textGrob(<span class="string">"Scatter plot"</span>, <span class="attribute">x</span>=0.1,  <span class="attribute">y</span>=0.95, <span class="attribute">hjust</span>=0,</div><div class="line">  <span class="attribute">gp</span>=gpar(col="red", <span class="attribute">fontsize</span>=13, <span class="attribute">fontface</span>=<span class="string">"italic"</span>)))</div><div class="line"><span class="comment"># Plot</span></div><div class="line">sp + annotation_custom(grob)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/80EK39ebBA.png?imageslim" alt="mark"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#分面注释</span></div><div class="line">sp + annotation_custom(grob)+facet_wrap(~cyl, <span class="attribute">scales</span>=<span class="string">"free"</span>)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/cdfK8keKee.png?imageslim" alt="mark"></p>
<h3 id="线型"><a href="#线型" class="headerlink" title="线型"></a>线型</h3><p>R里的线型有七种：“blank”, “solid”, “dashed”, “dotted”, “dotdash”, “longdash”, “twodash”，对应数字0，1，2，3，4，5，6.</p>
<p>具体如下：</p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170917/2gAL9gilee.png?imageslim" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># Create some data</div><div class="line">df2 &lt;- data.frame(sex = rep(c(&quot;Female&quot;, &quot;Male&quot;), each=3),</div><div class="line">                  time=c(&quot;breakfeast&quot;, &quot;Lunch&quot;, &quot;Dinner&quot;),</div><div class="line">                  bill=c(10, 30, 15, 13, 40, 17) )</div><div class="line">head(df2)</div></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"><span class="comment">#      sex       time bill</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 1 Female breakfeast   10</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2 Female      Lunch   30</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 3 Female     Dinner   15</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 4   Male breakfeast   13</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 5   Male      Lunch   40</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 6   Male     Dinner   17</span></span></div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Line plot with multiple groups</div><div class="line"># Change line types and colors by groups (sex)</div><div class="line">ggplot(df2, aes(x=time, y=bill, group=sex)) +</div><div class="line">  geom_line(aes(linetype = sex, color = sex))+</div><div class="line">  geom_point(aes(color=sex))+</div><div class="line">  theme(legend.position=&quot;top&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/leH2fj5jf7.png?imageslim" alt="mark"></p>
<p>同点一样，线也可以类似修改：</p>
<ul>
<li>scale_linetype_manual() : to change line types</li>
<li>scale_color_manual() : to change line colors</li>
<li>scale_size_manual() : to change the size of lines</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># Change line types, colors and sizes</div><div class="line">ggplot(df2, aes(x=time, y=bill, group=sex)) +</div><div class="line">  geom_line(aes(linetype=sex, color=sex, size=sex))+</div><div class="line">  geom_point()+</div><div class="line">  scale_linetype_manual(values=c(&quot;twodash&quot;, &quot;dotted&quot;))+</div><div class="line">  scale_color_manual(values=c(&apos;#999999&apos;,&apos;#E69F00&apos;))+</div><div class="line">  scale_size_manual(values=c(1, 1.5))+</div><div class="line">  theme(legend.position=&quot;top&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/j9EajEBa9b.png?imageslim" alt="mark"></p>
<h3 id="主题与背景颜色"><a href="#主题与背景颜色" class="headerlink" title="主题与背景颜色"></a>主题与背景颜色</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># Convert the column dose from numeric to factor variable</div><div class="line">ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)</div></pre></td></tr></table></figure>
<p>创建箱线图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">p &lt;- ggplot(ToothGrowth, aes(x=dose, y=len))+</div><div class="line">  geom_boxplot()</div></pre></td></tr></table></figure></p>
<p>修改主题<br><strong>ggplot2</strong>提供了好几种主题，另外有一个扩展包<strong>ggthemes</strong>专门提供了一主题，可以安装利用。<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">install</span>.packages(<span class="string">"ggthemes"</span>)</div></pre></td></tr></table></figure></p>
<ul>
<li>theme_gray(): gray background color and white grid lines</li>
<li>theme_bw() : white background and gray grid lines</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+theme_gray(base_size = 14)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/hj1eIbED8J.png?imageslim" alt="mark"></p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+theme_bw<span class="comment">()</span></div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/DIL3A3j3H0.png?imageslim" alt="mark"></p>
<ul>
<li>theme_linedraw : black lines around the plot</li>
<li>theme_light : light gray lines and axis (more attention towards the data)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p + theme_linedraw()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/dllCEkgbJd.png?imageslim" alt="mark"></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">p</span> + theme_light()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/HIE1djID57.png?imageslim" alt="mark"></p>
<ul>
<li>theme_minimal: no background annotations</li>
<li>theme_classic : theme with axis lines and no grid lines</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p + theme_minimal()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/DldJFIi1jG.png?imageslim" alt="mark"></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">p</span> + theme_classic()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/kdb786kHb6.png?imageslim" alt="mark"></p>
<p><strong>ggthemes</strong>提供的主题<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+ggthemes::theme_economist()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/mhE0cglig4.png?imageslim" alt="mark"></p>
<h4 id="坐标轴：最大最小值"><a href="#坐标轴：最大最小值" class="headerlink" title="坐标轴：最大最小值"></a>坐标轴：最大最小值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p &lt;- ggplot(cars, aes(x=speed, y=dist))+geom_point()</div></pre></td></tr></table></figure>
<p>修改坐标轴范围有以下几种方式：<br>1、不删除数据</p>
<ul>
<li>p+coord_cartesian(xlim=c(5, 20), ylim=c(0, 50)):笛卡尔坐标系，这是设定修改不会删除数据</li>
</ul>
<p>2、会删除部分数据：不在此范围内的数据都会被删除,因此在此基础上添加图层时数据是不完整的</p>
<ul>
<li>p+xlim(5, 20)+ylim(0, 50)</li>
<li>p+scale_x_continuous(limits=c(5, 20))+scale_y_continuous(limits=c(0, 50))</li>
</ul>
<p>3、扩展图形范围：expand()函数，扩大范围</p>
<ul>
<li>p+expand_limits(x=0, y=0):设置截距为0，即过原点</li>
<li>p+expand_limits(x=c(5, 50), y=c(0, 150))：扩大坐标轴范围，这样图形显示就小了</li>
</ul>
<p>下面通过图形演示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/45E5EkIbmH.png?imageslim" alt="mark"></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#通过coord_cartesian()函数修改坐标轴范围</div><div class="line">p+coord_cartesian(xlim =c (<span class="number">5</span>, <span class="number">20</span>), ylim = c(<span class="number">0</span>, <span class="number">50</span>))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/cbia8kk48E.png?imageslim" alt="mark"></p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#通过<span class="selector-tag">xlim</span>()和<span class="selector-tag">ylim</span>()函数修改</div><div class="line"><span class="selector-tag">p</span>+<span class="selector-tag">xlim</span>(<span class="number">5</span>, <span class="number">20</span>)+<span class="selector-tag">ylim</span>(<span class="number">0</span>, <span class="number">50</span>)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/cbia8kk48E.png?imageslim" alt="mark"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#expand limits</span></div><div class="line">p+expand_limits(<span class="attribute">x</span>=c(5, 50), <span class="attribute">y</span>=c(0, 150))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/m44Dlla2Cl.png?imageslim" alt="mark"></p>
<h4 id="坐标变换"><a href="#坐标变换" class="headerlink" title="坐标变换"></a>坐标变换</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p &lt;- ggplot(cars, aes(x=speed, y=dist))+geom_point()</div></pre></td></tr></table></figure>
<p>坐标变换有以下几种：</p>
<ul>
<li>p+scale_x_log10(),p+scale_y_log10(): 绘图时对x，y取10的对数</li>
<li>p+scale_x_sqrt(),p+scale_x_sqrt(): 开根号</li>
<li>p+scale_x_reverse(),p+scale_x_reverse()：坐标轴反向</li>
<li>p+coord_trans(x =“log10”, y=“log10”): 同上，可以对坐标轴取对数、根号等</li>
<li>p+scale_x_continuous(trans=”log2”),p+scale_x_continuous(trans=”log2”): 同上，取对数的另外一种方法</li>
</ul>
<p>下面实例演示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/90aD77ldKb.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">p+scale_x_continuous(trans = &quot;log2&quot;)+</div><div class="line">  scale_y_continuous(trans = &quot;log2&quot;)</div></pre></td></tr></table></figure>
<p>  <img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/mI8LDhgJE9.png?imageslim" alt="mark"></p>
 <figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#修改坐标刻度标签</span></div><div class="line"><span class="keyword">require</span>(scales)</div><div class="line">p+scale_y_continuous(trans=log2_trans(),</div><div class="line">                     breaks = trans_breaks(<span class="string">"log2"</span>, <span class="function"><span class="keyword">function</span><span class="params">(x)</span> 2^<span class="title">x</span>),</span></div><div class="line">                     <span class="title">labels</span>=<span class="title">trans_format</span><span class="params">(<span class="string">"log2"</span>, math_format<span class="params">(<span class="number">2</span>^.x)</span>)</span>)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/F94egDhaID.png?imageslim" alt="mark"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash">坐标轴反向</span></div><div class="line">p+scale_y_reverse()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/L68AbbdeH9.png?imageslim" alt="mark"></p>
<h4 id="坐标刻度：刻度线、标签、顺序等"><a href="#坐标刻度：刻度线、标签、顺序等" class="headerlink" title="坐标刻度：刻度线、标签、顺序等"></a>坐标刻度：刻度线、标签、顺序等</h4><p>更改坐标轴刻度线标签等函数：</p>
<ul>
<li>element_text(face, color, size, angle): 修改文本风格</li>
<li>element_blank(): 隐藏文本</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(p &lt;- ggplot(ToothGrowth, aes(x=dose, y=len))+geom_boxplot())</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/22F52FHA0H.png?imageslim" alt="mark"></p>
<p>修改刻度标签等<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">p+theme(axis.text.x = element_text(face = &quot;bold&quot;, color=&quot;#993333&quot;, size=14, angle = 45),</div><div class="line">        axis.text.y = element_text(face = &quot;bold&quot;, size = 14, color = &quot;blue&quot;, angle = 45))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/7k09a4DhDb.png?imageslim" alt="mark"></p>
<p>移除刻度标签等<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">p + theme(</div><div class="line">  axis.text.x = element_blank(), # Remove x axis tick labels</div><div class="line">  axis.text.y = element_blank(), # Remove y axis tick labels</div><div class="line">  axis.ticks = element_blank()) # Remove ticks</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/lmmg7BEa1m.png?imageslim" alt="mark"></p>
<p>当然可以自定义坐标轴了</p>
<ul>
<li><p>离散非连续坐标轴</p>
<ul>
<li>scale_x_discrete(name, breaks, labels, limits)</li>
<li>scale_y_discrete(name, breaks, labels, limits)</li>
</ul>
</li>
<li><p>连续型坐标轴</p>
<ul>
<li>scale_x_conyinuous(name, breaks, labels, limits)</li>
<li>scale_y_continuous(name, breaks, labels, limits)</li>
</ul>
</li>
</ul>
<p>详细情况如下：</p>
<ul>
<li>name: x,y轴的标题</li>
<li>breaks: 刻度，分成几段</li>
<li>labels：坐标轴刻度线标签</li>
<li>limits: 坐标轴范围</li>
</ul>
<p>其中scale_xx()函数可以修改坐标轴的如下参数：</p>
<ul>
<li>坐标轴标题</li>
<li>坐标轴范围</li>
<li>刻度标签位置</li>
<li>手动设置刻度标签</li>
</ul>
<p>具体演示：</p>
<ul>
<li>离散坐标轴</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#修改标签以及顺序</div><div class="line">p+scale_x_discrete(name=&quot;Dose (mg)&quot;, limits=c(&quot;2&quot;, &quot;1&quot;, &quot;0.5&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/EFbiHLHg4H.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#修改刻度标签</div><div class="line">p+scale_x_discrete(breaks=c(&quot;0.5&quot;, &quot;1&quot;, &quot;2&quot;),labels=c(&quot;Dose 0.5&quot;, &quot;Dose 1&quot;, &quot;Dose 2&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/7b8a55d8e6.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#修改要显示的项</div><div class="line">p+scale_x_discrete(limits=c(&quot;0.5&quot;, &quot;2&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/KEBgH9eL6A.png?imageslim" alt="mark"></p>
<ul>
<li>连续型坐标轴<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#散点图</div><div class="line">(sp &lt;- ggplot(cars, aes(x=speed, y=dist))+geom_point())</div></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/6mAgGel8FI.png?imageslim" alt="mark"></p>
<p>修改坐标轴标签以及范围<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(sp &lt;- sp+scale_x_continuous(name = &quot;Speed of cars&quot;, limits = c(0, 30))+</div><div class="line">  scale_y_continuous(name = &quot;Stopping distance&quot;, limits = c(0, 150)))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/1Gfa1ki6jd.png?imageslim" alt="mark"></p>
<p>更改y轴刻度，间隔50<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sp+scale_y_continuous(breaks = seq(0, 150, 50))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/67LdJdeHJJ.png?imageslim" alt="mark"></p>
<p>修改y轴标签为百分数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">require(scales)</div><div class="line">sp+scale_y_continuous(labels = percent)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/lKBLj42Fmb.png?imageslim" alt="mark"></p>
<h3 id="添加直线：水平线、竖直线、回归线"><a href="#添加直线：水平线、竖直线、回归线" class="headerlink" title="添加直线：水平线、竖直线、回归线"></a>添加直线：水平线、竖直线、回归线</h3><p><strong>ggplot2</strong>提供以下方法为图形添加直线：</p>
<ul>
<li>geom_hline(yintercept, linetype, color, size): 添加水平线</li>
<li>geom_vline(xintercept, linetype, color, size)：添加竖直线</li>
<li>geom_abline(intercept, slope, linetype, color, size)：添加回归线</li>
<li>geom_segment()：添加线段</li>
</ul>
<p>实例演示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sp &lt;- ggplot(data=mtcars, aes(x=wt, y=mpg))+ geom_point()</div></pre></td></tr></table></figure></p>
<p>添加直线：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#在y=20处添加一水平线，并设置颜色等</div><div class="line">sp+geom_hline(yintercept = 20, linetype=&quot;dashed&quot;, color=&apos;red&apos;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/klELKdJ7h2.png?imageslim" alt="mark"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#在x=3处添加一竖直线，并设置颜色等</span></div><div class="line">sp+geom_vline(xintercept = 3, <span class="attribute">color</span>=<span class="string">"blue"</span>, <span class="attribute">size</span>=1.5)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/5cIFlhkK0E.png?imageslim" alt="mark"></p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#添加回归线</span></div><div class="line">sp+geom_abline<span class="params">(<span class="attr">intercept</span> = 37, <span class="attr">slope</span> = -5, <span class="attr">color</span>="blue")</span></div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/Jci00jI819.png?imageslim" alt="mark"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#添加水平线段</span></div><div class="line">sp+geom_segment(aes(<span class="attribute">x</span>=2, <span class="attribute">y</span>=15, <span class="attribute">xend</span>=3, <span class="attribute">yend</span>=15), <span class="attribute">color</span>=<span class="string">"red"</span>)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/1gAEcm93JF.png?imageslim" alt="mark"></p>
<h3 id="图形旋转：旋转、反向"><a href="#图形旋转：旋转、反向" class="headerlink" title="图形旋转：旋转、反向"></a>图形旋转：旋转、反向</h3><p>主要是下面两个函数：</p>
<ul>
<li>coord_flip()：创建水平方向图</li>
<li>scale_x_reverse(),scale_y_reverse()：坐标轴反向</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">set.seed(1234)</div><div class="line">(hp &lt;- qplot(x=rnorm(200), geom = &quot;histogram&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/CgC7HHLid5.png?imageslim" alt="mark"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash">水平柱形图</span></div><div class="line">hp+coord_flip()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/hD4HaiCDJI.png?imageslim" alt="mark"></p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-id">#y</span>轴反向</div><div class="line"><span class="selector-tag">hp</span>+<span class="selector-tag">scale_y_reverse</span>()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/HCFl1ha75C.png?imageslim" alt="mark"></p>
<h3 id="分面"><a href="#分面" class="headerlink" title="分面"></a>分面</h3><p>分面就是根据一个或多个变量将图形分为几个图形以便于可视化，主要有两个方法实现：</p>
<ul>
<li>facet_grid()</li>
<li>facet_wrap()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)</div><div class="line">(p &lt;- ggplot(ToothGrowth, aes(x=dose, y=len, group=dose))+</div><div class="line">  geom_boxplot(aes(fill=dose)))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/3AfigK2AIl.png?imageslim" alt="mark"></p>
<p>针对上面图形进行分面：</p>
<ul>
<li>p+facet_grid(supp~.): 按变量supp进行竖直方向分面</li>
<li>p+facet_grid(.~supp): 按变量supp进行水平方向分面</li>
<li>p+facet_wrap(dose~supp)：按双变量supp和dose进行水平竖直方向分面</li>
<li>p+facet_wrap(~fl): 将分成的面板边靠边置于一个矩形框内</li>
</ul>
<p>1、按一个离散变量进行分面：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#竖直方向进行分面</div><div class="line">p+facet_grid(supp~.)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/e5hdDE7FE0.png?imageslim" alt="mark"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash">水平方向分面</span></div><div class="line">p+facet_grid(.~supp)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/F3BgFeHc3C.png?imageslim" alt="mark"></p>
<p>2、按两个离散变量进行分面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#行按dose分面，列按supp分面</div><div class="line">p+facet_grid(dose~supp)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/9112kbBA9g.png?imageslim" alt="mark"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash">行按supp，列按dose分面</span></div><div class="line">p+facet_grid(supp~dose)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/bjm9fk0k79.png?imageslim" alt="mark"></p>
<p>从上面图形可以看出，每个面板的坐标轴比例都是一样的，我们可以通过设置参数scales来控制坐标轴比例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p + facet_grid(dose ~ supp, scales=&apos;free&apos;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/65F4K0ajaI.png?imageslim" alt="mark"></p>
<h3 id="位置调整"><a href="#位置调整" class="headerlink" title="位置调整"></a>位置调整</h3><p>很多图形需要我们调整位置，比如直方图时，由堆叠式、百分式、分离式等，具体的要通过实例说明<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">p &lt;- ggplot(mpg, aes(fl, fill=drv))</div><div class="line">#直方图边靠边排列，参数position=&quot;dodge&quot;</div><div class="line">p+geom_bar(position = &quot;dodge&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/13Cf1kA3Jc.png?imageslim" alt="mark"></p>
<p>堆叠式position=”stack”<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+geom_bar(position = &quot;stack&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/J2bH42IjHA.png?imageslim" alt="mark"></p>
<p>position=”fill”类似玉堆叠图，只不过按百分比排列，所有柱子都被标准化成同样高度<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+geom_bar(position = &quot;fill&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/1iblgciCm8.png?imageslim" alt="mark"></p>
<p>position=”jitter”,（主要适用于散点图）增加扰动，避免重叠，前面讲的geom_jitter()就是来源于此<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ggplot(mpg, aes(cty, hwy))+</div><div class="line">  geom_point(position = &quot;jitter&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/01D9L4A8Ld.png?imageslim" alt="mark"></p>
<p>上面几个函数有两个重要的参数：heigth、weight。</p>
<ul>
<li>position_dodge(width, height)</li>
<li>position_fill(width, height)</li>
<li>position_stack(width, height)</li>
<li>position_jitter(width, height)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+geom_bar(position = position_dodge(width = 1))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/DaHcfl9dId.png?imageslim" alt="mark"></p>
<h3 id="坐标系"><a href="#坐标系" class="headerlink" title="坐标系"></a>坐标系</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p &lt;- ggplot(mpg, aes(fl))+geom_bar()</div></pre></td></tr></table></figure>
<p><strong>ggplot2</strong>中的坐标系主要有：</p>
<ul>
<li>p+coord_cartesian(xlim=NULL, ylim=NULL)：笛卡尔坐标系(默认)</li>
<li>p+coord_fixed(ratio=1, clim=NULL, ylim=NULL)：固定了坐标轴比例的笛卡尔坐标系。默认比例为1</li>
<li>p+coord_flip(…)：旋转笛卡尔坐标系</li>
<li>p+coord_polar(theta=”x”, start=0, direction=1)：极坐标系</li>
<li>p+coord_trans(x,y,limx,limy)：变换笛卡尔坐标系</li>
<li>coord_map()：地图坐标系</li>
</ul>
<p>各个坐标系参数如下：<br>1、笛卡尔坐标系：coord_cartesian(), coord_fixed() and coord_flip()</p>
<ul>
<li>xlim：x轴范围</li>
<li>ylim：y轴范围</li>
<li>ratio：y/x</li>
<li>…：其他参数</li>
</ul>
<p>2、极坐标系：coord_polar()</p>
<ul>
<li>theta：外延坐标，x或y</li>
<li>start：坐标开始的位置，默认为12点钟</li>
<li>direction：方向：顺时针(1),逆时针(-1)</li>
</ul>
<p>3、变换坐标系：coord_trans()</p>
<ul>
<li>x,y：变换的坐标轴</li>
<li>limx,limy：坐标轴范围</li>
</ul>
<p>实例演示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+coord_cartesian(ylim = c(0,200))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/KE5JcFmdhl.png?imageslim" alt="mark"></p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+coord_fixed(<span class="name">ratio</span> = <span class="number">1/50</span>)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/LHeG17JljH.png?imageslim" alt="mark"></p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+coord_flip<span class="comment">()</span></div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/8AK62ii9Ib.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+coord_polar(theta = &quot;x&quot;, direction = 1)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/HBF135cLAA.png?imageslim" alt="mark"></p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p+coord_trans(<span class="name">y=</span><span class="string">"sqrt"</span>)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/170919/DhI4Ha1m91.png?imageslim" alt="mark"></p>
<h2 id="ggplot2包资料扩展：包、函数"><a href="#ggplot2包资料扩展：包、函数" class="headerlink" title="ggplot2包资料扩展：包、函数"></a><strong>ggplot2</strong>包资料扩展：包、函数</h2><ul>
<li><strong>ggplot2</strong>有一个官方网站，里面有十分详细的说明，<a href="http://ggplot2.tidyverse.org/reference/" target="_blank" rel="external">点击这里直达</a></li>
<li><strong>ggplot2</strong>还有十分多的扩展包，<a href="https://www.ggplot2-exts.org/" target="_blank" rel="external">点击这里直达</a></li>
</ul>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div><div class="line"></div><div class="line">## R version 3.4.1 (2017-06-30)</div><div class="line">## Platform: x86_64-pc-linux-gnu (64-bit)</div><div class="line">## Running under: Ubuntu 16.04.3 LTS</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## BLAS: /usr/lib/atlas-base/atlas/libblas.so.3.0</div><div class="line">## LAPACK: /usr/lib/atlas-base/atlas/liblapack.so.3.0</div><div class="line">## </div><div class="line">## locale:</div><div class="line">##  [1] LC_CTYPE=zh_CN.UTF-8       LC_NUMERIC=C              </div><div class="line">##  [3] LC_TIME=zh_CN.UTF-8        LC_COLLATE=zh_CN.UTF-8    </div><div class="line">##  [5] LC_MONETARY=zh_CN.UTF-8    LC_MESSAGES=zh_CN.UTF-8   </div><div class="line">##  [7] LC_PAPER=zh_CN.UTF-8       LC_NAME=C                 </div><div class="line">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </div><div class="line">## [11] LC_MEASUREMENT=zh_CN.UTF-8 LC_IDENTIFICATION=C       </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] grid      stats     graphics  grDevices utils     datasets  methods  </div><div class="line">## [8] base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">## [1] scales_0.5.0   bindrcpp_0.2   dplyr_0.7.3    reshape2_1.4.2</div><div class="line">## [5] maps_3.2.0     hexbin_1.27.1  plyr_1.8.4     ggplot2_2.2.1 </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.12        bindr_0.1           compiler_3.4.1     </div><div class="line">##  [4] RColorBrewer_1.1-2  base64enc_0.1-3     tools_3.4.1        </div><div class="line">##  [7] rpart_4.1-11        digest_0.6.12       checkmate_1.8.3    </div><div class="line">## [10] htmlTable_1.9       evaluate_0.10.1     tibble_1.3.4       </div><div class="line">## [13] gtable_0.2.0        lattice_0.20-35     pkgconfig_2.0.1    </div><div class="line">## [16] rlang_0.1.2         Matrix_1.2-11       yaml_2.1.14        </div><div class="line">## [19] gridExtra_2.3       stringr_1.2.0       knitr_1.17         </div><div class="line">## [22] cluster_2.0.6       htmlwidgets_0.9     rprojroot_1.2      </div><div class="line">## [25] nnet_7.3-12         glue_1.1.1          data.table_1.10.4  </div><div class="line">## [28] R6_2.2.2            survival_2.41-3     foreign_0.8-69     </div><div class="line">## [31] rmarkdown_1.6       latticeExtra_0.6-28 Formula_1.2-2      </div><div class="line">## [34] magrittr_1.5        ggthemes_3.4.0      backports_1.1.0    </div><div class="line">## [37] Hmisc_4.0-3         htmltools_0.3.6     MASS_7.3-47        </div><div class="line">## [40] splines_3.4.1       assertthat_0.2.0    colorspace_1.3-2   </div><div class="line">## [43] labeling_0.3        stringi_1.1.5       acepack_1.4.1      </div><div class="line">## [46] lazyeval_0.2.0      munsell_0.4.3</div></pre></td></tr></table></figure>
<hr>
<p>联系方式：</p>
<hr>
<p>wechat: yt056410</p>
<p>Email: tyan@zju.edu.cn</p>
<p>QQ: 1051927088</p>
<p>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a></p>
<p>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a></p>
<p>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<p>个人简介：</p>
<hr>
<p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）</p>
<p>伪码农，R语言爱好者，爱开源</p>

      
    </div>
<div>
      
        
      
</div>

    <div>
      
        

      
    </div>
<div>
  
    
<div style="text-align:center;color: #ccc;font-size:14px;">
------ 本文结束<i class="fa fa-paw"></i>感谢您的阅读 ------</div>
<br/>
<div style="border: 1px solid black">
<div style="margin-left:10px">
<span style="font-weight:blod">版权声明</span>
<img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171017/8cG2gjfiDL.png?imageslim" >
<br/>
<p style="font-size: 15px;line-height: 30px"><a href="https://ytlogos.github.io" style="color:#258FC6">Logos</a> by <a href="https://ytlogos.github.io" style="color:#258FC6">Tao Yan</a> is licensed under a <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" style="color:#258FC6">Creative Commons BY-NC-ND 4.0 International License</a>.<br/>
由<a href="https://ytlogos.github.io" style="color:#258FC6">严涛</a>创作并维护的<a href="https://ytlogos.github.io" style="color:#258FC6">Logos</a>博客采用<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" style="color:#258FC6">创作共用保留署名-非商业-禁止演绎4.0国际许可证</a>。<br/>
本文首发于<a href="https://ytlogos.github.io" style="color:#258FC6">Logos</a> 博客（ <a href="https://ytlogos.github.io" style="color:#258FC6">https://ytlogos.github.io</a> ），版权所有，侵权必究。</p>
</div>
</div>

  
</div>
    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>如果觉得文章不错，请作者喝杯咖啡！</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171017/jGLlL0g4aH.png?imageslim" alt="TaoYan WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171017/EBfhf7e6lG.png?imageslim" alt="TaoYan Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/R/" rel="tag"><i class="fa fa-tag"></i> R</a>
          
            <a href="/tags/visualization/" rel="tag"><i class="fa fa-tag"></i> visualization</a>
          
            <a href="/tags/ggplot2/" rel="tag"><i class="fa fa-tag"></i> ggplot2</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/09/16/tidyverse实践之绘制简单地图/" rel="next" title="tidyverse实践之绘制简单地图">
                <i class="fa fa-chevron-left"></i> tidyverse实践之绘制简单地图
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/10/15/R语言可视化之UpSetR包/" rel="prev" title="R语言可视化之UpSetR包">
                R语言可视化之UpSetR包 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171017/Kh4BagCbCG.png?imageslim"
               alt="TaoYan" />
          <p class="site-author-name" itemprop="name">TaoYan</p>
           
              <p class="site-description motion-element" itemprop="description">R&Data Science&Bioinformatics</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">73</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">52</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/YTLogos" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/TaoYANLogos" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" title="简书">
                  
                    <i class="fa fa-fw fa-heartbeat"></i>
                  
                  简书
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-block">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              推荐阅读
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://vip.biotrainee.com" title="生信技能树" target="_blank">生信技能树</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.sthda.com/english/" title="STHDA" target="_blank">STHDA</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://sharpsightlabs.com" title="SHARP SIGHT LABS" target="_blank">SHARP SIGHT LABS</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://rosalind.info/problems/locations/" title="ROSALIND" target="_blank">ROSALIND</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.r-graph-gallery.com" title="R GRAPH GALLERY" target="_blank">R GRAPH GALLERY</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#简介"><span class="nav-number">1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#图形类型"><span class="nav-number">2.</span> <span class="nav-text">图形类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装及加载"><span class="nav-number">3.</span> <span class="nav-text">安装及加载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据准备"><span class="nav-number">4.</span> <span class="nav-text">数据准备</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#qplot"><span class="nav-number">5.</span> <span class="nav-text">qplot()</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#散点图"><span class="nav-number">5.1.</span> <span class="nav-text">散点图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#箱线图、小提琴图、点图"><span class="nav-number">5.2.</span> <span class="nav-text">箱线图、小提琴图、点图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#直方图、密度图"><span class="nav-number">5.3.</span> <span class="nav-text">直方图、密度图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ggplot"><span class="nav-number">6.</span> <span class="nav-text">ggplot()</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一个变量：连续型"><span class="nav-number">6.1.</span> <span class="nav-text">一个变量：连续型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#面积图"><span class="nav-number">6.1.1.</span> <span class="nav-text">面积图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#密度图"><span class="nav-number">6.1.2.</span> <span class="nav-text">密度图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#点图"><span class="nav-number">6.1.3.</span> <span class="nav-text">点图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#频率多边图"><span class="nav-number">6.1.4.</span> <span class="nav-text">频率多边图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#直方图"><span class="nav-number">6.1.5.</span> <span class="nav-text">直方图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#经验累积密度图"><span class="nav-number">6.1.6.</span> <span class="nav-text">经验累积密度图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#QQ图"><span class="nav-number">6.1.7.</span> <span class="nav-text">QQ图</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一个离散变量"><span class="nav-number">6.2.</span> <span class="nav-text">一个离散变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#两个变量：x-y皆连续"><span class="nav-number">6.3.</span> <span class="nav-text">两个变量：x,y皆连续</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#散点图-1"><span class="nav-number">6.3.1.</span> <span class="nav-text">散点图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#平滑线"><span class="nav-number">6.3.2.</span> <span class="nav-text">平滑线</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#分位线"><span class="nav-number">6.3.3.</span> <span class="nav-text">分位线</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#边际地毯线"><span class="nav-number">6.3.4.</span> <span class="nav-text">边际地毯线</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#避免重叠"><span class="nav-number">6.3.5.</span> <span class="nav-text">避免重叠</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#文本注释"><span class="nav-number">6.3.6.</span> <span class="nav-text">文本注释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#两个变量：连续二元分布"><span class="nav-number">6.4.</span> <span class="nav-text">两个变量：连续二元分布</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#二维封箱热图"><span class="nav-number">6.4.1.</span> <span class="nav-text">二维封箱热图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#六边形封箱图"><span class="nav-number">6.4.2.</span> <span class="nav-text">六边形封箱图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#二维等高线密度图"><span class="nav-number">6.4.3.</span> <span class="nav-text">二维等高线密度图</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#两个变量：连续函数"><span class="nav-number">6.5.</span> <span class="nav-text">两个变量：连续函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#面积图-1"><span class="nav-number">6.5.1.</span> <span class="nav-text">面积图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#线图"><span class="nav-number">6.5.2.</span> <span class="nav-text">线图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#阶梯图"><span class="nav-number">6.5.3.</span> <span class="nav-text">阶梯图</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#两个变量：x离散，y连续"><span class="nav-number">6.6.</span> <span class="nav-text">两个变量：x离散，y连续</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#箱线图"><span class="nav-number">6.6.1.</span> <span class="nav-text">箱线图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#小提琴图"><span class="nav-number">6.6.2.</span> <span class="nav-text">小提琴图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#点图-1"><span class="nav-number">6.6.3.</span> <span class="nav-text">点图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#带状图"><span class="nav-number">6.6.4.</span> <span class="nav-text">带状图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#线图-1"><span class="nav-number">6.6.5.</span> <span class="nav-text">线图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#条形图"><span class="nav-number">6.6.6.</span> <span class="nav-text">条形图</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#两个变量：x、y皆离散"><span class="nav-number">6.7.</span> <span class="nav-text">两个变量：x、y皆离散</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#两个变量：绘制误差图"><span class="nav-number">6.8.</span> <span class="nav-text">两个变量：绘制误差图</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#geom-crossbar"><span class="nav-number">6.8.1.</span> <span class="nav-text">geom_crossbar()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#误差棒"><span class="nav-number">6.8.2.</span> <span class="nav-text">误差棒</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#水平误差棒"><span class="nav-number">6.8.3.</span> <span class="nav-text">水平误差棒</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#geom-linerange-与geom-pointrange"><span class="nav-number">6.8.4.</span> <span class="nav-text">geom_linerange()与geom_pointrange()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#点图-误差棒"><span class="nav-number">6.8.5.</span> <span class="nav-text">点图+误差棒</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#两个变量：地图绘制"><span class="nav-number">6.9.</span> <span class="nav-text">两个变量：地图绘制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三个变量"><span class="nav-number">6.10.</span> <span class="nav-text">三个变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#图元：多边形、路径、带状、射线（线段）、矩形等"><span class="nav-number">6.11.</span> <span class="nav-text">图元：多边形、路径、带状、射线（线段）、矩形等</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#添加多边形"><span class="nav-number">6.11.1.</span> <span class="nav-text">添加多边形</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#添加路径、带状、矩形"><span class="nav-number">6.11.2.</span> <span class="nav-text">添加路径、带状、矩形</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#添加线段"><span class="nav-number">6.11.3.</span> <span class="nav-text">添加线段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#添加曲线"><span class="nav-number">6.11.4.</span> <span class="nav-text">添加曲线</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#图形参数：主标题、坐标轴标签、图例标题"><span class="nav-number">6.12.</span> <span class="nav-text">图形参数：主标题、坐标轴标签、图例标题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#修改主标题以及标签"><span class="nav-number">6.12.1.</span> <span class="nav-text">修改主标题以及标签</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#修改标签属性：颜色、字体、大小等"><span class="nav-number">6.12.2.</span> <span class="nav-text">修改标签属性：颜色、字体、大小等</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#修改图例标题"><span class="nav-number">6.12.3.</span> <span class="nav-text">修改图例标题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#图例位置以及外观"><span class="nav-number">6.13.</span> <span class="nav-text">图例位置以及外观</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#修改图例位置以及外观"><span class="nav-number">6.13.1.</span> <span class="nav-text">修改图例位置以及外观</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#利用scale-函数自定义图例"><span class="nav-number">6.13.2.</span> <span class="nav-text">利用scale()函数自定义图例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自动-手动修改颜色"><span class="nav-number">6.14.</span> <span class="nav-text">自动/手动修改颜色</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#修改填充色、轮廓线颜色"><span class="nav-number">6.14.1.</span> <span class="nav-text">修改填充色、轮廓线颜色</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#通过映射分组修改颜色"><span class="nav-number">6.14.2.</span> <span class="nav-text">通过映射分组修改颜色</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#手动修改颜色"><span class="nav-number">6.14.3.</span> <span class="nav-text">手动修改颜色</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用RColorBrewer调色板"><span class="nav-number">6.14.4.</span> <span class="nav-text">使用RColorBrewer调色板</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#梯度或连续颜色"><span class="nav-number">6.14.5.</span> <span class="nav-text">梯度或连续颜色</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#点颜色、大小、形状"><span class="nav-number">6.15.</span> <span class="nav-text">点颜色、大小、形状</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文本注释-1"><span class="nav-number">6.16.</span> <span class="nav-text">文本注释</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#线型"><span class="nav-number">6.17.</span> <span class="nav-text">线型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#主题与背景颜色"><span class="nav-number">6.18.</span> <span class="nav-text">主题与背景颜色</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#坐标轴：最大最小值"><span class="nav-number">6.18.1.</span> <span class="nav-text">坐标轴：最大最小值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#坐标变换"><span class="nav-number">6.18.2.</span> <span class="nav-text">坐标变换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#坐标刻度：刻度线、标签、顺序等"><span class="nav-number">6.18.3.</span> <span class="nav-text">坐标刻度：刻度线、标签、顺序等</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#添加直线：水平线、竖直线、回归线"><span class="nav-number">6.19.</span> <span class="nav-text">添加直线：水平线、竖直线、回归线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#图形旋转：旋转、反向"><span class="nav-number">6.20.</span> <span class="nav-text">图形旋转：旋转、反向</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分面"><span class="nav-number">6.21.</span> <span class="nav-text">分面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#位置调整"><span class="nav-number">6.22.</span> <span class="nav-text">位置调整</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#坐标系"><span class="nav-number">6.23.</span> <span class="nav-text">坐标系</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ggplot2包资料扩展：包、函数"><span class="nav-number">7.</span> <span class="nav-text">ggplot2包资料扩展：包、函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SessionInfo"><span class="nav-number">8.</span> <span class="nav-text">SessionInfo</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>
<span id="busuanzi_container_site_uv">
  本站访客数<span id="busuanzi_value_site_uv"></span>人次
</span>
<div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">TaoYan</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://Logos.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'https://ytlogos.github.io/2017/09/19/ggplot2高效实用指南/';
          this.page.identifier = '2017/09/19/ggplot2高效实用指南/';
          this.page.title = 'ggplot2高效实用指南';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://Logos.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  
    
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "true",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("eCk2SIn1qQv7950CURz6Ybz3-gzGzoHsz", "mh2NS9HEcotcPN5TBwwMAKSk");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

  

  
<!-- custom analytics part create by xiamo -->
<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
<script>AV.initialize("eCk2SIn1qQv7950CURz6Ybz3-gzGzoHsz", "mh2NS9HEcotcPN5TBwwMAKSk");</script>
<script>
function showTime(Counter) {
	var query = new AV.Query(Counter);
	$(".leancloud_visitors").each(function() {
		var url = $(this).attr("id").trim();
		query.equalTo("url", url);
		query.find({
			success: function(results) {
				if (results.length == 0) {
					var content = '0 ' + $(document.getElementById(url)).text();
					$(document.getElementById(url)).text(content);
					return;
				}
				for (var i = 0; i < results.length; i++) {
					var object = results[i];
					var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
					$(document.getElementById(url)).text(content);
				}
			},
			error: function(object, error) {
				console.log("Error: " + error.code + " " + error.message);
			}
		});

	});
}

function addCount(Counter) {
	var Counter = AV.Object.extend("Counter");
	url = $(".leancloud_visitors").attr('id').trim();
	title = $(".leancloud_visitors").attr('data-flag-title').trim();
	var query = new AV.Query(Counter);
	query.equalTo("url", url);
	query.find({
		success: function(results) {
			if (results.length > 0) {
				var counter = results[0];
				counter.fetchWhenSave(true);
				counter.increment("time");
				counter.save(null, {
					success: function(counter) {
						var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
					},
					error: function(counter, error) {
						console.log('Failed to save Visitor num, with error message: ' + error.message);
					}
				});
			} else {
				var newcounter = new Counter();
				newcounter.set("title", title);
				newcounter.set("url", url);
				newcounter.set("time", 1);
				newcounter.save(null, {
					success: function(newcounter) {
					    console.log("newcounter.get('time')="+newcounter.get('time'));
						var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
					},
					error: function(newcounter, error) {
						console.log('Failed to create');
					}
				});
			}
		},
		error: function(error) {
			console.log('Error:' + error.code + " " + error.message);
		}
	});
}
$(function() {
	var Counter = AV.Object.extend("Counter");
	if ($('.leancloud_visitors').length == 1) {
		addCount(Counter);
	} else if ($('.post-title-link').length > 1) {
		showTime(Counter);
	}
}); 
</script>

</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>

<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.12.0/styles/atom-one-dark.min.css">