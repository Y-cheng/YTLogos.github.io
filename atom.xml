<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Logos</title>
  <subtitle>Stay hungry,Stay foolish</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://ytlogos.github.io/"/>
  <updated>2018-02-04T10:59:24.055Z</updated>
  <id>https://ytlogos.github.io/</id>
  
  <author>
    <name>TaoYan</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Shell编程：简介</title>
    <link href="https://ytlogos.github.io/2018/02/01/Shell%E7%BC%96%E7%A8%8B%EF%BC%9A%E7%AE%80%E4%BB%8B/"/>
    <id>https://ytlogos.github.io/2018/02/01/Shell编程：简介/</id>
    <published>2018-02-01T13:19:05.000Z</published>
    <updated>2018-02-04T10:59:24.055Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180204/GhihcB409F.png?imageslim" alt="mark"></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Shell是一个用C语言编写的程序，提供用户使用linux的桥梁。它既是一种命令语言，又是一种程序设计语言。Shell脚本(Shell script)shiyizhongweiShel编写的脚本程序。通常我们说的Shell就是指的Shell脚本，但是应该记住的是Shell与Shell脚本是两个不同的概念。linux的Shell种类众多，但是我们常用的是bash。</p>
<a id="more"></a>
<h2 id="Shell脚本"><a href="#Shell脚本" class="headerlink" title="Shell脚本"></a>Shell脚本</h2><p>由于Shell种类众多，所以我们编写Shell脚本的时候解释该脚本的Shell程序。所以第一行我们通常写成这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div></pre></td></tr></table></figure>
<p><strong>#!</strong>是一个约定的标记，用来告诉系统这个脚本用什么解释器来执行，也就是使用哪一种Shell来执行，这里我们指定由bash来执行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">!#/bin/bash</div><div class="line">echo &quot;Hello World !&quot;</div></pre></td></tr></table></figure>
<p><code>echo</code>命令用于向窗口输出文本。</p>
<h2 id="运行脚本"><a href="#运行脚本" class="headerlink" title="运行脚本"></a>运行脚本</h2><p>运行脚本有两种方法</p>
<ul>
<li>作为可执行程序</li>
</ul>
<p>将上面的代码保存为hello.sh，然后进入其所在的目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#使脚本具有执行权限</div><div class="line">chmod +x ./hello.sh</div><div class="line">#执行脚本</div><div class="line">./hello.sh</div></pre></td></tr></table></figure></p>
<blockquote>
<p>需要注意的是，一定要写成./hello.sh，而不是./hello.sh，运行其他二进制的程序也一样。如果直接写成hello.sh的话，linux系统会去PATH里寻找有没有hello.sh这个文本，但是只有/bin,/sbin,/usr/bin等在PATH里，当前目录通常不在PATH里，所以写成hello.sh是找不到命令的，要用./hello.sh告诉系统就在当前目录找。</p>
</blockquote>
<ul>
<li>作为解释器参数<br>这种运行方式是直接运行解释器，参数就是shell脚本文件名。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/bin/sh hello.sh</div></pre></td></tr></table></figure>
<p>此时就无需声明解释器了，因为已经在命令中指定了</p>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180204/GhihcB409F.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;Shell是一个用C语言编写的程序，提供用户使用linux的桥梁。它既是一种命令语言，又是一种程序设计语言。Shell脚本(Shell script)shiyizhongweiShel编写的脚本程序。通常我们说的Shell就是指的Shell脚本，但是应该记住的是Shell与Shell脚本是两个不同的概念。linux的Shell种类众多，但是我们常用的是bash。&lt;/p&gt;
    
    </summary>
    
      <category term="Shell" scheme="https://ytlogos.github.io/categories/Shell/"/>
    
    
  </entry>
  
  <entry>
    <title>关于如何修改坐标轴表达式以及分面图例的一个例子</title>
    <link href="https://ytlogos.github.io/2018/01/31/%E5%85%B3%E4%BA%8E%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E5%9D%90%E6%A0%87%E8%BD%B4%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%BB%A5%E5%8F%8A%E5%88%86%E9%9D%A2%E5%9B%BE%E4%BE%8B%E7%9A%84%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90/"/>
    <id>https://ytlogos.github.io/2018/01/31/关于如何修改坐标轴表达式以及分面图例的一个例子/</id>
    <published>2018-01-31T11:43:11.000Z</published>
    <updated>2018-02-01T03:30:29.055Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/ElKca96m2c.png?imageslim" alt="mark"></p>
<p><strong>ggplot2</strong>绘制的图形如果需要修改细节的话，没有对<strong>ggplot2</strong>有一定的了解的话是十分困难的，毕竟连创建这个包的作者<strong>Hadley Wickham</strong>都自称自己使用<strong>ggplot2</strong>的时候都需要查文档。在对<strong>ggplot2</strong>有一定了解的基础上如果需要修改ggplot图的话稍微查查文档基本能解决。</p>
<a id="more"></a>
<h2 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h2><p>这两天有人问我如何修改她的图形，她绘制的图如下：</p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/5fA4FDKGJB.png?imageslim" alt="mark"></p>
<p>她希望修改三点：</p>
<ul>
<li>各个分面的图例比如DK、NL等是否可以修改，使得大一点</li>
<li>Y轴标题中的-1如何变成上标</li>
<li>平均值虚线如何针对不同物种画相对应的虚线平均值</li>
</ul>
<p>她是使用<strong>ggpubr</strong>包绘制的，这个包就是对一些<strong>ggplot2</strong>函数的一些封装及继承，本质上来说是可以通过<strong>ggplot2</strong>来修改参数的。我参考了一部分的官方文档之后解决了这三个问题，所以写了这篇博客。</p>
<h2 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(tidyverse)</div><div class="line">library(ggpubr)</div><div class="line">ICP&lt;-read.csv(&quot;C:/Users/taoyan/Desktop/element.csv&quot;)</div><div class="line">ICP$Order &lt;- factor(ICP$Species, levels = c(&quot;DK&quot;, &quot;NL&quot;, &quot;RO&quot;, &quot;IT&quot;, &quot;TL&quot;, &quot;AP&quot;, &quot;AD&quot;))</div><div class="line">head(ICP)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   Species Treatment       Na       Ca        P</div><div class="line">## 1      DK         A 268.4234 3021.933 1791.317</div><div class="line">## 2      DK         A 301.9390 3314.308 1595.479</div><div class="line">## 3      DK         A 261.1024 3417.643 1547.596</div><div class="line">## 4      DK         A 229.1169 3069.978 1735.703</div><div class="line">## 5      DK         A 265.1454 3205.965 1667.524</div><div class="line">## 6      DK         B 330.7135 4028.279 1638.113</div></pre></td></tr></table></figure>
<h2 id="构造数据"><a href="#构造数据" class="headerlink" title="构造数据"></a>构造数据</h2><p>由于后面需要用到平均值，所以需要构造含有平均值的数据集<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">meanvalue &lt;- ICP%&gt;%group_by(Species)%&gt;%summarise(mean=mean(Na))</div><div class="line">data &lt;- left_join(ICP,meanvalue,by=c(&apos;Species&apos;=&apos;Species&apos;))</div><div class="line">head(data[,c(1:4,13)])</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   Species Treatment       Na       Ca     mean</div><div class="line">## 1      DK         A 268.4234 3021.933 426.6542</div><div class="line">## 2      DK         A 301.9390 3314.308 426.6542</div><div class="line">## 3      DK         A 261.1024 3417.643 426.6542</div><div class="line">## 4      DK         A 229.1169 3069.978 426.6542</div><div class="line">## 5      DK         A 265.1454 3205.965 426.6542</div><div class="line">## 6      DK         B 330.7135 4028.279 426.6542</div></pre></td></tr></table></figure>
<h2 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">p &lt;- ggboxplot(ICP, x=&quot;Treatment&quot;, y=&quot;Na&quot;,group=&quot;Species&quot;, color=&quot;Treatment&quot;,</div><div class="line">add=&quot;mean_se&quot;,facet.by = &quot;Order&quot;,ncol=4, legend=&quot;none&quot;)+</div><div class="line">geom_hline(aes(yintercept=mean),data,linetype=2)+ #由于要在不同的分面里绘制水平线，这里要mapping</div><div class="line">stat_compare_means(method=&quot;anova&quot;,label=&quot;p.format&quot;,label.y=3500,size=8)+</div><div class="line">stat_compare_means(label=&quot;p.signif&quot;,size=8,method=&quot;wilcox.test&quot;,ref.group=&quot;.all.&quot;,hide.ns=TRUE)</div><div class="line">ggpar(p,palette = &quot;npg&quot;,font.tickslab = c(18,&quot;bold&quot;))+</div><div class="line">  theme(strip.text = element_text(size=15,face = &quot;bold&quot;))+ #调整分面legend</div><div class="line">  labs(x=&quot;Treatment&quot;, y=expression(bold(paste(&quot;Na (  &quot;, &apos;mg Kg&apos;^&#123;-1&#125;,&quot;)&quot;,&apos; DM&apos;))))+</div><div class="line">  theme(axis.title = element_text(face = &quot;bold&quot;, size=18))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/ElKca96m2c.png?imageslim" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo()"></a>SessionInfo()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">##  [1] bindrcpp_0.2       ggpubr_0.1.6       magrittr_1.5      </div><div class="line">##  [4] forcats_0.2.0      stringr_1.2.0      dplyr_0.7.4       </div><div class="line">##  [7] purrr_0.2.4        readr_1.1.1        tidyr_0.7.2       </div><div class="line">## [10] tibble_1.4.2       ggplot2_2.2.1.9000 tidyverse_1.2.1   </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] tidyselect_0.2.3  reshape2_1.4.3    haven_1.1.1      </div><div class="line">##  [4] lattice_0.20-35   colorspace_1.3-2  htmltools_0.3.6  </div><div class="line">##  [7] yaml_2.1.16       rlang_0.1.6       pillar_1.1.0     </div><div class="line">## [10] foreign_0.8-69    glue_1.2.0        modelr_0.1.1     </div><div class="line">## [13] readxl_1.0.0      bindr_0.1         plyr_1.8.4       </div><div class="line">## [16] munsell_0.4.3     gtable_0.2.0      cellranger_1.1.0 </div><div class="line">## [19] rvest_0.3.2       ggsci_2.8         psych_1.7.8      </div><div class="line">## [22] evaluate_0.10.1   labeling_0.3      knitr_1.18       </div><div class="line">## [25] parallel_3.4.3    broom_0.4.3       Rcpp_0.12.15     </div><div class="line">## [28] scales_0.5.0.9000 backports_1.1.2   jsonlite_1.5     </div><div class="line">## [31] mnormt_1.5-5      hms_0.4.1         digest_0.6.14    </div><div class="line">## [34] stringi_1.1.6     grid_3.4.3        rprojroot_1.3-2  </div><div class="line">## [37] cli_1.0.0         tools_3.4.3       lazyeval_0.2.1   </div><div class="line">## [40] crayon_1.3.4      pkgconfig_2.0.1   xml2_1.2.0       </div><div class="line">## [43] lubridate_1.7.1   assertthat_0.2.0  rmarkdown_1.8    </div><div class="line">## [46] httr_1.3.1        rstudioapi_0.7    R6_2.2.2         </div><div class="line">## [49] nlme_3.1-131      compiler_3.4.3</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410</p>
<p>Email: tyan@zju.edu.cn</p>
<p>QQ: 1051927088</p>
<p>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a></p>
<p>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a></p>
<p>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛</p>
<p>浙江大学作物遗传育种在读研究生（生物信息学方向）</p>
<p>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/ElKca96m2c.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ggplot2&lt;/strong&gt;绘制的图形如果需要修改细节的话，没有对&lt;strong&gt;ggplot2&lt;/strong&gt;有一定的了解的话是十分困难的，毕竟连创建这个包的作者&lt;strong&gt;Hadley Wickham&lt;/strong&gt;都自称自己使用&lt;strong&gt;ggplot2&lt;/strong&gt;的时候都需要查文档。在对&lt;strong&gt;ggplot2&lt;/strong&gt;有一定了解的基础上如果需要修改ggplot图的话稍微查查文档基本能解决。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="R" scheme="https://ytlogos.github.io/tags/R/"/>
    
      <category term="visualization" scheme="https://ytlogos.github.io/tags/visualization/"/>
    
      <category term="ggplot2" scheme="https://ytlogos.github.io/tags/ggplot2/"/>
    
      <category term="ggpubr" scheme="https://ytlogos.github.io/tags/ggpubr/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 08 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/31/%20Lesson%2008%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/31/ Lesson 08 for Plotting in R for Biologists/</id>
    <published>2018-01-31T04:19:05.000Z</published>
    <updated>2018-02-03T07:57:05.975Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Jfea06AiAF.png?imageslim" alt="mark"></p>
<p>这节课是最后一节课，主要将如何绘制热图(heatmap)。实际上关于热图的绘制，我以前写了一篇博客：<a href="https://ytlogos.github.io/2017/08/21/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E7%83%AD%E5%9B%BE%E7%BB%98%E5%88%B6/">R语言学习笔记之热图绘制</a>，里面写的十分详细。但是今天热图绘制主要利用一个新的R包<strong>ComplexHeatmap</strong>进行绘制。</p>
<a id="more"></a>
<h2 id="包安装"><a href="#包安装" class="headerlink" title="包安装"></a>包安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">source(&quot;https://bioconductor.org/biocLite.R&quot;)</div><div class="line">options(BioC_mirror=&quot;http://mirrors.ustc.edu.cn/bioc/&quot;)</div><div class="line">biocLite(&quot;ComplexHeatmap&quot;)</div></pre></td></tr></table></figure>
<h2 id="数据加载"><a href="#数据加载" class="headerlink" title="数据加载"></a>数据加载</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(ComplexHeatmap)</div><div class="line">my_data &lt;- read.table(&quot;copy_number_data.txt&quot;, sep = &quot;\t&quot;, quote=&quot;&quot;, stringsAsFactors = FALSE, header = TRUE)</div><div class="line">head(my_data[,1:6])</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##    CHR     START       END X.SRR089523. X.SRR089526. X.SRR089529.</div><div class="line">## 1 chr1  53440429  53494914    1.1002112    1.1000844    1.0487301</div><div class="line">## 2 chr1 105459037 105514187    1.1860780    0.6553897    0.4980016</div><div class="line">## 3 chr1 183998520 184048557    1.3791250    1.2024487    0.5735184</div><div class="line">## 4 chr1 236135655 236186012    0.8987158    1.1182392    0.6396842</div><div class="line">## 5 chr2  38944803  38996507    1.0788216    0.9663390    1.0473623</div><div class="line">## 6 chr2  97248366  97298651    1.0459629    1.0658991    1.0473623</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#绘制热图前先进行矩阵化</div><div class="line">my_matrix &lt;- as.matrix(my_data[, c(4:100)])</div><div class="line">head(my_matrix[,1:4])</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##      X.SRR089523. X.SRR089526. X.SRR089529. X.SRR089533.</div><div class="line">## [1,]    1.1002112    1.1000844    1.0487301    0.5656784</div><div class="line">## [2,]    1.1860780    0.6553897    0.4980016    0.5656784</div><div class="line">## [3,]    1.3791250    1.2024487    0.5735184    1.0362551</div><div class="line">## [4,]    0.8987158    1.1182392    0.6396842    0.4659238</div><div class="line">## [5,]    1.0788216    0.9663390    1.0473623    1.1702930</div><div class="line">## [6,]    1.0459629    1.0658991    1.0473623    1.2298119</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#将染色体信息存储好以便后续热图注释</div><div class="line">chromosome_info &lt;- data.frame(chrom=my_data$CHR)</div></pre></td></tr></table></figure>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Heatmap(my_matrix)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Aj4Gc126K4.png?imageslim" alt="mark"></p>
<p>可以看到使用默认参数热图时十分不美观，可以进行部分调整<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#坐标旋转</div><div class="line">my_matrix &lt;- t(my_matrix)</div><div class="line">Heatmap(my_matrix)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/f2bambd0De.png?imageslim" alt="mark"></p>
<p>坐标标签还是十分乱，还得进行调整<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Heatmap(my_matrix, cluster_columns = FALSE)#列不聚类</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/j5Aabgh1hH.png?imageslim" alt="mark"></p>
<p>将坐标标签位置置于左边<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Heatmap(my_matrix, </div><div class="line">        cluster_columns = FALSE, </div><div class="line">        row_names_side = &quot;left&quot;, </div><div class="line">        row_hclust_side = &quot;left&quot;, </div><div class="line">        row_names_gp = gpar(cex=0.6)</div><div class="line">        )</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/FAIF0CElla.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Heatmap(my_matrix,</div><div class="line">        cluster_columns = FALSE,</div><div class="line">        row_names_side = &quot;left&quot;,</div><div class="line">        row_hclust_side = &quot;left&quot;,</div><div class="line">        row_names_gp = gpar(cex=0.6),</div><div class="line">        row_hclust_width = unit(3, &quot;cm&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/c34HgC083C.png?imageslim" alt="mark"></p>
<p>热图绘制的时候可以使用不同的距离计算方式以及聚类方法，具体的用法可以参考我以前的博客：<a href="https://ytlogos.github.io/2017/08/21/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E7%83%AD%E5%9B%BE%E7%BB%98%E5%88%B6/">R语言学习笔记之热图绘制</a>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Heatmap(my_matrix,</div><div class="line">        cluster_columns = FALSE,</div><div class="line">        row_names_side = &quot;left&quot;,</div><div class="line">        row_hclust_side = &quot;left&quot;,</div><div class="line">        row_names_gp = gpar(cex=0.6),</div><div class="line">        row_hclust_width = unit(3, &quot;cm&quot;),</div><div class="line">        clustering_distance_rows = &quot;maximum&quot;,</div><div class="line">        clustering_method_rows = &quot;ward.D&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/iEiafB44Ad.png?imageslim" alt="mark"></p>
<h2 id="热图注释"><a href="#热图注释" class="headerlink" title="热图注释"></a>热图注释</h2><p>主要是对聚成的类进行颜色标记<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">library(dendextend)</div><div class="line">dend &lt;- hclust(dist(my_matrix, method = &quot;maximum&quot;), method = &quot;ward.D&quot;)</div><div class="line">Heatmap(my_matrix,</div><div class="line">        cluster_columns = FALSE,</div><div class="line">        row_names_side = &quot;left&quot;,</div><div class="line">        row_hclust_side = &quot;left&quot;,</div><div class="line">        row_names_gp = gpar(cex=0.6),</div><div class="line">        row_hclust_width = unit(3, &quot;cm&quot;),</div><div class="line">        cluster_rows = color_branches(dend, k=3))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/k0d1H4Fahj.png?imageslim" alt="mark"></p>
<h3 id="将热图分类"><a href="#将热图分类" class="headerlink" title="将热图分类"></a>将热图分类</h3><p>随便你先分成几类，但是一般来说有一个最佳分类数，可参考我的另一篇博客：<a href="https://ytlogos.github.io/2017/06/25/R语言学习笔记之聚类分析/">R语言学习笔记之聚类分析</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Heatmap(my_matrix,</div><div class="line">        cluster_columns = FALSE,</div><div class="line">        row_names_side = &quot;left&quot;,</div><div class="line">        row_hclust_side = &quot;left&quot;,</div><div class="line">        row_names_gp = gpar(cex=0.6),</div><div class="line">        row_hclust_width = unit(3, &quot;cm&quot;),</div><div class="line">        clustering_distance_rows = &quot;maximum&quot;,</div><div class="line">        clustering_method_rows = &quot;ward.D&quot;,</div><div class="line">        km=2)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/d4hLf0EfgF.png?imageslim" alt="mark"></p>
<h3 id="根据染色体信息进行注释"><a href="#根据染色体信息进行注释" class="headerlink" title="根据染色体信息进行注释"></a>根据染色体信息进行注释</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">chromosome_colors &lt;- c(rep(c(&quot;black&quot;,&quot;white&quot;),11), &quot;red&quot;)</div><div class="line">names(chromosome_colors) &lt;- paste(&quot;chr&quot;,c(seq(1:22), &quot;X&quot;), sep = &quot;&quot;)</div><div class="line">Heatmap(my_matrix,</div><div class="line">        cluster_columns = FALSE,</div><div class="line">        row_names_side = &quot;left&quot;,</div><div class="line">        row_hclust_side = &quot;left&quot;,</div><div class="line">        row_names_gp = gpar(cex=0.6),</div><div class="line">        row_hclust_width = unit(3, &quot;cm&quot;),</div><div class="line">        clustering_distance_rows = &quot;maximum&quot;,</div><div class="line">        clustering_method_rows = &quot;ward.D&quot;,</div><div class="line">        km=2,</div><div class="line">        bottom_annotation = HeatmapAnnotation(chromosome_info, col = list(chrom=chromosome_colors), show_legend = FALSE))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Jfea06AiAF.png?imageslim" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] grid      stats     graphics  grDevices utils     datasets  methods  </div><div class="line">## [8] base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">## [1] dendextend_1.6.0      ComplexHeatmap_1.17.1</div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.15         DEoptimR_1.0-8       compiler_3.4.3      </div><div class="line">##  [4] pillar_1.1.0         RColorBrewer_1.1-2   plyr_1.8.4          </div><div class="line">##  [7] viridis_0.4.1        class_7.3-14         prabclus_2.2-6      </div><div class="line">## [10] tools_3.4.3          digest_0.6.15        mclust_5.4          </div><div class="line">## [13] viridisLite_0.3.0    evaluate_0.10.1      tibble_1.4.2        </div><div class="line">## [16] gtable_0.2.0         lattice_0.20-35      rlang_0.1.6         </div><div class="line">## [19] yaml_2.1.16          mvtnorm_1.0-7        gridExtra_2.3       </div><div class="line">## [22] trimcluster_0.1-2    stringr_1.2.0        knitr_1.19          </div><div class="line">## [25] cluster_2.0.6        GlobalOptions_0.0.12 fpc_2.1-11          </div><div class="line">## [28] diptest_0.75-7       nnet_7.3-12          stats4_3.4.3        </div><div class="line">## [31] rprojroot_1.3-2      robustbase_0.92-8    GetoptLong_0.1.6    </div><div class="line">## [34] flexmix_2.3-14       rmarkdown_1.8        kernlab_0.9-25      </div><div class="line">## [37] ggplot2_2.2.1.9000   magrittr_1.5         whisker_0.3-2       </div><div class="line">## [40] modeltools_0.2-21    backports_1.1.2      scales_0.5.0.9000   </div><div class="line">## [43] htmltools_0.3.6      MASS_7.3-48          shape_1.4.3         </div><div class="line">## [46] circlize_0.4.3       colorspace_1.3-2     stringi_1.1.6       </div><div class="line">## [49] lazyeval_0.2.1       munsell_0.4.3        rjson_0.2.15</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Jfea06AiAF.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;这节课是最后一节课，主要将如何绘制热图(heatmap)。实际上关于热图的绘制，我以前写了一篇博客：&lt;a href=&quot;https://ytlogos.github.io/2017/08/21/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E7%83%AD%E5%9B%BE%E7%BB%98%E5%88%B6/&quot;&gt;R语言学习笔记之热图绘制&lt;/a&gt;，里面写的十分详细。但是今天热图绘制主要利用一个新的R包&lt;strong&gt;ComplexHeatmap&lt;/strong&gt;进行绘制。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
      <category term="heatmap" scheme="https://ytlogos.github.io/tags/heatmap/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 07 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/30/%20Lesson%2007%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/30/ Lesson 07 for Plotting in R for Biologists/</id>
    <published>2018-01-30T04:19:05.000Z</published>
    <updated>2018-02-03T06:12:06.932Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/BcHLAECm5L.png?imageslim" alt="mark"></p>
<p>这节课主要两个知识点，一个是图形分面，一个是图形嵌入。</p>
<a id="more"></a>
<h2 id="数据加载及清洗"><a href="#数据加载及清洗" class="headerlink" title="数据加载及清洗"></a>数据加载及清洗</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(tidyverse)</div><div class="line">theme_set(theme_gray())</div><div class="line">my_data &lt;- read.csv(&quot;variants_from_assembly.bed&quot;, sep = &quot;\t&quot;, quote = &apos;&apos;, stringsAsFactors = TRUE, header = FALSE)</div><div class="line">names(my_data) &lt;- c(&quot;chrom&quot;,&quot;start&quot;,&quot;stop&quot;,&quot;name&quot;,&quot;size&quot;,&quot;strand&quot;,&quot;type&quot;,&quot;ref.dist&quot;,&quot;query.dist&quot;)</div><div class="line">head(my_data)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   chrom     start      stop name size strand      type ref.dist query.dist</div><div class="line">## 1     6 103832058 103832059  SV1  185      + Insertion        0        185</div><div class="line">## 2     6 102958468 102958469  SV2  317      + Insertion      -14        303</div><div class="line">## 3     6 102741692 102741693  SV3  130      +  Deletion      130          0</div><div class="line">## 4     6 102283759 102283760  SV4 1271      + Insertion      -12       1259</div><div class="line">## 5     6 101194032 101194033  SV5 2864      + Insertion      -13       2851</div><div class="line">## 6     6 101056644 101056645  SV6  265      + Insertion        0        265</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">my_data &lt;- my_data[my_data$chrom %in% c(seq(1:22), &quot;X&quot;,&quot;Y&quot;), ]</div><div class="line">my_data$chrom &lt;- factor(gsub(&quot;chr&quot;, &quot;&quot;,my_data$chrom), levels = c(seq(1:22),&quot;X&quot;,&quot;Y&quot;))</div><div class="line">my_data$type &lt;- factor(my_data$type, levels = c(&quot;Insertion&quot;,&quot;Deletion&quot;,&quot;Expansion&quot;,&quot;Contraction&quot;))</div></pre></td></tr></table></figure>
<h2 id="可视化-amp-分面"><a href="#可视化-amp-分面" class="headerlink" title="可视化&amp;分面"></a>可视化&amp;分面</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density(alpha=0.5)+xlim(0,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Ella96CC28.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density(alpha=0.5)+xlim(0,500)+facet_grid(type~.)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/G1jDEc7HFj.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density(alpha=0.5)+xlim(0,500)+facet_grid(.~type)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/e9jJEl1EHl.png?imageslim" alt="mark"></p>
<p>分面的规则语法是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plot+facet_grid(rows~columns)</div></pre></td></tr></table></figure></p>
<p>比如下面的图按染色体为行、type为列进行分面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density()+xlim(0,500)+facet_grid(chrom~type)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/BG7kecbglg.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#也可以反过来</div><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density()+xlim(0,500)+facet_grid(type~chrom)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/lIL4kkDecH.png?imageslim" alt="mark"></p>
<blockquote>
<p>可以根据自己的喜好以及数据的分布进行分面，有的时候数据不是很适合分面操作，需要慎重，不然越分越乱，无法直观地展示数据。</p>
</blockquote>
<h2 id="图形嵌入"><a href="#图形嵌入" class="headerlink" title="图形嵌入"></a>图形嵌入</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#先设置主题</div><div class="line">theme_set(theme_gray()+</div><div class="line">            theme(</div><div class="line">              axis.line = element_line(size=0.5),</div><div class="line">              panel.background = element_rect(fill=NA, size = rel(20)),</div><div class="line">              panel.grid.minor = element_line(colour = NA),</div><div class="line">              axis.text = element_text(size = 16),</div><div class="line">              axis.title = element_text(size = 16)</div><div class="line">            )</div><div class="line">          )</div><div class="line">big_plot &lt;- ggplot(my_data, aes(x=size, fill=type))+</div><div class="line">  geom_bar(binwidth = 100)+</div><div class="line">  guides(fill=FALSE)+</div><div class="line">  scale_y_continuous(expand = c(0,0))</div><div class="line">big_plot</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Jj3lGDhBE1.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">small_plot &lt;- ggplot(my_data, aes(x=size, fill=type))+</div><div class="line">  geom_bar(binwidth = 5)+</div><div class="line">  xlim(0, 500)+</div><div class="line">  theme(axis.title = element_blank())+</div><div class="line">  scale_y_continuous(expand = c(0,0))</div><div class="line">small_plot</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Af79gm2c4B.png?imageslim" alt="mark"></p>
<p>图形嵌入需要使用包<strong>grid</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">library(grid)</div><div class="line">#构造画布，这一步需要不断调整位置</div><div class="line">vp &lt;- viewport(width = 0.8, height = 0.7, x=0.65, y=0.65)#分别设置需要嵌入的图形的宽度、高度以及坐标位置</div><div class="line">png(&quot;insert_plot.png&quot;)</div><div class="line">print(big_plot)</div><div class="line">print(small_plot, vp = vp)</div><div class="line">dev.off()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/BcHLAECm5L.png?imageslim" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] grid      stats     graphics  grDevices utils     datasets  methods  </div><div class="line">## [8] base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">## [1] forcats_0.2.0      stringr_1.2.0      dplyr_0.7.4       </div><div class="line">## [4] purrr_0.2.4        readr_1.1.1        tidyr_0.7.2       </div><div class="line">## [7] tibble_1.4.2       ggplot2_2.2.1.9000 tidyverse_1.2.1   </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.15      cellranger_1.1.0  pillar_1.1.0     </div><div class="line">##  [4] compiler_3.4.3    plyr_1.8.4        bindr_0.1        </div><div class="line">##  [7] tools_3.4.3       digest_0.6.15     lubridate_1.7.1  </div><div class="line">## [10] jsonlite_1.5      evaluate_0.10.1   nlme_3.1-131     </div><div class="line">## [13] gtable_0.2.0      lattice_0.20-35   pkgconfig_2.0.1  </div><div class="line">## [16] rlang_0.1.6       psych_1.7.8       cli_1.0.0        </div><div class="line">## [19] rstudioapi_0.7    yaml_2.1.16       parallel_3.4.3   </div><div class="line">## [22] haven_1.1.1       bindrcpp_0.2      xml2_1.2.0       </div><div class="line">## [25] httr_1.3.1        knitr_1.19        hms_0.4.1        </div><div class="line">## [28] rprojroot_1.3-2   glue_1.2.0        R6_2.2.2         </div><div class="line">## [31] readxl_1.0.0      foreign_0.8-69    rmarkdown_1.8    </div><div class="line">## [34] modelr_0.1.1      reshape2_1.4.3    magrittr_1.5     </div><div class="line">## [37] backports_1.1.2   scales_0.5.0.9000 htmltools_0.3.6  </div><div class="line">## [40] rvest_0.3.2       assertthat_0.2.0  mnormt_1.5-5     </div><div class="line">## [43] colorspace_1.3-2  labeling_0.3      stringi_1.1.6    </div><div class="line">## [46] lazyeval_0.2.1    munsell_0.4.3     broom_0.4.3      </div><div class="line">## [49] crayon_1.3.4</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/BcHLAECm5L.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;这节课主要两个知识点，一个是图形分面，一个是图形嵌入。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 06 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/29/%20Lesson%2006%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/29/ Lesson 06 for Plotting in R for Biologists/</id>
    <published>2018-01-29T04:19:05.000Z</published>
    <updated>2018-02-02T14:00:31.911Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/AFLB2JBHc7.png?imageslim" alt="veendiagram"></p>
<p>前面几节课绘制的图形只有条形图，但是我们科研过程中需要绘制各种各样的图形来展现我们的数据，这节课就主要讲一下利用<strong>ggplot2</strong>绘制各种图形，这也是<strong>ggplot2</strong>的魔力所在。相同的数据可以通过不同类型的图形来可视化。本节课主要将绘制以下几类图形：</p>
<ul>
<li>条形图</li>
<li>直方图</li>
<li>散点图</li>
<li>箱线图</li>
<li>小提琴图</li>
<li>密度图</li>
<li>点状图</li>
<li>线图</li>
<li>饼图</li>
<li>韦恩图</li>
</ul>
<a id="more"></a>
<h2 id="数据加载清洗"><a href="#数据加载清洗" class="headerlink" title="数据加载清洗"></a>数据加载清洗</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(tidyverse)</div><div class="line">theme_set(theme_gray(base_size = 18))</div><div class="line">my_data &lt;- read.csv(&quot;variants_from_assembly.bed&quot;, sep = &quot;\t&quot;, quote = &apos;&apos;, stringsAsFactors = FALSE)</div><div class="line">names(my_data) &lt;- c(&quot;chrom&quot;,&quot;start&quot;,&quot;stop&quot;,&quot;name&quot;,&quot;size&quot;,&quot;strand&quot;,&quot;type&quot;,&quot;ref.dist&quot;,&quot;query.dist&quot;)</div><div class="line">head(my_data)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   chrom     start      stop name size strand      type ref.dist query.dist</div><div class="line">## 1     6 102958468 102958469  SV2  317      + Insertion      -14        303</div><div class="line">## 2     6 102741692 102741693  SV3  130      +  Deletion      130          0</div><div class="line">## 3     6 102283759 102283760  SV4 1271      + Insertion      -12       1259</div><div class="line">## 4     6 101194032 101194033  SV5 2864      + Insertion      -13       2851</div><div class="line">## 5     6 101056644 101056645  SV6  265      + Insertion        0        265</div><div class="line">## 6     6 100407499 100407500  SV7  334      + Insertion        0        334</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">summary(my_data$chrom)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">##    Length     Class      Mode </div><div class="line">##      9555 character character</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#数据过滤</div><div class="line">my_data &lt;- my_data[my_data$chrom %in% c(seq(1:22), &quot;X&quot;, &quot;Y&quot;,&quot;MT&quot;), ]</div><div class="line">#染色体排序</div><div class="line">my_data$chrom &lt;- factor(my_data$chrom, levels = c(seq(1:22), &quot;X&quot;, &quot;Y&quot;,&quot;MT&quot;))</div><div class="line">#类型(type)排序</div><div class="line">my_data$type &lt;- factor(my_data$type, levels = c(&quot;Insertion&quot;,&quot;Deletion&quot;,&quot;Expansion&quot;,&quot;Contraction&quot;))</div><div class="line">head(my_data)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   chrom     start      stop name size strand      type ref.dist query.dist</div><div class="line">## 1     6 102958468 102958469  SV2  317      + Insertion      -14        303</div><div class="line">## 2     6 102741692 102741693  SV3  130      +  Deletion      130          0</div><div class="line">## 3     6 102283759 102283760  SV4 1271      + Insertion      -12       1259</div><div class="line">## 4     6 101194032 101194033  SV5 2864      + Insertion      -13       2851</div><div class="line">## 5     6 101056644 101056645  SV6  265      + Insertion        0        265</div><div class="line">## 6     6 100407499 100407500  SV7  334      + Insertion        0        334</div></pre></td></tr></table></figure>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><h3 id="条形图"><a href="#条形图" class="headerlink" title="条形图"></a>条形图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/Ij6mC3GFm8.png?imageslim" alt="mark"></p>
<h3 id="直方图"><a href="#直方图" class="headerlink" title="直方图"></a>直方图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_histogram()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/4ILKighKlg.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_histogram()+xlim(0,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/fI2i1chIJ9.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_histogram(binwidth = 5)+xlim(0,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/IKebffc1EI.png?imageslim" alt="mark"></p>
<h3 id="散点图"><a href="#散点图" class="headerlink" title="散点图"></a>散点图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#将type映射给颜色</div><div class="line">ggplot(my_data, aes(x=ref.dist, y=query.dist, color=type))+geom_point()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/f4fEKhAd35.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=ref.dist, y=query.dist, color=type))+geom_point()+xlim(-500,500)+ylim(-500,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/EGkhk29KlI.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#将数值型变量size映射给颜色</div><div class="line">ggplot(my_data, aes(x=ref.dist, y=query.dist, color=size))+geom_point()+xlim(-500,500)+ylim(-500,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/je4lgmC970.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=ref.dist, y=query.dist,color=size))+geom_point()+xlim(-500,500)+ylim(-500,500)+scale_color_gradient(limits=c(0, 500))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/fDg6K877F7.png?imageslim" alt="mark"></p>
<h3 id="箱线图"><a href="#箱线图" class="headerlink" title="箱线图"></a>箱线图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(type, y=size))+geom_boxplot()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/dI07A0I0Ah.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=type, y=size, fill=type))+geom_boxplot()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/76bb7i9f2F.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=type, y=size, fill=type))+geom_boxplot()+coord_flip()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/E8klE3m6EA.png?imageslim" alt="mark"></p>
<h3 id="小提琴图"><a href="#小提琴图" class="headerlink" title="小提琴图"></a>小提琴图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=type, y=size, fill=type))+geom_violin()+ylim(0,1000)+guides(fill=FALSE)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/AFkf5JgLAL.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=type, y=size, fill=type))+geom_violin(adjust=0.2)+ylim(0,1000)+guides(fill=FALSE)#adjust调整分辨率，默认为1，值越低，分辨率越高</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/51IFgFDCDc.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#坐标变换</div><div class="line">ggplot(my_data, aes(x=type, y=size, fill=type))+geom_violin()+scale_y_log10()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/JGjBHIKc80.png?imageslim" alt="mark"></p>
<h3 id="密度图"><a href="#密度图" class="headerlink" title="密度图"></a>密度图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density()+xlim(0,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/HjB54KeclD.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density(position = &quot;stack&quot;)+xlim(0,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/GDI76ijEJ8.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density(alpha=0.5)+xlim(0,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/BlLGm4G75l.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#图形分面</div><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density()+xlim(0,500)+facet_grid(type~.)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/353a4gh1bK.png?imageslim" alt="mark"></p>
<h3 id="点状图"><a href="#点状图" class="headerlink" title="点状图"></a>点状图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_dotplot()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/9AElbGEB3G.png?imageslim" alt="mark"></p>
<h3 id="线图"><a href="#线图" class="headerlink" title="线图"></a>线图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">time_cource &lt;- read.csv(&quot;time_course_data.txt&quot;, sep = &quot;,&quot;, quote = &apos;&apos;, stringsAsFactors = TRUE, header = TRUE)</div><div class="line">head(time_cource)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   seconds value sample</div><div class="line">## 1       0  0.00      A</div><div class="line">## 2       1  5.97      A</div><div class="line">## 3       2 13.42      A</div><div class="line">## 4       3 56.08      A</div><div class="line">## 5       4 98.04      A</div><div class="line">## 6       5 27.11      A</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(time_cource, aes(x=seconds, y=value, color=sample))+geom_line()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/kiA5jFAdCK.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(time_cource, aes(x=seconds, y=value, color=sample))+geom_line(size=3)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/bcGfGALGHl.png?imageslim" alt="mark"></p>
<h3 id="饼图"><a href="#饼图" class="headerlink" title="饼图"></a>饼图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">type_counts &lt;- summary(my_data$type)</div><div class="line">type_counts</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">##   Insertion    Deletion   Expansion Contraction </div><div class="line">##        3141        2256        2476        1674</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(RColorBrewer)</div><div class="line">pie(type_counts, col = brewer.pal(length(type_counts), &quot;Set1&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/90jhF097Fl.png?imageslim" alt="mark"></p>
<h3 id="韦恩图"><a href="#韦恩图" class="headerlink" title="韦恩图"></a>韦恩图</h3><p>这里利用四个基因集<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">listA &lt;- read.csv(&quot;genes_list_A.txt&quot;, header = FALSE)</div><div class="line">A &lt;- listA$V1</div><div class="line">listB &lt;- read.csv(&quot;genes_list_B.txt&quot;, header = FALSE)</div><div class="line">B &lt;- listB$V1</div><div class="line">listC &lt;- read.csv(&quot;genes_list_C.txt&quot;, header = FALSE)</div><div class="line">C &lt;- listC$V1</div><div class="line">listD &lt;- read.csv(&quot;genes_list_D.txt&quot;, header = FALSE)</div><div class="line">D &lt;- listD$V1</div><div class="line">library(VennDiagram)</div><div class="line">#注意这个包绘制的图只能直接保存在文件中，无法实时显示</div><div class="line">venn.diagram(list(A=A, B=B, C=C, D=D), fill=c(&quot;yellow&quot;,&quot;red&quot;,&quot;cyan&quot;,&quot;forestgreen&quot;), cex=1.5, filename = &quot;Venn_diagram_genes_4.png&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/AFLB2JBHc7.png?imageslim" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] grid      stats     graphics  grDevices utils     datasets  methods  </div><div class="line">## [8] base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">##  [1] VennDiagram_1.6.18  futile.logger_1.4.3 RColorBrewer_1.1-2 </div><div class="line">##  [4] forcats_0.2.0       stringr_1.2.0       dplyr_0.7.4        </div><div class="line">##  [7] purrr_0.2.4         readr_1.1.1         tidyr_0.7.2        </div><div class="line">## [10] tibble_1.4.2        ggplot2_2.2.1.9000  tidyverse_1.2.1    </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] reshape2_1.4.3       haven_1.1.1          lattice_0.20-35     </div><div class="line">##  [4] colorspace_1.3-2     htmltools_0.3.6      yaml_2.1.16         </div><div class="line">##  [7] rlang_0.1.6          pillar_1.1.0         foreign_0.8-69      </div><div class="line">## [10] glue_1.2.0           lambda.r_1.2         modelr_0.1.1        </div><div class="line">## [13] readxl_1.0.0         bindrcpp_0.2         bindr_0.1           </div><div class="line">## [16] plyr_1.8.4           munsell_0.4.3        gtable_0.2.0        </div><div class="line">## [19] cellranger_1.1.0     rvest_0.3.2          psych_1.7.8         </div><div class="line">## [22] evaluate_0.10.1      labeling_0.3         knitr_1.18          </div><div class="line">## [25] parallel_3.4.3       broom_0.4.3          Rcpp_0.12.15        </div><div class="line">## [28] scales_0.5.0.9000    backports_1.1.2      jsonlite_1.5        </div><div class="line">## [31] mnormt_1.5-5         hms_0.4.1            digest_0.6.14       </div><div class="line">## [34] stringi_1.1.6        rprojroot_1.3-2      cli_1.0.0           </div><div class="line">## [37] tools_3.4.3          magrittr_1.5         lazyeval_0.2.1      </div><div class="line">## [40] futile.options_1.0.0 crayon_1.3.4         pkgconfig_2.0.1     </div><div class="line">## [43] xml2_1.2.0           lubridate_1.7.1      assertthat_0.2.0    </div><div class="line">## [46] rmarkdown_1.8        httr_1.3.1           rstudioapi_0.7      </div><div class="line">## [49] R6_2.2.2             nlme_3.1-131         compiler_3.4.3</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/AFLB2JBHc7.png?imageslim&quot; alt=&quot;veendiagram&quot;&gt;&lt;/p&gt;
&lt;p&gt;前面几节课绘制的图形只有条形图，但是我们科研过程中需要绘制各种各样的图形来展现我们的数据，这节课就主要讲一下利用&lt;strong&gt;ggplot2&lt;/strong&gt;绘制各种图形，这也是&lt;strong&gt;ggplot2&lt;/strong&gt;的魔力所在。相同的数据可以通过不同类型的图形来可视化。本节课主要将绘制以下几类图形：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;条形图&lt;/li&gt;
&lt;li&gt;直方图&lt;/li&gt;
&lt;li&gt;散点图&lt;/li&gt;
&lt;li&gt;箱线图&lt;/li&gt;
&lt;li&gt;小提琴图&lt;/li&gt;
&lt;li&gt;密度图&lt;/li&gt;
&lt;li&gt;点状图&lt;/li&gt;
&lt;li&gt;线图&lt;/li&gt;
&lt;li&gt;饼图&lt;/li&gt;
&lt;li&gt;韦恩图&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 05 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/28/%20Lesson%2005%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/28/ Lesson 05 for Plotting in R for Biologists/</id>
    <published>2018-01-28T04:19:05.000Z</published>
    <updated>2018-02-02T10:45:23.792Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/g2ed2h7ckd.png?imageslim" alt="mark"></p>
<p>这节课作者命名为”Tweaking everything in a plot”。主要是对图形细节进行优化，包括：</p>
<ul>
<li>题目(title)、坐标轴标签、图例标签等</li>
<li>字体</li>
<li>颜色</li>
<li>背景</li>
<li>网格线等</li>
</ul>
<a id="more"></a>
<h2 id="数据加载及清洗"><a href="#数据加载及清洗" class="headerlink" title="数据加载及清洗"></a>数据加载及清洗</h2><p>这部分在上节课已经讲过了，这里就不再详述了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">library(tidyverse)</div><div class="line">library(plyr)</div><div class="line">my_data &lt;- read.csv(&quot;Encode_HMM_data.txt&quot;, sep = &quot;\t&quot;, header = FALSE)</div><div class="line">names(my_data)[1:4] &lt;- c(&quot;chrom&quot;,&quot;start&quot;,&quot;stop&quot;,&quot;type&quot;)</div><div class="line">my_data$chrom &lt;- factor(gsub(&quot;chr&quot;,&quot;&quot;, my_data$chrom, fixed = TRUE), levels = c(seq(1:22),&quot;X&quot;,&quot;Y&quot;))</div><div class="line">my_data &lt;- my_data[my_data$type %in% c(&quot;1_Active_Promoter&quot;,&quot;4_Strong_Enhancer&quot;,&quot;8_Insulator&quot;), ]</div><div class="line">my_data$type &lt;- revalue(my_data$type, c(&quot;1_Active_Promoter&quot;=&quot;Promoter&quot;, &quot;4_Strong_Enhancer&quot;=&quot;Enhancer&quot;,&quot;8_Insulator&quot;=&quot;Insulator&quot;))</div></pre></td></tr></table></figure>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><p>接下来就针对图形进行优化调整</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/L5cljj8kja.png?imageslim" alt="mark"></p>
<h3 id="添加标题"><a href="#添加标题" class="headerlink" title="添加标题"></a>添加标题</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()+labs(title=&quot;Regulatory features by chromosomes&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/gdJ67ALBG6.png?imageslim" alt="mark"></p>
<blockquote>
<p>需要注意的一点是，添加的title默认是位于左上角，如果要居中显示的话最简单的办法就是在标题前添加空格。</p>
</blockquote>
<h3 id="修改坐标轴以及图例标签"><a href="#修改坐标轴以及图例标签" class="headerlink" title="修改坐标轴以及图例标签"></a>修改坐标轴以及图例标签</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+</div><div class="line">  geom_bar()+</div><div class="line">  labs(x=&quot;Chromosome&quot;, y=&quot;Count&quot;, fill=&quot;Feature&quot;)#这里fill是对应ampping里面的fill映射，显示于图例</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/A7i5la4BCJ.png?imageslim" alt="mark"></p>
<h3 id="主题修改"><a href="#主题修改" class="headerlink" title="主题修改"></a>主题修改</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">basic &lt;- ggplot(my_data, aes(x=chrom, fill=type))+</div><div class="line">  geom_bar()+</div><div class="line">  labs(x=&quot;Chromosome&quot;, y=&quot;Count&quot;, fill=&quot;Feature&quot;)</div><div class="line">#设置文本大小</div><div class="line">(basic+theme_gray(base_size = 20))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/9D6dAECeh3.png?imageslim" alt="mark"></p>
<blockquote>
<p>如果想要使得主题适用于所有的图形，可以通过theme_set()进行设置。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">theme_set(theme_gray(base_size = 20))</div><div class="line">basic</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/gbGkg7GcmF.png?imageslim" alt="mark"></p>
<p>恢复默认设置主题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">theme_set(theme_gray())</div><div class="line">basic</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/LaC06a2e4E.png?imageslim" alt="mark"></p>
<h2 id="颜色"><a href="#颜色" class="headerlink" title="颜色"></a>颜色</h2><p>R有个包<strong>RColorNBrewer</strong>提供调色板<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(RColorBrewer)</div><div class="line">display.brewer.all()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/lEAGAHh6gI.png?imageslim" alt="mark"></p>
<p>下面测试一下这些调色板<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+scale_fill_brewer(palette = &quot;Set1&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/B5cHCji0cJ.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+scale_fill_brewer(palette = &quot;Pastel1&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/l9FJI7DLHi.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+scale_fill_brewer(palette = &quot;YlorRd&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/khfcGCelbA.png?imageslim" alt="mark"></p>
<p>不使用调色板的话也可以自己设置颜色，结合取色器的话很是很赞的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+scale_fill_manual(values = c(&quot;green&quot;, &quot;blue&quot;, &quot;red&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/e0J65fm8IL.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(colors())</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">## [1] &quot;white&quot;         &quot;aliceblue&quot;     &quot;antiquewhite&quot;  &quot;antiquewhite1&quot;</div><div class="line">## [5] &quot;antiquewhite2&quot; &quot;antiquewhite3&quot;</div></pre></td></tr></table></figure>
<p>有的时候我们需要很多种颜色，多到一个调色板都满足不了时怎么办？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chrom_plot &lt;- ggplot(my_data, aes(x=type, fill=chrom))+geom_bar()</div><div class="line">chrom_plot</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/4bhEI643Lb.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrom_plot+scale_fill_brewer(type = &quot;qual&quot;, palette = 1)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/mFkFIEJKk7.png?imageslim" alt="mark"></p>
<p><strong>ggplot</strong>默认调用的是rainbpw调色板，颜色容易让人误解，不好分辨，但是其他的调色板颜色数量是不足的。这时可以通过将好几个palette合并在一起组成一个新的palette。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">palette1 &lt;- brewer.pal(9, &quot;Set1&quot;)</div><div class="line">palette1</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">## [1] &quot;#E41A1C&quot; &quot;#377EB8&quot; &quot;#4DAF4A&quot; &quot;#984EA3&quot; &quot;#FF7F00&quot; &quot;#FFFF33&quot; &quot;#A65628&quot;</div><div class="line">## [8] &quot;#F781BF&quot; &quot;#999999&quot;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">palette2 &lt;- brewer.pal(8, &quot;Set2&quot;)</div><div class="line">palette2</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">## [1] &quot;#66C2A5&quot; &quot;#FC8D62&quot; &quot;#8DA0CB&quot; &quot;#E78AC3&quot; &quot;#A6D854&quot; &quot;#FFD92F&quot; &quot;#E5C494&quot;</div><div class="line">## [8] &quot;#B3B3B3&quot;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">palette3 &lt;- brewer.pal(9, &quot;Set3&quot;)</div><div class="line">palette3</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">## [1] &quot;#8DD3C7&quot; &quot;#FFFFB3&quot; &quot;#BEBADA&quot; &quot;#FB8072&quot; &quot;#80B1D3&quot; &quot;#FDB462&quot; &quot;#B3DE69&quot;</div><div class="line">## [8] &quot;#FCCDE5&quot; &quot;#D9D9D9&quot;</div></pre></td></tr></table></figure>
<p>通过饼图来查看一下这几个调色板<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pie(rep(1, length(palette1)), col = palette1)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/12IiLb3k9C.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pie(rep(1, length(palette2)), col = palette2)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/lEmK5k4hBc.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pie(rep(1, length(palette3)), col = palette3)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/64ckLkAA69.png?imageslim" alt="mark"></p>
<p>将这几个色斑合并成一个大的调色板<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">big_palette &lt;- c(palette1, palette2, palette3)</div><div class="line">pie(rep(1, length(big_palette)), col = big_palette)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/Deg5894HDl.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrom_plot+scale_fill_manual(values = big_palette)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/kAAB7AKgfl.png?imageslim" alt="mark"></p>
<p>也可以打乱颜色顺序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrom_plot+scale_fill_manual(values = sample(big_palette))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/lc0I79KfL3.png?imageslim" alt="mark"></p>
<h2 id="字体"><a href="#字体" class="headerlink" title="字体"></a>字体</h2><p>后续大部分调整都是通过theme来实现的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#对所有字体进行调整</div><div class="line">basic+theme_gray(base_size = 24, base_family = &quot;Times New Roman&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/e4F5cgcLj7.png?imageslim" alt="mark"></p>
<p>但是很多时候我们都是对特定字体、标签、颜色等进行特定的调整，这时就可以通过theme逐一调整。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(axis.text = element_text(size=20))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/3kGEkff3f3.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(axis.title = element_text(size = 20))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/ai6HcGJAJc.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.title = element_text(size = 20))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/756Fj36m0m.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.text = element_text(size=20, family = &quot;Times New Roman&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/K43IGFii0k.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.text = element_text(size=20, family = &quot;Times New Roman&quot;),</div><div class="line">            axis.title = element_text(size=30),</div><div class="line">            axis.text = element_text(size=20))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/fej6fe0E22.png?imageslim" alt="mark"></p>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(panel.background = element_rect(fill=&quot;pink&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/blhiiLg5lB.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(panel.background = element_rect(fill=&quot;white&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/06BCjfh0dF.png?imageslim" alt="mark"></p>
<h2 id="网格线"><a href="#网格线" class="headerlink" title="网格线"></a>网格线</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(panel.grid.major = element_line(colour = &quot;blue&quot;), panel.grid.minor = element_line(colour = &quot;red&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/GBe6CG68Ib.png?imageslim" alt="mark"></p>
<h3 id="移除所有的网格线"><a href="#移除所有的网格线" class="headerlink" title="移除所有的网格线"></a>移除所有的网格线</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">basic+theme(panel.grid.major = element_line(NA),</div><div class="line">            panel.grid.minor = element_line(NA))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/eL008ADBkA.png?imageslim" alt="mark"></p>
<h3 id="只保留y轴线"><a href="#只保留y轴线" class="headerlink" title="只保留y轴线"></a>只保留y轴线</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">basic+theme(panel.grid.major.y = element_line(colour = &quot;black&quot;, size = 0.20),</div><div class="line">            panel.grid.major.x = element_line(NA),</div><div class="line">            panel.grid.minor = element_line(NA))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/IBAb1m2be4.png?imageslim" alt="mark"></p>
<h2 id="修改刻度"><a href="#修改刻度" class="headerlink" title="修改刻度"></a>修改刻度</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(axis.ticks = element_line(size=0.2))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/96ckHBC006.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(axis.ticks = element_line(NA))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/FBJ2k0J7bB.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(axis.ticks = element_line(colour = &quot;blue&quot;, size = 2))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/blhAmIg3gF.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">basic+theme(axis.ticks = element_line(size=2),</div><div class="line">            axis.ticks.x = element_line(colour = &quot;blue&quot;),</div><div class="line">            axis.ticks.y = element_line(colour = &quot;red&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/b20AiC7AAC.png?imageslim" alt="mark"></p>
<h2 id="图例"><a href="#图例" class="headerlink" title="图例"></a>图例</h2><h3 id="修改图例位置"><a href="#修改图例位置" class="headerlink" title="修改图例位置"></a>修改图例位置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.position = &quot;top&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/6kJ5DLG298.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.position = &quot;bottom&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/I6GeiH36C1.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.position = c(0,0))#左下角</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/65Gh1EfA0J.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.position = c(1,1))#右上角</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/ci77mHfc1H.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.position = c(0.8,0.8))#通过坐标设置可以将图例置于任意位置</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/eBe2ee3KLB.png?imageslim" alt="mark"></p>
<h3 id="移除图例"><a href="#移除图例" class="headerlink" title="移除图例"></a>移除图例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+labs(fill=&quot;&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/7A21F6hEmD.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+labs(fill=&quot;&quot;)+theme(legend.position = c(0.8,0.8))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/6fg1A8l715.png?imageslim" alt="mark"></p>
<p>看看文章发表样式图形<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">publication_style &lt;- basic+guides(fill=FALSE)+</div><div class="line">  theme(axis.line = element_line(size = 0.5), </div><div class="line">        panel.background = element_rect(fill=NA, size = rel(20)),</div><div class="line">        panel.grid.minor = element_line(colour = NA),</div><div class="line">        axis.text = element_text(size=16),</div><div class="line">        axis.title = element_text(size = 18))</div><div class="line">publication_style</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/LLJ69769c9.png?imageslim" alt="mark"></p>
<p>将柱形图与x轴之间的距离消除<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">publication_style+scale_y_continuous(expand = c(0,0))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/69eLJ7CI2b.png?imageslim" alt="mark"></p>
<p>可以看到上述图形基本达到了文章发表的水平，因此我们可以将主题theme保存下来以后使用，通过设置全局主题来使所有图形有相同版式。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">theme_set(theme_gray()+</div><div class="line">            theme(axis.line = element_line(size = 0.5),</div><div class="line">                  panel.background = element_rect(fill=NA, size = rel(20)),</div><div class="line">                  panel.grid.minor = element_line(colour = NA),</div><div class="line">                  axis.text = element_text(size = 16),</div><div class="line">                  axis.title = element_text(size = 18)))</div><div class="line">basic</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/CK9CgB5Cme.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+scale_y_continuous(expand = c(0,0))+guides(fill=FALSE)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/g2ed2h7ckd.png?imageslim" alt="mark"></p>
<p>如果需要还原主题设定的话，只要运行以下命令就行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">theme_set(theme_gray())</div></pre></td></tr></table></figure></p>
<h2 id="SessionInfO"><a href="#SessionInfO" class="headerlink" title="SessionInfO()"></a>SessionInfO()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">##  [1] RColorBrewer_1.1-2 plyr_1.8.4         forcats_0.2.0     </div><div class="line">##  [4] stringr_1.2.0      dplyr_0.7.4        purrr_0.2.4       </div><div class="line">##  [7] readr_1.1.1        tidyr_0.7.2        tibble_1.4.2      </div><div class="line">## [10] ggplot2_2.2.1.9000 tidyverse_1.2.1   </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.15      cellranger_1.1.0  pillar_1.1.0     </div><div class="line">##  [4] compiler_3.4.3    bindr_0.1         tools_3.4.3      </div><div class="line">##  [7] digest_0.6.14     lubridate_1.7.1   jsonlite_1.5     </div><div class="line">## [10] evaluate_0.10.1   nlme_3.1-131      gtable_0.2.0     </div><div class="line">## [13] lattice_0.20-35   pkgconfig_2.0.1   rlang_0.1.6      </div><div class="line">## [16] psych_1.7.8       cli_1.0.0         rstudioapi_0.7   </div><div class="line">## [19] yaml_2.1.16       parallel_3.4.3    haven_1.1.1      </div><div class="line">## [22] bindrcpp_0.2      xml2_1.2.0        httr_1.3.1       </div><div class="line">## [25] knitr_1.18        hms_0.4.1         rprojroot_1.3-2  </div><div class="line">## [28] grid_3.4.3        glue_1.2.0        R6_2.2.2         </div><div class="line">## [31] readxl_1.0.0      foreign_0.8-69    rmarkdown_1.8    </div><div class="line">## [34] modelr_0.1.1      reshape2_1.4.3    magrittr_1.5     </div><div class="line">## [37] backports_1.1.2   scales_0.5.0.9000 htmltools_0.3.6  </div><div class="line">## [40] rvest_0.3.2       assertthat_0.2.0  mnormt_1.5-5     </div><div class="line">## [43] colorspace_1.3-2  labeling_0.3      stringi_1.1.6    </div><div class="line">## [46] lazyeval_0.2.1    munsell_0.4.3     broom_0.4.3      </div><div class="line">## [49] crayon_1.3.4</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/g2ed2h7ckd.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;这节课作者命名为”Tweaking everything in a plot”。主要是对图形细节进行优化，包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;题目(title)、坐标轴标签、图例标签等&lt;/li&gt;
&lt;li&gt;字体&lt;/li&gt;
&lt;li&gt;颜色&lt;/li&gt;
&lt;li&gt;背景&lt;/li&gt;
&lt;li&gt;网格线等&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 04 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/25/%20Lesson%2004%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/25/ Lesson 04 for Plotting in R for Biologists/</id>
    <published>2018-01-25T04:19:05.000Z</published>
    <updated>2018-02-01T13:20:15.633Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/gHcHm3FdLC.png?imageslim" alt="mark"></p>
<p>上次将Lesson 02&amp;03一起讲解完了，在Lesson 04中主要解决下面几个问题</p>
<ul>
<li>剔除掉染色体前缀chr</li>
<li>对染色体进行正确排序</li>
<li>对数据进行过滤</li>
<li>对部分type重命名</li>
</ul>
<a id="more"></a>
<h2 id="加载数据"><a href="#加载数据" class="headerlink" title="加载数据"></a>加载数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(tidyverse)</div><div class="line">my_data &lt;- read.csv(&quot;Encode_HMM_data.txt&quot;, sep = &quot;\t&quot;, header = FALSE)</div><div class="line">head(my_data[, c(1:6)])</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##     V1    V2    V3                V4 V5 V6</div><div class="line">## 1 chr1 10000 10600 15_Repetitive/CNV  0  .</div><div class="line">## 2 chr1 10600 11137 13_Heterochrom/lo  0  .</div><div class="line">## 3 chr1 11137 11737       8_Insulator  0  .</div><div class="line">## 4 chr1 11737 11937       11_Weak_Txn  0  .</div><div class="line">## 5 chr1 11937 12137   7_Weak_Enhancer  0  .</div><div class="line">## 6 chr1 12137 14537       11_Weak_Txn  0  .</div></pre></td></tr></table></figure>
<h3 id="对数据部分列进行重命名"><a href="#对数据部分列进行重命名" class="headerlink" title="对数据部分列进行重命名"></a>对数据部分列进行重命名</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">names(my_data)[1:4] &lt;- c(&quot;chrom&quot;, &quot;start&quot;, &quot;stop&quot;,&quot;type&quot;)</div><div class="line">head(my_data[, c(1:4)])</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   chrom start  stop              type</div><div class="line">## 1  chr1 10000 10600 15_Repetitive/CNV</div><div class="line">## 2  chr1 10600 11137 13_Heterochrom/lo</div><div class="line">## 3  chr1 11137 11737       8_Insulator</div><div class="line">## 4  chr1 11737 11937       11_Weak_Txn</div><div class="line">## 5  chr1 11937 12137   7_Weak_Enhancer</div><div class="line">## 6  chr1 12137 14537       11_Weak_Txn</div></pre></td></tr></table></figure>
<h2 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/j2IB94I12k.png?imageslim" alt="mark"></p>
<h2 id="数据调整"><a href="#数据调整" class="headerlink" title="数据调整"></a>数据调整</h2><p>主要是针对上面提出的几个问题对数据进行调整</p>
<h3 id="剔除染色体前缀chr"><a href="#剔除染色体前缀chr" class="headerlink" title="剔除染色体前缀chr"></a>剔除染色体前缀chr</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">my_data$chrom &lt;- factor(gsub(&quot;chr&quot;, &quot;&quot;, my_data$chrom))</div><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/2ibGfgm9Gg.png?imageslim" alt="mark"></p>
<h3 id="对染色体进行排序"><a href="#对染色体进行排序" class="headerlink" title="对染色体进行排序"></a>对染色体进行排序</h3><p>这个关于人类的基因组数据，所以染色体顺序应该是1：22,X,Y。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">my_data$chrom &lt;- factor(my_data$chrom, levels = c(seq(1:22), &quot;X&quot;, &quot;Y&quot;))</div><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/G0i0aBH43a.png?imageslim" alt="mark"></p>
<p>这下看起来相对好一点</p>
<h3 id="选取type"><a href="#选取type" class="headerlink" title="选取type"></a>选取type</h3><p>只选取我们感兴趣的type进行可视化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">my_data &lt;- my_data[my_data$type %in% c(&quot;1_Active_Promoter&quot;, &quot;4_Strong_Enhancer&quot;, &quot;8_Insulator&quot;), ]</div></pre></td></tr></table></figure>
<h4 id="对选取的type进行重命名"><a href="#对选取的type进行重命名" class="headerlink" title="对选取的type进行重命名"></a>对选取的type进行重命名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(plyr)</div><div class="line">my_data$type &lt;- revalue(my_data$type,c(&quot;1_Active_Promoter&quot;=&quot;Promoter&quot;,&quot;4_Strong_Enhancer&quot;=&quot;Enhancer&quot;,&quot;8_Insulator&quot;=&quot;Insulator&quot;))</div><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/gHcHm3FdLC.png?imageslim" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">##  [1] plyr_1.8.4         forcats_0.2.0      stringr_1.2.0     </div><div class="line">##  [4] dplyr_0.7.4        purrr_0.2.4        readr_1.1.1       </div><div class="line">##  [7] tidyr_0.7.2        tibble_1.4.2       ggplot2_2.2.1.9000</div><div class="line">## [10] tidyverse_1.2.1   </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.15      cellranger_1.1.0  pillar_1.1.0     </div><div class="line">##  [4] compiler_3.4.3    bindr_0.1         tools_3.4.3      </div><div class="line">##  [7] digest_0.6.14     lubridate_1.7.1   jsonlite_1.5     </div><div class="line">## [10] evaluate_0.10.1   nlme_3.1-131      gtable_0.2.0     </div><div class="line">## [13] lattice_0.20-35   pkgconfig_2.0.1   rlang_0.1.6      </div><div class="line">## [16] psych_1.7.8       cli_1.0.0         rstudioapi_0.7   </div><div class="line">## [19] yaml_2.1.16       parallel_3.4.3    haven_1.1.1      </div><div class="line">## [22] bindrcpp_0.2      xml2_1.2.0        httr_1.3.1       </div><div class="line">## [25] knitr_1.18        hms_0.4.1         rprojroot_1.3-2  </div><div class="line">## [28] grid_3.4.3        glue_1.2.0        R6_2.2.2         </div><div class="line">## [31] readxl_1.0.0      foreign_0.8-69    rmarkdown_1.8    </div><div class="line">## [34] modelr_0.1.1      reshape2_1.4.3    magrittr_1.5     </div><div class="line">## [37] backports_1.1.2   scales_0.5.0.9000 htmltools_0.3.6  </div><div class="line">## [40] rvest_0.3.2       assertthat_0.2.0  mnormt_1.5-5     </div><div class="line">## [43] colorspace_1.3-2  labeling_0.3      stringi_1.1.6    </div><div class="line">## [46] lazyeval_0.2.1    munsell_0.4.3     broom_0.4.3      </div><div class="line">## [49] crayon_1.3.4</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/gHcHm3FdLC.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;上次将Lesson 02&amp;amp;03一起讲解完了，在Lesson 04中主要解决下面几个问题&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;剔除掉染色体前缀chr&lt;/li&gt;
&lt;li&gt;对染色体进行正确排序&lt;/li&gt;
&lt;li&gt;对数据进行过滤&lt;/li&gt;
&lt;li&gt;对部分type重命名&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 02&amp;03 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/20/%20Lesson%2002&amp;03%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/20/ Lesson 02&amp;03 for Plotting in R for Biologists/</id>
    <published>2018-01-20T04:19:05.000Z</published>
    <updated>2018-02-01T12:37:07.349Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/dBhf13K3Ge.png?imageslim" alt="mark"></p>
<p>Lesson02主要讲了如何从Excel导入数据以及如何从UCSC、ENSEMBL和RENCODE上下载数据，因此我就将Lesson02并入Lesson03一起讲了。</p>
<a id="more"></a>
<h2 id="从ECXEl中导入数据"><a href="#从ECXEl中导入数据" class="headerlink" title="从ECXEl中导入数据"></a>从ECXEl中导入数据</h2><p>数据来源于文献<a href="https://www.nature.com/articles/1209254" target="_blank" rel="external">“Gene expression profiling of breast cell lines identifies potential new basal markers”</a>的补充数据集Supplementary Table 1。将之下载到工作目录区。数据读取的话只需要用<code>read.csv()</code>即可，指定<code>sep</code>。<strong>gtf</strong>、<strong>bed</strong>文件都可以通过<code>read.csv()</code>读取。即使是没有后缀的文件，只要知道其分隔符，就可以通过设置<code>sep</code>来读取数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">my_data &lt;- read.csv(&quot;micro_array_results_table1.txt&quot;, sep = &apos;\t&apos;, header = TRUE)</div><div class="line">head(my_data[,c(1:6)])</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   Probe.Set.ID Gene.Symbol Type  X184B5 BrCa.MZ.01   BT.20</div><div class="line">## 1    1007_s_at        DDR1 gene 1113.91     815.53 1564.76</div><div class="line">## 2      1053_at        RFC2 gene  159.02     253.24  320.22</div><div class="line">## 3       117_at       HSPA6 gene   60.76      33.91   26.39</div><div class="line">## 4       121_at        PAX8 gene  197.76     121.33  122.81</div><div class="line">## 5    1255_g_at      GUCA1A gene    6.73       7.88    6.28</div><div class="line">## 6      1294_at       UBE1L gene  118.82      57.24  432.24</div></pre></td></tr></table></figure>
<p>试试读取<strong>gtf</strong>文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Brassica_gtf &lt;- read.csv(&quot;E:/Brassica napus database/Brassica_napus.annotation_v5.gtf&quot;, sep = &quot;\t&quot;, header = FALSE)</div><div class="line">head(Brassica_gtf)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##       V1     V2   V3   V4   V5   V6 V7 V8                           V9</div><div class="line">## 1 chrA01 GazeA2 exon  831 1437 7.80  +  . transcript_id BnaA01g00010D;</div><div class="line">## 2 chrA01 GazeA2  CDS 1070 1345    .  +  0 transcript_id BnaA01g00010D;</div><div class="line">## 3 chrA01 GazeA2 exon 1487 2124 2.15  -  . transcript_id BnaA01g00020D;</div><div class="line">## 4 chrA01 GazeA2 exon 2256 2436 3.19  -  . transcript_id BnaA01g00020D;</div><div class="line">## 5 chrA01 GazeA2  CDS 1645 2124    .  -  0 transcript_id BnaA01g00020D;</div><div class="line">## 6 chrA01 GazeA2  CDS 2256 2282    .  -  0 transcript_id BnaA01g00020D;</div></pre></td></tr></table></figure>
<p>其他格式文件我这里就不试了，有兴趣的话可以自己去尝试。</p>
<h2 id="数据探索"><a href="#数据探索" class="headerlink" title="数据探索"></a>数据探索</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">library(tidyverse)</div><div class="line">#读取数据</div><div class="line">my_data &lt;- read.csv(&quot;Encode_HMM_data.txt&quot;, sep = &quot;\t&quot;, header = FALSE)</div><div class="line">dim(my_data)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">## [1] 571339      9</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(my_data[, c(1:6)])</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##     V1    V2    V3                V4 V5 V6</div><div class="line">## 1 chr1 10000 10600 15_Repetitive/CNV  0  .</div><div class="line">## 2 chr1 10600 11137 13_Heterochrom/lo  0  .</div><div class="line">## 3 chr1 11137 11737       8_Insulator  0  .</div><div class="line">## 4 chr1 11737 11937       11_Weak_Txn  0  .</div><div class="line">## 5 chr1 11937 12137   7_Weak_Enhancer  0  .</div><div class="line">## 6 chr1 12137 14537       11_Weak_Txn  0  .</div></pre></td></tr></table></figure>
<p>对数据部分列进行重命名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">names(my_data)[1:4] &lt;- c(&quot;chrom&quot;, &quot;start&quot;, &quot;stop&quot;, &quot;type&quot;)</div></pre></td></tr></table></figure></p>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><p>先初步看一下不同染色体上的type类型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/dBhf13K3Ge.png?imageslim" alt="mark"></p>
<p>从这个图中可以看到还有很多缺陷</p>
<ul>
<li>染色体顺序错乱，前缀chr在坐标轴上排列乱</li>
<li>类型太多了，我们只需要可视化我们感兴趣的type</li>
<li>类型的名字乱</li>
</ul>
<p>这几个问题将在Lesson04解决</p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo()"></a>SessionInfo()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">## [1] forcats_0.2.0      stringr_1.2.0      dplyr_0.7.4       </div><div class="line">## [4] purrr_0.2.4        readr_1.1.1        tidyr_0.7.2       </div><div class="line">## [7] tibble_1.4.2       ggplot2_2.2.1.9000 tidyverse_1.2.1   </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.15      cellranger_1.1.0  pillar_1.1.0     </div><div class="line">##  [4] compiler_3.4.3    plyr_1.8.4        bindr_0.1        </div><div class="line">##  [7] tools_3.4.3       digest_0.6.14     lubridate_1.7.1  </div><div class="line">## [10] jsonlite_1.5      evaluate_0.10.1   nlme_3.1-131     </div><div class="line">## [13] gtable_0.2.0      lattice_0.20-35   pkgconfig_2.0.1  </div><div class="line">## [16] rlang_0.1.6       psych_1.7.8       cli_1.0.0        </div><div class="line">## [19] rstudioapi_0.7    yaml_2.1.16       parallel_3.4.3   </div><div class="line">## [22] haven_1.1.1       bindrcpp_0.2      xml2_1.2.0       </div><div class="line">## [25] httr_1.3.1        knitr_1.18        hms_0.4.1        </div><div class="line">## [28] rprojroot_1.3-2   grid_3.4.3        glue_1.2.0       </div><div class="line">## [31] R6_2.2.2          readxl_1.0.0      foreign_0.8-69   </div><div class="line">## [34] rmarkdown_1.8     modelr_0.1.1      reshape2_1.4.3   </div><div class="line">## [37] magrittr_1.5      backports_1.1.2   scales_0.5.0.9000</div><div class="line">## [40] htmltools_0.3.6   rvest_0.3.2       assertthat_0.2.0 </div><div class="line">## [43] mnormt_1.5-5      colorspace_1.3-2  labeling_0.3     </div><div class="line">## [46] stringi_1.1.6     lazyeval_0.2.1    munsell_0.4.3    </div><div class="line">## [49] broom_0.4.3       crayon_1.3.4</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/dBhf13K3Ge.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;Lesson02主要讲了如何从Excel导入数据以及如何从UCSC、ENSEMBL和RENCODE上下载数据，因此我就将Lesson02并入Lesson03一起讲了。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 01 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/15/%20Lesson%2001%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/15/ Lesson 01 for Plotting in R for Biologists/</id>
    <published>2018-01-15T04:19:05.000Z</published>
    <updated>2018-02-01T02:40:18.262Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/f6L6BHLm15.png?imageslim" alt="mark"></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>老早之前就知道了这门课<a href="http://omgenomics.com/plotting-in-r-for-biologists/" target="_blank" rel="external"><strong>Plotting in R for Biologists</strong></a>,一直没有去学习一下，最近花时间看了一遍videos，发现讲的很不错，虽然有一节有一知识点讲的不是很清楚。学了一遍之后记点笔记，这是lesson1的学习笔记。这一节主要讲了数据读取、快速绘图以及图形保存。</p>
<a id="more"></a>
<h2 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(ggplot2)</div><div class="line">filename &lt;- &quot;/home/taoyan/Plotting in R for Biologists/Lesson-01/Encode_HMM_data.txt&quot;</div><div class="line">my_data &lt;- read.csv(filename, sep=&quot;\t&quot;, header=FALSE)</div><div class="line"># 查看一下数据</div><div class="line">head(my_data)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##     V1    V2    V3                V4 V5 V6    V7    V8          V9</div><div class="line">## 1 chr1 10000 10600 15_Repetitive/CNV  0  . 10000 10600 245,245,245</div><div class="line">## 2 chr1 10600 11137 13_Heterochrom/lo  0  . 10600 11137 245,245,245</div><div class="line">## 3 chr1 11137 11737       8_Insulator  0  . 11137 11737  10,190,254</div><div class="line">## 4 chr1 11737 11937       11_Weak_Txn  0  . 11737 11937 153,255,102</div><div class="line">## 5 chr1 11937 12137   7_Weak_Enhancer  0  . 11937 12137   255,252,4</div><div class="line">## 6 chr1 12137 14537       11_Weak_Txn  0  . 12137 14537 153,255,102</div></pre></td></tr></table></figure>
<p>对数据列名重命名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">names(my_data)[1:4] &lt;- c(&quot;chrom&quot;,&quot;start&quot;,&quot;end&quot;,&quot;type&quot;)</div><div class="line">head(my_data)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   chrom start   end              type V5 V6    V7    V8          V9</div><div class="line">## 1  chr1 10000 10600 15_Repetitive/CNV  0  . 10000 10600 245,245,245</div><div class="line">## 2  chr1 10600 11137 13_Heterochrom/lo  0  . 10600 11137 245,245,245</div><div class="line">## 3  chr1 11137 11737       8_Insulator  0  . 11137 11737  10,190,254</div><div class="line">## 4  chr1 11737 11937       11_Weak_Txn  0  . 11737 11937 153,255,102</div><div class="line">## 5  chr1 11937 12137   7_Weak_Enhancer  0  . 11937 12137   255,252,4</div><div class="line">## 6  chr1 12137 14537       11_Weak_Txn  0  . 12137 14537 153,255,102</div></pre></td></tr></table></figure>
<h2 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h2><p>对不同染色体上的不同type绘制柱形图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(data = my_data, aes(x= chrom, fill= type))+geom_bar()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/A6geh7Hf22.png?imageslim" alt="mark"></p>
<h2 id="保存"><a href="#保存" class="headerlink" title="保存"></a>保存</h2><p>如果想直接保存图片到文件中，可以用<code>dev.off</code>，R语言支持多种图形类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">png(&quot;Lesson-01/plot.png&quot;)</div><div class="line">ggplot(my_data,aes(x=chrom,fill=type)) + geom_bar()</div><div class="line">dev.off()</div><div class="line"></div><div class="line">tiff(&quot;Lesson-01/plot.tiff&quot;)</div><div class="line">ggplot(my_data,aes(x=chrom,fill=type)) + geom_bar()</div><div class="line">dev.off()</div><div class="line"></div><div class="line">jpeg(&quot;Lesson-01/plot.jpg&quot;)</div><div class="line">ggplot(my_data,aes(x=chrom,fill=type)) + geom_bar()</div><div class="line">dev.off()</div><div class="line"></div><div class="line">pdf(&quot;Lesson-01/plot.pdf&quot;)</div><div class="line">ggplot(my_data,aes(x=chrom,fill=type)) + geom_bar()</div><div class="line">dev.off()</div><div class="line"></div><div class="line"># 设置清晰度</div><div class="line">png(&quot;Lesson-01/plot_hi_res.png&quot;,1000,1000)</div><div class="line">ggplot(my_data,aes(x=chrom,fill=type)) + geom_bar()</div><div class="line">dev.off()</div></pre></td></tr></table></figure>
<p>这节课比较简单，没什么知识点，当然如果R语言没入门的话读个数据都困难重重，所以如果基础不太好的可以直接去youtube看视频，讲的很详细。</p>
<p>##SessionInfo<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-pc-linux-gnu (64-bit)</div><div class="line">## Running under: Ubuntu 17.10</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## BLAS: /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3</div><div class="line">## LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3</div><div class="line">## </div><div class="line">## locale:</div><div class="line">##  [1] LC_CTYPE=zh_CN.UTF-8       LC_NUMERIC=C              </div><div class="line">##  [3] LC_TIME=zh_CN.UTF-8        LC_COLLATE=zh_CN.UTF-8    </div><div class="line">##  [5] LC_MONETARY=zh_CN.UTF-8    LC_MESSAGES=zh_CN.UTF-8   </div><div class="line">##  [7] LC_PAPER=zh_CN.UTF-8       LC_NAME=C                 </div><div class="line">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </div><div class="line">## [11] LC_MEASUREMENT=zh_CN.UTF-8 LC_IDENTIFICATION=C       </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">## [1] ggplot2_2.2.1</div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.14     digest_0.6.14    rprojroot_1.3-2  plyr_1.8.4      </div><div class="line">##  [5] grid_3.4.3       gtable_0.2.0     backports_1.1.2  magrittr_1.5    </div><div class="line">##  [9] evaluate_0.10.1  scales_0.5.0     pillar_1.1.0     rlang_0.1.6     </div><div class="line">## [13] stringi_1.1.6    lazyeval_0.2.1   rmarkdown_1.8    labeling_0.3    </div><div class="line">## [17] tools_3.4.3      stringr_1.2.0    munsell_0.4.3    yaml_2.1.16     </div><div class="line">## [21] compiler_3.4.3   colorspace_1.3-2 htmltools_0.3.6  knitr_1.18      </div><div class="line">## [25] tibble_1.4.1</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/f6L6BHLm15.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;老早之前就知道了这门课&lt;a href=&quot;http://omgenomics.com/plotting-in-r-for-biologists/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;strong&gt;Plotting in R for Biologists&lt;/strong&gt;&lt;/a&gt;,一直没有去学习一下，最近花时间看了一遍videos，发现讲的很不错，虽然有一节有一知识点讲的不是很清楚。学了一遍之后记点笔记，这是lesson1的学习笔记。这一节主要讲了数据读取、快速绘图以及图形保存。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
  </entry>
  
  <entry>
    <title>一步步教你如何绘制GWAS中的曼哈顿图以及QQ图</title>
    <link href="https://ytlogos.github.io/2018/01/11/%E4%B8%80%E6%AD%A5%E6%AD%A5%E6%95%99%E4%BD%A0%E5%A6%82%E4%BD%95%E7%BB%98%E5%88%B6GWAS%E4%B8%AD%E7%9A%84%E6%9B%BC%E5%93%88%E9%A1%BF%E5%9B%BE%E4%BB%A5%E5%8F%8AQQ%E5%9B%BE/"/>
    <id>https://ytlogos.github.io/2018/01/11/一步步教你如何绘制GWAS中的曼哈顿图以及QQ图/</id>
    <published>2018-01-11T04:19:05.000Z</published>
    <updated>2018-01-11T04:22:08.954Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/EE3ce1m2L2.png?imageslim" alt="mark"></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>GWAS研究中的曼哈顿图以及QQ图可以说是标配了，至于具体如何理解这两个图，可以参考我以前的博客。上周我利用自己的数据跑了个GWAS，我是利用<strong>GAPIT</strong>跑的，出的图感觉真心丑，大家可以看看：<br><a id="more"></a></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/iAm97eG6FD.png?imageslim" alt="Manhattan plot"><br><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/im6b1iJ7FE.png?imageslim" alt="QQ plot"></p>
<p>所以我利用<strong>GAPIT</strong>出来的数据重新画了图，用的就是包<strong>qqman</strong>。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>Github主页上提供了三种安装方式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Install the stable release from CRAn</div><div class="line">install.packages(&quot;qqman&quot;)</div><div class="line"># 直接从Github上安装</div><div class="line">devtools::install_github(&quot;stephenturner/qqman&quot;)</div><div class="line"># 从Github上安装最新的开发版</div><div class="line">devtools::install_github(&quot;stephenturner/qqman&quot;,ref=&quot;dev&quot;)</div></pre></td></tr></table></figure></p>
<h2 id="数据格式"><a href="#数据格式" class="headerlink" title="数据格式"></a>数据格式</h2><p><strong>qqman</strong>里内置了一套数据集<code>gwasResults</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(qqman)</div><div class="line">dim(gwasResults)</div><div class="line">## [1] 16470     4</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(gwasResults)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   SNP CHR BP         P</div><div class="line">## 1 rs1   1  1 0.9148060</div><div class="line">## 2 rs2   1  2 0.9370754</div><div class="line">## 3 rs3   1  3 0.2861395</div><div class="line">## 4 rs4   1  4 0.8304476</div><div class="line">## 5 rs5   1  5 0.6417455</div><div class="line">## 6 rs6   1  6 0.5190959</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">str(gwasResults)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">## &apos;data.frame&apos;:    16470 obs. of  4 variables:</div><div class="line">##  $ SNP: chr  &quot;rs1&quot; &quot;rs2&quot; &quot;rs3&quot; &quot;rs4&quot; ...</div><div class="line">##  $ CHR: int  1 1 1 1 1 1 1 1 1 1 ...</div><div class="line">##  $ BP : int  1 2 3 4 5 6 7 8 9 10 ...</div><div class="line">##  $ P  : num  0.915 0.937 0.286 0.83 0.642 ...</div></pre></td></tr></table></figure>
<p>可以看到该数据集共有16470行，4列，分别为SNP名、染色体、SNP位置以及P值。<br>该数据集不大，SNP标记十分少，通过每条染色体上的SNP标记可以看出<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">as.data.frame(table(gwasResults$CHR))</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">##    Var1 Freq</div><div class="line">## 1     1 1500</div><div class="line">## 2     2 1191</div><div class="line">## 3     3 1040</div><div class="line">## 4     4  945</div><div class="line">## 5     5  877</div><div class="line">## 6     6  825</div><div class="line">## 7     7  784</div><div class="line">## 8     8  750</div><div class="line">## 9     9  721</div><div class="line">## 10   10  696</div><div class="line">## 11   11  674</div><div class="line">## 12   12  655</div><div class="line">## 13   13  638</div><div class="line">## 14   14  622</div><div class="line">## 15   15  608</div><div class="line">## 16   16  595</div><div class="line">## 17   17  583</div><div class="line">## 18   18  572</div><div class="line">## 19   19  562</div><div class="line">## 20   20  553</div><div class="line">## 21   21  544</div><div class="line">## 22   22  535</div></pre></td></tr></table></figure>
<h2 id="Manhattan-plot"><a href="#Manhattan-plot" class="headerlink" title="Manhattan plot"></a>Manhattan plot</h2><p><strong>qqman</strong>提供了一个绘制Manhattan plot的函数<code>manhattan()</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(gwasResults)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/h6dGbBmlkI.png?imageslim" alt="mark"></p>
<p><code>manhattan()</code>提供了大量的参数设置：标题(main=)、y轴范围(ylim=)、控制点的大小(cex=)、x轴坐标轴标签的字体大小(cex.axis=)、颜色(col=)、阈值参考线控制(suggestiveline=, genomewideline=)、以及添加注释信息等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(gwasResults, main=&quot;Manhattan plot&quot;, ylim=c(0, 10), cex=0.6, cex.axis=0.9, col = c(&quot;blue&quot;,&quot;orange&quot;), suggestiveline = F, genomewideline = F, chrlabs = c(1:20, &quot;P&quot;,&quot;Q&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/LHmie5lJJI.png?imageslim" alt="mark"></p>
<p>还提供针对一条染色体数据进行绘图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(subset(gwasResults, CHR==3))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/a7062c4K9L.png?imageslim" alt="mark"></p>
<p>对有显著性影响的SNP进行高亮(没有的话会忽略掉)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(gwasResults, highlight = snpsOfInterest)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/e3lD9c1706.png?imageslim" alt="mark"></p>
<p>针对特定染色体以及特定区间进行高亮<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(subset(gwasResults, CHR==3), highlight=snpsOfInterest, xlim=c(200, 500), main=&quot;Chr 3&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/el9mh4j8mJ.png?imageslim" alt="mark"></p>
<p><code>manhattan</code>注释的时候默认注释每条染色体中P值最小且超过我们设定的p值阈值的SNP点，默认的P值阈值为0.01<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(gwasResults, annotatePval = 0.01)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/36G2LmhlCm.png?imageslim" alt="mark"></p>
<p>我们可以通过自行设定参数注释所有超过P值阈值的SNP点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(gwasResults, annotatePval = 0.001, annotateTop = FALSE)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/0f84LHbID9.png?imageslim" alt="mark"></p>
<p><code>manhattan</code>可以绘制任意的value值，不限于p-value，只需要在设置中指定value值就行了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gwasResults &lt;- transform(gwasResults, zscore=qnorm(P/2, lower.tail = FALSE))</div><div class="line">head(gwasResults)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   SNP CHR BP         P    zscore</div><div class="line">## 1 rs1   1  1 0.9148060 0.1069785</div><div class="line">## 2 rs2   1  2 0.9370754 0.0789462</div><div class="line">## 3 rs3   1  3 0.2861395 1.0666287</div><div class="line">## 4 rs4   1  4 0.8304476 0.2141275</div><div class="line">## 5 rs5   1  5 0.6417455 0.4652597</div><div class="line">## 6 rs6   1  6 0.5190959 0.6447396</div></pre></td></tr></table></figure>
<p>接下来利用value值zscore来绘制图形<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(gwasResults, p = &quot;zscore&quot;, logp = FALSE, ylab=&quot;Z-score&quot;, genomewideline = FALSE, suggestiveline = FALSE, main=&quot;Manhattan plot of Z-scores&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/d5K199L3lh.png?imageslim" alt="mark"></p>
<p>需要注意的几点：</p>
<ul>
<li>数据集列名默认是SNP、CHR、BP和P，因此如何自己的数据集列名与此不一致的话，要么转为一致，要么绘图时指定chr=、bp=、p=和snp=。具体情况可见help(manhattan)。</li>
<li>染色体编号那一列必须是数值型，如果数据集中有”X”、”Y”以及”MT”等染色体，想要转为数值型编号再在绘图时指定坐标名</li>
<li><code>manhattan</code>只提供了修改snp点的颜色参数，如果要修改阈值线、高亮、注释等的颜色，需要修改源码。</li>
</ul>
<h2 id="QQ图"><a href="#QQ图" class="headerlink" title="QQ图"></a>QQ图</h2><p><strong>qqman</strong>提供了绘制QQ图的函数<code>qq()</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qq(gwasResults)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/25aI37Ld3g.png?imageslim" alt="mark"></p>
<p>通过参数设置可以指定点的类型、大小、颜色等<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qq(gwasResults$P, main=&quot;Q-Q plot of GWAS p-value&quot;, xlim=c(0,7), ylim=c(0,12), pch=18, col = &quot;blue4&quot;, cex=1.5, las=1)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/9hlig1ajam.png?imageslim" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">## [1] qqman_0.1.3</div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] compiler_3.4.3  backports_1.1.2 magrittr_1.5    rprojroot_1.3-2</div><div class="line">##  [5] tools_3.4.3     htmltools_0.3.6 yaml_2.1.16     Rcpp_0.12.14   </div><div class="line">##  [9] calibrate_1.7.2 stringi_1.1.6   rmarkdown_1.8   knitr_1.18     </div><div class="line">## [13] stringr_1.2.0   digest_0.6.13   evaluate_0.10.1</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/EE3ce1m2L2.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;GWAS研究中的曼哈顿图以及QQ图可以说是标配了，至于具体如何理解这两个图，可以参考我以前的博客。上周我利用自己的数据跑了个GWAS，我是利用&lt;strong&gt;GAPIT&lt;/strong&gt;跑的，出的图感觉真心丑，大家可以看看：&lt;br&gt;
    
    </summary>
    
      <category term="GWAS" scheme="https://ytlogos.github.io/categories/GWAS/"/>
    
    
      <category term="GWAS" scheme="https://ytlogos.github.io/tags/GWAS/"/>
    
      <category term="QQ Plot" scheme="https://ytlogos.github.io/tags/QQ-Plot/"/>
    
      <category term="Manhattan Plot" scheme="https://ytlogos.github.io/tags/Manhattan-Plot/"/>
    
  </entry>
  
  <entry>
    <title>生物信息学学习笔记（七）</title>
    <link href="https://ytlogos.github.io/2018/01/07/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%83%EF%BC%89/"/>
    <id>https://ytlogos.github.io/2018/01/07/生物信息学学习笔记（七）/</id>
    <published>2018-01-07T13:19:05.000Z</published>
    <updated>2018-01-07T12:44:02.414Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180107/2574kmE80m.png?imageslim" alt="mark"></p>
<ul>
<li><p>Polycomb group(PcG)蛋白是一组通过染色质修饰调控靶基因的抑制子，从生化和功能上可以分为两个主要的核心蛋白复合体PRC1(Polycomb repressive complex 1)和PRC2(Polycomb repressive complex 2)。PcG蛋白家族是一类在进化上极为保守的转录抑制因子。</p>
</li>
<li><p>Pericentrometric区域是接近端粒的DNA序列，它们含有大量的重复片段即其进行拷贝的常染色质起源位置(euchromatic ancestral loci)非常相似的大量DNA序列，是基因组结构中迅速改变的区域。</p>
</li>
</ul>
<a id="more"></a>
<ul>
<li><p>曼哈顿图p值不是很大的位点从图上看要尽量压缩到下面，而p值显著的位点突出在上面才是一个好的曼哈顿图，不然数据质控有问题。QQ图只在尾巴上翘起，显示显著性位点，如果从开始就偏离了，数据质控就有问题了。</p>
</li>
<li><p>基因组重测序中除了ACGT之外的其他字母含义：</p>
<ul>
<li>R =&gt; AG</li>
<li>Y =&gt; CT</li>
<li>M =&gt; AC</li>
<li>K =&gt; GT</li>
<li>S =&gt; CG</li>
<li>W =&gt; AT</li>
</ul>
</li>
<li><p>关于GWAS数据过滤的问题（摘自微信公众号：解螺旋的矿工）</p>
</li>
</ul>
<blockquote>
<p>现在较难定义常规GWAS，现在的GWAS方向已经从基于芯片数据的关联分析往基因组重测序数据关联分析偏转。如果完全基于genotype进行关联分析，数据过滤通常包括：genotype missing rate &lt; 90%，chi-square test of HWE &gt; 1e-06，minor allele frequency &gt; 0.01等，这个过程可以使用plink或者自己造轮子完成过滤。当然过滤的阈值与样本量及最终结果有关，一般需要个性化调试。功效更加大的做法是基于imputed genotype probability进行关联分析，此时需要在GWAS之前先做imputation，imputation过程会产生info score,过滤标准一般是info score &gt; 0.4,chi-square test of HWE &gt; 1e-06，minor allele frequency &gt; 0.01等，当然有时也需要进行个性化调试。GWAS只要inflation控制的好（GC lambda接近1，控制的要素是covariates的设定来解决population stratification），不需要太关心过滤的问题，甚至可以不过滤直接画曼哈顿图看是否有关联信号。大多数情况过滤不是影响能否获得有生物学意义位点的关键因素。</p>
</blockquote>
<ul>
<li><p>QQ图可以用来估计我们GWAS所用的模型能够多大程度地显示群体结构和群体相关性。由于大部分的SNP与性状是不相关联的，因此大部分的点应该是落在对角线上，偏离对角线表明伪关联性，主要是由于群体结构以及群体之间的相关性导致的。我们期望得到的是对角线上方的偏离，这往往意味着这些SNP与我们所研究的性状是可能关联的。</p>
</li>
<li><p>高水平的杂合率意味着低质量，在近交系snp中超过50%的杂合率说哦名数据是有问题的，不是很适合用来接下来的GWAS分析。</p>
</li>
</ul>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180107/2574kmE80m.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Polycomb group(PcG)蛋白是一组通过染色质修饰调控靶基因的抑制子，从生化和功能上可以分为两个主要的核心蛋白复合体PRC1(Polycomb repressive complex 1)和PRC2(Polycomb repressive complex 2)。PcG蛋白家族是一类在进化上极为保守的转录抑制因子。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Pericentrometric区域是接近端粒的DNA序列，它们含有大量的重复片段即其进行拷贝的常染色质起源位置(euchromatic ancestral loci)非常相似的大量DNA序列，是基因组结构中迅速改变的区域。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="bioinformatics" scheme="https://ytlogos.github.io/categories/bioinformatics/"/>
    
    
      <category term="GWAS" scheme="https://ytlogos.github.io/tags/GWAS/"/>
    
  </entry>
  
  <entry>
    <title>利用ggmap绘制简单地图</title>
    <link href="https://ytlogos.github.io/2018/01/03/%E5%88%A9%E7%94%A8ggmap%E7%BB%98%E5%88%B6%E7%AE%80%E5%8D%95%E5%9C%B0%E5%9B%BE/"/>
    <id>https://ytlogos.github.io/2018/01/03/利用ggmap绘制简单地图/</id>
    <published>2018-01-03T00:47:05.000Z</published>
    <updated>2018-01-03T00:45:42.506Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180103/BDJF5FajDc.png?imageslim" alt="mark"></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><a href="http://stat405.had.co.nz/ggmap.pdf" target="_blank" rel="external"><strong>ggmap</strong></a>允许用户从Google地图下载并绘制地图。并且<strong>ggmap</strong>完美契合<strong>ggplot2</strong>，因此经<strong>ggmap</strong>绘制的图形可以作为<strong>ggplot2</strong>的图层，进而在此基础上不断添加图形元素形成十分复杂的图形。<strong>ggplot2</strong>+<strong>ggmap</strong>是地理可视化的利器。<br><a id="more"></a></p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>安装方法有两种：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># From CRAN</div><div class="line">install.packages(&quot;ggmap&quot;)</div><div class="line"># From Github,必须先安装devtools</div><div class="line">devtools::install_github(&quot;dkahle/ggmap&quot;)</div></pre></td></tr></table></figure></p>
<h2 id="绘制"><a href="#绘制" class="headerlink" title="绘制"></a>绘制</h2><p>先画个杭州的地图，由于调用的是Google地图，可能需要翻墙，同时速度有点慢（访问的是Google地图数据库，由于网络限制数据抓取可能不完整）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">library(tidyverse)</div><div class="line">library(ggmap)</div><div class="line">map.hangzhou &lt;- get_map(&quot;Hangzhou&quot;)</div><div class="line">ggmap(map.hangzhou)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180103/j1EhiFDl3B.png?imageslim" alt="mark"></p>
<p>这里我们只使用了两个函数，分别是<code>get_map()从Google</code>中检索并下载地图，之后使用函数<code>ggmap()</code>绘制地图。同时<strong>ggmap</strong>支持管道操作(%&gt;%)。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">get_map(&quot;Hangzhou&quot;)%&gt;%ggmap()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180103/1kf8fI3KH7.png?imageslim" alt="mark"></p>
<p>现在我们绘制中国地图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">get_map(&quot;China&quot;)%&gt;%ggmap()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180103/jICh8268jb.png?imageslim" alt="mark"></p>
<p>可以看出画出来的图形十分不美观，加上<code>zoom</code>参数之后好看一点。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">get_map(&quot;China&quot;, zoom=4)%&gt;%ggmap()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180103/kImdmk2DEm.png?imageslim" alt="mark"></p>
<p>我们再来看一下天安门<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">get_map(&quot;Tiananmen&quot;,zoom=18)%&gt;%ggmap()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180103/DL0JHKhK20.png?imageslim" alt="mark"></p>
<p>应该足够清晰了<br>再来看看浙江大学的情形,这里默认显示的是玉泉校区<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">get_map(&quot;ZheJiang University Zijingang Campus&quot;, zoom = 17)%&gt;%ggmap()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180103/KIIH9be09L.png?imageslim" alt="mark"></p>
<p>接下来我们将浙江大学在杭州的几个校区标识出来，分别是紫金港、玉泉、华家池、西溪、之江<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"># 首先创建含有校区名字的数据集</div><div class="line">df.zjucampus_locations &lt;- tibble(location=c(&quot;Zhejiang university Zijingang Campus,Hangzhou,China&quot;,&quot;Zhejiang university Yuquan Campus,Hangzhou,China&quot;,&quot;Zhejiang university Zhijiang Campus,Hangzhou,China&quot;,&quot;Zhejiang university Huajiachi Campus,Hangzhou,China&quot;,&quot;Zhejiang university Xixi Campus,Hangzhou,China&quot;))</div><div class="line"># 获取经纬度</div><div class="line">geo.zjucampus_locations &lt;- geocode(df.zjucampus_locations$location)</div><div class="line"># 合并数据集</div><div class="line">df.zjucampus_locations &lt;- cbind(df.zjucampus_locations,geo.zjucampus_locations)</div><div class="line"># 绘制图形，在地图上将几个校区标识出来</div><div class="line">get_map(&quot;Hangzhou&quot;, zoom = 11)%&gt;%ggmap()+</div><div class="line">  geom_point(data=df.zjucampus_locations, aes(x=lon, y=lat), color=&quot;red&quot;, size=5)+</div><div class="line">  geom_text(data = df.zjucampus_locations,aes(lon, lat, label=c(&quot;Zhejiang university Zijingang Campus&quot;,&quot;Zhejiang university Yuquan Campus&quot;,&quot;Zhejiang university Zhijiang Campus&quot;,&quot;Zhejiang university Huajiachi Campus&quot;,&quot;Zhejiang university Xixi Campus&quot;)), size=3, color=&quot;blue&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180103/hkgfJKdEeH.png?imageslim" alt="mark"></p>
<p>由于网络限制就不调整了，这次能出图已经不容易了。可以看到玉泉校区与华家池校区竟然重叠在一起，通过它们的经纬度数据也发现相同，可能Google地图数据库对于国内来说还不是很好用，但是没办法调用百度地图只能很好的获取国内地图数据，一遇到国外的就歇菜了！</p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div><div class="line">R version 3.4.3 (2017-11-30)</div><div class="line">Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">Running under: Windows &gt;= 8 x64 (build 9200)</div><div class="line"></div><div class="line">Matrix products: default</div><div class="line"></div><div class="line">locale:</div><div class="line">[1] LC_COLLATE=Chinese (Simplified)_China.936  LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">[3] LC_MONETARY=Chinese (Simplified)_China.936 LC_NUMERIC=C                              </div><div class="line">[5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line"></div><div class="line">attached base packages:</div><div class="line">[1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line"></div><div class="line">other attached packages:</div><div class="line"> [1] ggmap_2.6.1        forcats_0.2.0      stringr_1.2.0      dplyr_0.7.4        purrr_0.2.4       </div><div class="line"> [6] readr_1.1.1        tidyr_0.7.2        tibble_1.4.1       ggplot2_2.2.1.9000 tidyverse_1.2.1   </div><div class="line"></div><div class="line">loaded via a namespace (and not attached):</div><div class="line"> [1] reshape2_1.4.3    haven_1.1.0       lattice_0.20-35   colorspace_1.3-2  yaml_2.1.16      </div><div class="line"> [6] rlang_0.1.6       pillar_1.0.1      foreign_0.8-69    glue_1.2.0        sp_1.2-5         </div><div class="line">[11] modelr_0.1.1      readxl_1.0.0      bindrcpp_0.2      jpeg_0.1-8        bindr_0.1        </div><div class="line">[16] plyr_1.8.4        munsell_0.4.3     gtable_0.2.0      cellranger_1.1.0  rvest_0.3.2      </div><div class="line">[21] RgoogleMaps_1.4.1 mapproj_1.2-5     psych_1.7.8       knitr_1.18        parallel_3.4.3   </div><div class="line">[26] proto_1.0.0       broom_0.4.3       Rcpp_0.12.14      geosphere_1.5-7   scales_0.5.0.9000</div><div class="line">[31] jsonlite_1.5      mnormt_1.5-5      rjson_0.2.15      hms_0.4.0         png_0.1-7        </div><div class="line">[36] stringi_1.1.6     grid_3.4.3        cli_1.0.0         tools_3.4.3       maps_3.2.0       </div><div class="line">[41] magrittr_1.5      lazyeval_0.2.1    crayon_1.3.4      pkgconfig_2.0.1   xml2_1.1.1       </div><div class="line">[46] lubridate_1.7.1   assertthat_0.2.0  httr_1.3.1        rstudioapi_0.7    R6_2.2.2         </div><div class="line">[51] nlme_3.1-131      compiler_3.4.3</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180103/BDJF5FajDc.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://stat405.had.co.nz/ggmap.pdf&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;strong&gt;ggmap&lt;/strong&gt;&lt;/a&gt;允许用户从Google地图下载并绘制地图。并且&lt;strong&gt;ggmap&lt;/strong&gt;完美契合&lt;strong&gt;ggplot2&lt;/strong&gt;，因此经&lt;strong&gt;ggmap&lt;/strong&gt;绘制的图形可以作为&lt;strong&gt;ggplot2&lt;/strong&gt;的图层，进而在此基础上不断添加图形元素形成十分复杂的图形。&lt;strong&gt;ggplot2&lt;/strong&gt;+&lt;strong&gt;ggmap&lt;/strong&gt;是地理可视化的利器。&lt;br&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="地图" scheme="https://ytlogos.github.io/tags/%E5%9C%B0%E5%9B%BE/"/>
    
      <category term="ggmap" scheme="https://ytlogos.github.io/tags/ggmap/"/>
    
  </entry>
  
  <entry>
    <title>机器学习概念及算法类型</title>
    <link href="https://ytlogos.github.io/2017/12/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9A%E4%B9%89%E4%BB%A5%E5%8F%8A%E7%AE%97%E6%B3%95%E7%B1%BB%E5%9E%8B%E5%88%9D%E6%8E%A2/"/>
    <id>https://ytlogos.github.io/2017/12/25/机器学习定义以及算法类型初探/</id>
    <published>2017-12-25T12:19:05.000Z</published>
    <updated>2017-12-25T12:56:28.672Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171225/929l1BKmhH.png?imageslim" alt="mark"></p>
<h2 id="机器学习"><a href="#机器学习" class="headerlink" title="机器学习"></a>机器学习</h2><p>机器学习是什么？Arthur Samuel在1959年将机器学习定义为在特定编程的情况下，给予计算机学习能力的领域。他编写了一个西洋棋程序让计算机自己不断下棋进而进行学习，最后棋艺大涨，远远超过了Samuel自己的水平。<br>来自卡内基梅隆大学的Tom Mitchell在1998年将机器学习定义为：一个程序被认为能够从经验E中学习，解决了任务T，达到性能度量值P，当且仅当有了经验E后经过P评判，程序在处理T时的性能有所提升。E也就是计算机自己不断学习，学会了如何解决问题T，并且达到了一定的成功率P。<br><a id="more"></a></p>
<p>目前存在几种不同类型的学习算法，主要的两种类型为监督学习(Supervised learning)以及无监督学习(Unsuoervised learning)。</p>
<h2 id="监督学习"><a href="#监督学习" class="headerlink" title="监督学习"></a>监督学习</h2><p>监督学习又叫回归问题，意指要预测一个连续值的输出，也可以用于分类问题预测，在监督学习中，数据集中的每个例子，算法将预测得到例子的“正确答案”，比如预测房价、肿瘤类型等。监督学习实际运用中我们需合理判断出我们要解决的问题是回归问题还是分类问题。</p>
<h2 id="无监督学习"><a href="#无监督学习" class="headerlink" title="无监督学习"></a>无监督学习</h2><p>监督学习中的数据集我们知道每一个数据代表的意思，比如房子多大对应房价多少，肿瘤多大对应是恶性肿瘤。但是在无监督学习中只有数据集，我们对这个数据集完全不了解，数据集中的数据没有属性或标签这一概念。也就是说数据集中的数据都是一样的没有区别。<br><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171225/IIla4J06b4.png?imageslim" alt="mark"></p>
<h2 id="比如上图中我们看到所有的数据都是一样的，没有属性与标签的区别，计算机通过无监督学习可能会将数据分成两类，也就是聚类。"><a href="#比如上图中我们看到所有的数据都是一样的，没有属性与标签的区别，计算机通过无监督学习可能会将数据分成两类，也就是聚类。" class="headerlink" title="比如上图中我们看到所有的数据都是一样的，没有属性与标签的区别，计算机通过无监督学习可能会将数据分成两类，也就是聚类。"></a>比如上图中我们看到所有的数据都是一样的，没有属性与标签的区别，计算机通过无监督学习可能会将数据分成两类，也就是聚类。</h2><h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/171225/929l1BKmhH.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;机器学习&quot;&gt;&lt;a href=&quot;#机器学习&quot; class=&quot;headerlink&quot; title=&quot;机器学习&quot;&gt;&lt;/a&gt;机器学习&lt;/h2&gt;&lt;p&gt;机器学习是什么？Arthur Samuel在1959年将机器学习定义为在特定编程的情况下，给予计算机学习能力的领域。他编写了一个西洋棋程序让计算机自己不断下棋进而进行学习，最后棋艺大涨，远远超过了Samuel自己的水平。&lt;br&gt;来自卡内基梅隆大学的Tom Mitchell在1998年将机器学习定义为：一个程序被认为能够从经验E中学习，解决了任务T，达到性能度量值P，当且仅当有了经验E后经过P评判，程序在处理T时的性能有所提升。E也就是计算机自己不断学习，学会了如何解决问题T，并且达到了一定的成功率P。&lt;br&gt;
    
    </summary>
    
      <category term="machine learning" scheme="https://ytlogos.github.io/categories/machine-learning/"/>
    
    
      <category term="机器学习" scheme="https://ytlogos.github.io/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>生物信息学学习笔记（六）</title>
    <link href="https://ytlogos.github.io/2017/12/24/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89/"/>
    <id>https://ytlogos.github.io/2017/12/24/生物信息学学习笔记（六）/</id>
    <published>2017-12-24T13:19:05.000Z</published>
    <updated>2017-12-25T11:15:14.542Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171210/JBeFfJL8KD.png?imageslim" alt="mark"></p>
<h2 id="Tajima’s-D值检验"><a href="#Tajima’s-D值检验" class="headerlink" title="Tajima’s D值检验"></a>Tajima’s D值检验</h2><p>Tajima’s D值检验的目的是鉴定目标DNA序列在进化过程中是否遵循中性进化模型。当Tajima’s D显著大于0时，可用于推断瓶颈效应和平衡选择，当Tajima’s D显著小于0时，可用于推断群体规模放大和定向选择。由于平衡选择和定向选择均属于正选择的范畴，因此只要D值显著背离0，就可能是自然选择的结果，当D值不显著背离0时，中性假说则不能被排除。<br>连锁不平衡程度高的染色体可能是由于在现代育种和栽培过程中那些与重要农艺性状相关的QTLs或基因被人工或自然选择保留下来，进而使得这些染色体受到强选择增强了其LD程度。另外LD的衰减距离也决定了关联分析所需要的标记密度和作图精度，LD衰减越快关联分析所需要的标记就越多，作图精度也越高。<br><a id="more"></a></p>
<h2 id="遗传渗透分析"><a href="#遗传渗透分析" class="headerlink" title="遗传渗透分析"></a>遗传渗透分析</h2><p>亚洲栽培油菜(主要是中国半冬性油菜)从欧洲引入亚洲之后导入了油菜亲本之一白菜的遗传成分，这样拓宽了半冬性油菜A亚基因组的遗传多样性，导致半冬性油菜在A亚基因组上的遗传距离增加，LD衰减加快。半冬性油菜在上世纪30-40年代从欧洲直接或间接通过日本引进中国之后正在经历群体扩张，而且这种扩张还在继续。甘蓝和油菜杂交是不亲和的，油菜在栽培驯化中A、C亚基因组间存在很强的基因流渗透现象。</p>
<h2 id="选择性消除分析"><a href="#选择性消除分析" class="headerlink" title="选择性消除分析"></a>选择性消除分析</h2><p>选择性消除(Selective sweep)是由于某一位点受到强选择后，其周围的位点的多态性因受该位点牵连而发生多态性降低的现象。也可以认为某个位点发生突变，突变后的位点因对物种在特定的情况下有利或者受到了人为选择，那么该突变位点在群体中的频率必然提高，但是其附近和它处在同一单体型或者block的其它位点同样跟着受到了选择，频率发生了提高，也就是单体型内的其它多态位点的某一多态形式比率大大提高，从而降低了整个周围区域的多态性。</p>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/171210/JBeFfJL8KD.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Tajima’s-D值检验&quot;&gt;&lt;a href=&quot;#Tajima’s-D值检验&quot; class=&quot;headerlink&quot; title=&quot;Tajima’s D值检验&quot;&gt;&lt;/a&gt;Tajima’s D值检验&lt;/h2&gt;&lt;p&gt;Tajima’s D值检验的目的是鉴定目标DNA序列在进化过程中是否遵循中性进化模型。当Tajima’s D显著大于0时，可用于推断瓶颈效应和平衡选择，当Tajima’s D显著小于0时，可用于推断群体规模放大和定向选择。由于平衡选择和定向选择均属于正选择的范畴，因此只要D值显著背离0，就可能是自然选择的结果，当D值不显著背离0时，中性假说则不能被排除。&lt;br&gt;连锁不平衡程度高的染色体可能是由于在现代育种和栽培过程中那些与重要农艺性状相关的QTLs或基因被人工或自然选择保留下来，进而使得这些染色体受到强选择增强了其LD程度。另外LD的衰减距离也决定了关联分析所需要的标记密度和作图精度，LD衰减越快关联分析所需要的标记就越多，作图精度也越高。&lt;br&gt;
    
    </summary>
    
      <category term="bioinformatics" scheme="https://ytlogos.github.io/categories/bioinformatics/"/>
    
    
      <category term="evolution" scheme="https://ytlogos.github.io/tags/evolution/"/>
    
  </entry>
  
  <entry>
    <title>图形组合R包patchwork</title>
    <link href="https://ytlogos.github.io/2017/12/18/R%E8%AF%AD%E8%A8%80%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8B%E5%9B%BE%E5%BD%A2%E7%BB%84%E5%90%88R%E5%8C%85patchwork/"/>
    <id>https://ytlogos.github.io/2017/12/18/R语言可视化之图形组合R包patchwork/</id>
    <published>2017-12-18T08:47:05.000Z</published>
    <updated>2017-12-18T10:41:24.688Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171218/9dEjEbJ8kI.png?imageslim" alt="mark"></p>
<p>平常我们绘制图形的时候常常要将几幅图形组合在一起，有很多R包可以用于图形组合，经典的是<strong>gridExtra</strong>，还有<strong>egg</strong>。今天介绍一个新包<a href="https://github.com/thomasp85/patchwork" target="_blank" rel="external"><strong>patchwork</strong></a><br><a id="more"></a></p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># install.packages(&quot;devtools&quot;)</div><div class="line">devtools::install_github(&quot;thomasp85/patchwork&quot;)</div></pre></td></tr></table></figure>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p><strong>patchwork</strong>的使用非常简单，就是利用<strong>+</strong>将图形组合起来。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">library(ggplot2)</div><div class="line">library(patchwork)</div><div class="line">p1 &lt;- ggplot(mtcars)+geom_point(aes(mpg, disp))</div><div class="line">p2 &lt;- ggplot(mtcars)+geom_boxplot(aes(gear, disp, group=gear))</div><div class="line"># Combine these two plots together</div><div class="line">p1+p2</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171218/7Dd5CG5fgB.png?imageslim" alt="mark"></p>
<h2 id="布局"><a href="#布局" class="headerlink" title="布局"></a>布局</h2><p><strong>patchwork</strong>提供了一个专门用于图形布局的函数<code>plot_layout()</code>，这样我们就可以自定义布局的行列数了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p1+p2+plot_layout(ncol = 1, heights = c(3,1))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171218/aa0KGc5l3f.png?imageslim" alt="mark"></p>
<p>如果需要在组合的图形之间留点空间，使用<code>plot_spacer()</code>就行了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p1+plot_spacer()+p2</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171218/H2hD8BcCk4.png?imageslim" alt="mark"></p>
<p>还可以将不同图形用{}封装，这样可以实现双重布局<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">p3 &lt;- ggplot(mtcars)+geom_smooth(aes(disp, qsec))</div><div class="line">p4 &lt;- ggplot(mtcars)+geom_bar(aes(carb))</div><div class="line"># nested plots layout</div><div class="line">p4+&#123;</div><div class="line">  p1+&#123;</div><div class="line">    p2+</div><div class="line">      p3+</div><div class="line">      plot_layout(ncol = 1)</div><div class="line">  &#125;</div><div class="line">&#125;+</div><div class="line">  plot_layout(ncol = 1)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171218/cG64Jhh0IB.png?imageslim" alt="mark"></p>
<h2 id="高级参数"><a href="#高级参数" class="headerlink" title="高级参数"></a>高级参数</h2><p><strong>patchwork</strong>还提供了一些高级参数，比如<code>/</code>,<code>/</code>类似于操作符<code>+</code>，但是它可以将不同plots至于同一个nesting水平，具体如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># first we use + to add plots and layout</div><div class="line">(p1+p2)+p3+plot_layout(ncol = 1)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171218/EKbJdE82IK.png?imageslim" alt="mark"></p>
<p>可以看出p1+p2组合之后并没有处于同一nesting水平<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># then we use /</div><div class="line">(p1+p2)/p3 + plot_layout(ncol = 1)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171218/7HL49dJ1EI.png?imageslim" alt="mark"><br>此时p1+p2先组合在同一水平再与p3组合</p>
<p>另外再介绍两个操作符：<code>*</code>和<code>^</code><br>这两个有点类似于正则表达式里的通配符了，主要是为了减轻代码量。比如如果我们需要修改所有plots的背景，就没必要每个plot都修改一遍了。这两个操作符的主要区别是<code>*</code>只改变处于当前nesting水平的所有plots，<code>^</code>则修改所有plots，具体如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(p1+(p2+p3)+p4+plot_layout(ncol = 1))*theme_bw()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171218/KCjBgd0KHg.png?imageslim" alt="mark"></p>
<p>可以看到这里只修改了p1和p4的背景主题，(p2+p3)没有修改</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(p1+(p2+p3)+p4+plot_layout(ncol = 1))^theme_bw()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171218/CFGBjB6GLK.png?imageslim" alt="mark"></p>
<p>这里所有的plots的主题背景都被修改了。<br>目前这个包还处于开发阶段，将来还有很多功能会被加进去，我们拭目以待吧</p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">## [1] patchwork_0.0.1    ggplot2_2.2.1.9000</div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.14      digest_0.6.13     rprojroot_1.2    </div><div class="line">##  [4] plyr_1.8.4        grid_3.4.3        gtable_0.2.0     </div><div class="line">##  [7] backports_1.1.2   magrittr_1.5      evaluate_0.10.1  </div><div class="line">## [10] scales_0.5.0.9000 rlang_0.1.4       stringi_1.1.6    </div><div class="line">## [13] lazyeval_0.2.1    rmarkdown_1.8     labeling_0.3     </div><div class="line">## [16] tools_3.4.3       stringr_1.2.0     munsell_0.4.3    </div><div class="line">## [19] yaml_2.1.16       compiler_3.4.3    colorspace_1.3-2 </div><div class="line">## [22] htmltools_0.3.6   knitr_1.17        tibble_1.3.4</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/171218/9dEjEbJ8kI.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;平常我们绘制图形的时候常常要将几幅图形组合在一起，有很多R包可以用于图形组合，经典的是&lt;strong&gt;gridExtra&lt;/strong&gt;，还有&lt;strong&gt;egg&lt;/strong&gt;。今天介绍一个新包&lt;a href=&quot;https://github.com/thomasp85/patchwork&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;strong&gt;patchwork&lt;/strong&gt;&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="图形组合" scheme="https://ytlogos.github.io/tags/%E5%9B%BE%E5%BD%A2%E7%BB%84%E5%90%88/"/>
    
      <category term="patchwork" scheme="https://ytlogos.github.io/tags/patchwork/"/>
    
  </entry>
  
  <entry>
    <title>生物信息学学习笔记（五）</title>
    <link href="https://ytlogos.github.io/2017/12/09/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%94%EF%BC%89/"/>
    <id>https://ytlogos.github.io/2017/12/09/生物信息学学习笔记（五）/</id>
    <published>2017-12-09T13:19:05.000Z</published>
    <updated>2017-12-09T14:02:17.491Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171208/mLaH1fIKh6.png?imageslim" alt="mark"></p>
<h2 id="全基因组水平的连锁不平衡-LD-和遗传结构分析"><a href="#全基因组水平的连锁不平衡-LD-和遗传结构分析" class="headerlink" title="全基因组水平的连锁不平衡(LD)和遗传结构分析"></a>全基因组水平的连锁不平衡(LD)和遗传结构分析</h2><p>当r<sup>2</sup>=0.1时，A亚基因组的衰退距离为0.35-0.4Mb，而C亚基因组的衰退距离为3.5-4Mb，说明甘蓝型油菜A亚基因组发生了更多的重组，使得衰退距离显著小于C亚基因组。重组的发生会打破LD，将那些容易发生重组，LD相对较低的区域称为LD热点，反之称为LD冷点。通过全基因水平的LD热点和冷点研究发现，78.16%的LD热点分布在A亚基因组而72.59%的LD冷点分布在C亚基因组。另外LD热点区间的基因密度是冷点区间的2倍多，GC含量也多于冷点区间，但是冷点区间内含有更多的转座子，这和LD反映的结果一致，说明了甘蓝型油菜A亚基因组的遗传变异更加丰富。<br><a id="more"></a></p>
<h2 id="关联分析的基础——连锁不平衡"><a href="#关联分析的基础——连锁不平衡" class="headerlink" title="关联分析的基础——连锁不平衡"></a>关联分析的基础——连锁不平衡</h2><p>生物在进化过程中，对于某一特定基因座，在自然和人工选择、重组与突变、遗传漂变、群体扩张和瓶颈效应等因素的影响下，某一“有利”变异（或等位基因）在正向选择的过程中被保留下来，与该基因座紧密连锁的两侧一定范围内的序列也会随着该“有利”等位基因的固定而被大量保留下来，从而使其遗传多样性大大降低，遗传学上将这种个别基因的正向选择致使其侧翼遗传多样性降低的现象称为选择牵连效应或者选择性消除。由于基因座间的选择牵连效应，使群体内个体在不同位点、基因间发生非随机性关联，即连锁不平衡，又称等位基因关联。它包括染色体内和染色体间的连锁不平衡，前者是关联分析的基础，具体指当位于同一染色体的两对等位基因同时存在的概率大于群体内因随机分布而同时出现的概率时，就称这两个位点处于LD状态。<br>连锁不平衡并不等同于遗传连锁，它们之间相辅相成，连锁不平衡是指在两个或者多个位点上的非随机关联性，这些位点既可能在同一条染色体上，也可以在不同染色体上，只要两个位点同时出现的概率大于群体随机组合的概率就说明这两个位点处于连锁不平衡状态，而遗传连锁主要考虑的是重组率，连锁的基因在染色体上的位点相距越远，他们之间发生交换的几率就越大，重组率就越高，连锁就越弱。当然两个位点处于完全连锁状态其等位基因间也存在较强的连锁不平衡。</p>
<h2 id="LD的原理及度量"><a href="#LD的原理及度量" class="headerlink" title="LD的原理及度量"></a>LD的原理及度量</h2><p>LD的统计是实际观测到的单倍型的频率与随机分离时期单倍型的频率之间的差异(D)。LD的度量一般是对D进行归一化后，用LD系数D’和r<sup>2</sup>进行检验，其中D’(AB)=D(AB)/(fA*fB),r<sup>2</sup>(AB)=D<sup>2</sup>(AB)/(fA*fa*fB*fb)，这里D’和r<sup>2</sup>的变化范围都是从0到1。LD反映样本的重组史，敏感度更高，适合小样本的研究，而r<sup>2</sup>除了能反映样本的重组史还能反映突变史，所以r<sup>2</sup>更能客观地反映不同基因间的连锁不平衡关系</p>
<h2 id="LD的影响因素"><a href="#LD的影响因素" class="headerlink" title="LD的影响因素"></a>LD的影响因素</h2><p>LD是由突变或重组造成的，在染色体某一SNP附近有新的突变发生时则LD出现。LD强度与2个SNP间的距离有关，距离越小则发生重组的机会越小，LD就越强。所以LD重度与重组率和突变率均呈反比；另外遗传漂变(群体较小，导致群体中基因频率随机波动的现象)和奠基者效应(是一种剧烈的漂变，指一个小群体从一个大群体中分离出来并逐渐发展壮大的现象)都会增强LD，基因突变可导致野生等位基因之间LD水平的降低，也可导致突变等位基因之间LD水平的提高。<br>LD的衰减指位点之间由连锁不平衡到连锁平衡的演变过程，能够很好的反映LD程度。自花授粉植物的重组率要普遍低于异花授粉植物，所以异花授粉植物的LD衰减距离就要大些，常染色质组成的着丝粒区域的LD的衰减速度快于由异染色质组成的各个染色体臂，基因富集的区域的LD衰减比较快。</p>
<ul>
<li>植物中影响LD的因素</li>
</ul>
<table>
<thead>
<tr>
<th>因素</th>
<th>对LD的影响</th>
</tr>
</thead>
<tbody>
<tr>
<td>授粉方式</td>
<td>自交植物有效重组数少于异交植物，LD衰减慢</td>
</tr>
<tr>
<td>染色体位置</td>
<td>异染色质区交换少于常染色质区，LD衰减慢</td>
</tr>
<tr>
<td>基因区</td>
<td>基因富集区，LD衰减快</td>
</tr>
<tr>
<td>瓶颈效应</td>
<td>有效群体数目减少，增加LD</td>
</tr>
<tr>
<td>遗传漂变</td>
<td>增加LD</td>
</tr>
<tr>
<td>奠基者效应</td>
<td>增加LD</td>
</tr>
<tr>
<td>群体分化</td>
<td>增加LD</td>
</tr>
<tr>
<td>群体大小</td>
<td>小群体，增加LD</td>
</tr>
<tr>
<td>选择</td>
<td>增加受选择区段的LD</td>
</tr>
<tr>
<td>突变</td>
<td>造成LD总体水平的降低，但新产生突变的染色体位置LD水平升高</td>
</tr>
<tr>
<td>基因转换</td>
<td>降低LD</td>
</tr>
<tr>
<td>等位基因频率</td>
<td>最小等位基因频率增加，增加LD</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/171208/mLaH1fIKh6.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;全基因组水平的连锁不平衡-LD-和遗传结构分析&quot;&gt;&lt;a href=&quot;#全基因组水平的连锁不平衡-LD-和遗传结构分析&quot; class=&quot;headerlink&quot; title=&quot;全基因组水平的连锁不平衡(LD)和遗传结构分析&quot;&gt;&lt;/a&gt;全基因组水平的连锁不平衡(LD)和遗传结构分析&lt;/h2&gt;&lt;p&gt;当r&lt;sup&gt;2&lt;/sup&gt;=0.1时，A亚基因组的衰退距离为0.35-0.4Mb，而C亚基因组的衰退距离为3.5-4Mb，说明甘蓝型油菜A亚基因组发生了更多的重组，使得衰退距离显著小于C亚基因组。重组的发生会打破LD，将那些容易发生重组，LD相对较低的区域称为LD热点，反之称为LD冷点。通过全基因水平的LD热点和冷点研究发现，78.16%的LD热点分布在A亚基因组而72.59%的LD冷点分布在C亚基因组。另外LD热点区间的基因密度是冷点区间的2倍多，GC含量也多于冷点区间，但是冷点区间内含有更多的转座子，这和LD反映的结果一致，说明了甘蓝型油菜A亚基因组的遗传变异更加丰富。&lt;br&gt;
    
    </summary>
    
      <category term="bioinformatics" scheme="https://ytlogos.github.io/categories/bioinformatics/"/>
    
    
      <category term="LD" scheme="https://ytlogos.github.io/tags/LD/"/>
    
  </entry>
  
  <entry>
    <title>生物信息学学习笔记（四）</title>
    <link href="https://ytlogos.github.io/2017/12/06/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/"/>
    <id>https://ytlogos.github.io/2017/12/06/生物信息学学习笔记（四）/</id>
    <published>2017-12-06T13:19:05.000Z</published>
    <updated>2017-12-06T14:06:51.094Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171204/lGak1jll4j.png?imageslim" alt="mark"></p>
<p>最近看了华中农业大学张献龙老师发在<strong>Nature Genetics</strong>上的文章<a href="https://www.nature.com/articles/ng.3807" target="_blank" rel="external">Asymmetric subgenome selection and cis-regulatory divergence during cotton domestication</a>以及第一作者王茂军博士的博士毕业论文，十分精彩，故学习之并做适当笔记。<br><a id="more"></a></p>
<ul>
<li>通过分析四倍体棉花At和Dt亚组同源基因甲基化和表达量之间的关系，推测不同亚组基因的表观修饰差异可能是基因偏向性表达的原因之一</li>
<li><p>部分名词解释：</p>
<ul>
<li>H3K27me3：组蛋白H3上第27位赖氨酸三甲基化</li>
<li>H3K4me1：组蛋白H3上第4位赖氨酸一甲基化</li>
<li>H3K4me3：组蛋白H3上第4位赖氨酸三甲基化</li>
<li>H3K9me2：组蛋白H3上第9位赖氨酸二甲基化</li>
</ul>
</li>
<li><p>不同作物基因组大小差异非常大，这主要是由于重复序列和转座子的插入与丢失造成的。对于二倍体来说，不同作物基因数量与基因组大小并不显著相关，基因数量一般在3万到4万之间</p>
</li>
<li>不同作物生物学特性与其对应的基因的扩增与丢失，基因表达的差异有关</li>
<li>同一作物的不同材料之间基因组序列变异非常大，因此需要测序群体基因组去研究</li>
<li>DNA甲基化是一种重要的表观调控机制。在植物中发生在胞嘧啶上的DNA甲基化主要存在三种形式：对称形式的CG，CHG和非对称形式的CHH(H=A,T或者C)</li>
<li>植物种DNA甲基化主要发生在转座子区域和其他高度重复序列区域</li>
<li>组蛋白修饰是另外一种非常重要的表观遗传修饰，参与异染色质区域转座子的失活调控，同时调控植物发育和环境响应相关途径。组蛋白甲基化存在于赖氨酸和精氨酸上，通过依赖组蛋白赖氨酸甲基转移酶和精氨酸甲基转移酶建立，这些酶都被称为写入器，组蛋白甲基化之后能够被特定蛋白识别，然后参与不同生物学过程的调控，这些识别蛋白被称为阅读器。组蛋白甲基化的存在是动态的，可以被一些蛋白清除，这些蛋白被称为清除器</li>
<li>DNA甲基化和组蛋白修饰在基因上的分布和对基因表达的影响<br><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171205/Cbb3BIfc95.png?imageslim" alt="mark"></li>
<li>利用DNase Ⅰ酶切染色质并收集酶切片段进行测序(DNase-Seq),可以高通量鉴定顺式调控元件。DNase-Seq可以用于鉴定DNase Ⅰ酶切超敏感位点，这些位点通常对应顺式调控元件。DNase Ⅰ酶切位点不是均匀的，被转录因子结合的位点会阻止酶切，这些位点的酶切效率很低。通过分析DNase Ⅰ酶切足迹，可以在单核苷酸水平鉴定转录因子结合位点</li>
<li>顺式作用元件调控基因转录的模式图</li>
</ul>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171205/643Bk42CEm.png?imageslim" alt="mark"></p>
<p>除了启动子区域外，增强子是另外一种重要的顺势调控元件。DNase-Seq鉴定的DHS包含大量增强子区域，增强子能够招募装录因子，从而促进靶标基因的表达，这种作用常常以细胞特异或组织特异的形式存在。增强子的作用与靶标基因的物理位置和方向关系较小，因此增强子元件可以位于基因组的不同位置。</p>
<ul>
<li>基因表达的可变剪接是在pri-mRNA水平进行的能增强蛋白多样性的一种机制。可变剪接事件可以分为五种基本类型，包含内含子保留(IR)，外显子跳跃(ES),可变供体(AD)，可变受体(AA)和可变位置(AP)，其中IR在植物中占据绝大部分</li>
<li>祖先染色体构建</li>
</ul>
<p>为了分析驯化选择在不同亚基因祖上的差异性，构建棉花的At和Dt亚组的祖先染色体。因为两个亚组的基因组大小差异巨大，在构建祖先染色体的时候，只使用了共线性区段的基因对。共线性区段是通过MCScanX软件鉴定出来的，规定最小共线性区段必须包括5个基因。同时将两个亚组的基因做相互blastp分析，保留最好的匹配结果。结合共线性区段和blastp的结果，得到最终的亚组之间的同源基因。这些同源基因必须同时被这两种方法检测。提取这些同源基因上下游2kb的区段与基因区域一起构建祖先染色体。祖先染色体上的基因顺序依据于Dt亚基因祖上的基因排列顺序</p>
<ul>
<li>可以通过DNase-Seq测序鉴定棉花基因组上的顺式调控元件主要是根据顺式调控元件通常位于开放的染色质区域，很容易被核酸酶切</li>
</ul>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/171204/lGak1jll4j.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;最近看了华中农业大学张献龙老师发在&lt;strong&gt;Nature Genetics&lt;/strong&gt;上的文章&lt;a href=&quot;https://www.nature.com/articles/ng.3807&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Asymmetric subgenome selection and cis-regulatory divergence during cotton domestication&lt;/a&gt;以及第一作者王茂军博士的博士毕业论文，十分精彩，故学习之并做适当笔记。&lt;br&gt;
    
    </summary>
    
      <category term="bioinformatics" scheme="https://ytlogos.github.io/categories/bioinformatics/"/>
    
    
      <category term="Hi-C" scheme="https://ytlogos.github.io/tags/Hi-C/"/>
    
      <category term="DHSs" scheme="https://ytlogos.github.io/tags/DHSs/"/>
    
  </entry>
  
  <entry>
    <title>生物信息学学习笔记（三）</title>
    <link href="https://ytlogos.github.io/2017/12/04/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/"/>
    <id>https://ytlogos.github.io/2017/12/04/生物信息学学习笔记（三）/</id>
    <published>2017-12-04T13:19:05.000Z</published>
    <updated>2017-12-04T11:23:45.031Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171203/eeCi4f49Ag.png?imageslim" alt="mark"></p>
<ul>
<li>CpG位点(CpG sites，CG位点)：指DNA的某个区域，其上的碱基序列以胞嘧啶接着鸟嘌呤出现。CpG是“—C—磷酸—G—”的缩写，指磷酸二脂键连接了胞嘧啶和鸟嘌呤，其中C位于5’端而G位于3’端。在CpG位点中的胞嘧啶可以被甲基化为5-甲基胞嘧啶，基因内CpG位点的甲基化会改变基因的表达<a id="more"></a>
</li>
</ul>
<h2 id="顺式调控元件"><a href="#顺式调控元件" class="headerlink" title="顺式调控元件"></a>顺式调控元件</h2><ul>
<li>启动子(promoter)：指导RNA聚合酶并起始DNA转录的一段DNA序列，该序列往往位于编码基因的上游，可以调控目标基因表达的程度、时间和组织等。通常核心启动子都具有一些特征序列，这些特征序列称为基序(motif),常见的基序有TATA盒(TATA box)等。</li>
<li>增强子和沉默子：指DNA分子上可以与特定蛋白相结合从而正向或负向调控基因表达的顺式作用元件。其中增强子与蛋白结合之后，基因的转录水平会增强，其位置可以位于启动子上游、基因内、基因下游或基因区间，甚至于被调控基因不在同一条染色体上，这是由于增强子主要依靠空间作用来调控基因表达。</li>
<li><p>绝缘子：绝缘子是一种长程调控元件，主要有两类。第一类主要功能是阻遏邻近的调控元件如增强子。绝缘子发挥功能时具有方向性，其可以阻断增强子与启动子的作用，从而导致增强子的目标基因表达下调。第二类是异染色质的边界原件。由于异染色质包装折叠较常染色体显得更加紧密，异染色质中的基因很少表达，而第二类绝缘子可以在异染色质的边界阻断异染色质结构的延伸，保证边界另一侧的基因表达不受影响。<br><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171130/j7HbHF03CH.png?imageslim" alt="顺式作用元件"></p>
</li>
<li><p>转录水平的调控是真核基因表达调控的关键环节，染色质对DNase Ⅰ的敏感性与基因转录有关。基因活化使其染色质一呈开放的疏松型构象，更易被DNase Ⅰ降解，形成DNase Ⅰ超敏感位点(DNase Ⅰ hypersensitive site，DHSs).DHSs不仅与染色质的开放度相关，还与启动子、增强子、绝缘子以及沉默子等元件相偶联，并且染色质上具有调控功能的DNA序列、调控蛋白结合位点也与DHSs重叠</p>
</li>
<li>DHSs是一段跨度为数百碱基对，甲基化程度较低，对DNase Ⅰ具有高度敏感性的染色质区域，可富集转录因子和重要酶类，具有转录调控功能</li>
<li>染色质由一系列盘绕着DNA的核小体组成，转录因子在与基因结合时，取代了核小体的位置，baoluchuDNA，使其对DNase Ⅰ的切割更为敏感，在此基础上，利用染色质对DNase Ⅰ的敏感性鉴定活化的调控序列</li>
<li>DNase-seq方案包括用DNase Ⅰ优先切割核小体被取代的DNA序列，对生成的短片段进行测序并将其定位到基因组上以鉴定对敏感酶的“染色质开放”区域。一些转录因子的结合位点显示出高度特异性的DNase Ⅰ剪切模式。这种“Dnase 足迹”常被用来检测特定转录因子的结合</li>
<li>ATAC-seq(assay for transposase-accesiible chromatin using sequencing)：通过Tn5转座酶优先标记和测序核小体之间的DNA。类似于DNase-seq，但是步骤更为简单，所需细胞也更少</li>
<li>对DNase-seq片段进行双端测序，发现短片段主要源自于核小体之间的区域，而长片段跨越了核小体。研究指出短片段对鉴定转录因子的结合更有用，长片段可以提供核小体的间隔信息</li>
<li>研究人员发现由于DNase Ⅰ和Tn5的切割偏好性，之前许多Dnase印记分析反映的更多是切割偏好而不是转录因子的真实结合情况。</li>
</ul>
<h2 id="3D基因组"><a href="#3D基因组" class="headerlink" title="3D基因组"></a>3D基因组</h2><ul>
<li>不同染色质在细胞核内的分布不是杂乱无章的，而是被限定在特定的“疆域”内，基因相对密集的染色质通常分布在远离核膜的位置，而基因稀疏的染色质则分布在靠近核膜的位置。在基因组上分离的染色质区段在空间上可能被拉到一起共同被转录，形成“转录工厂”</li>
<li>基因组区室是指存在于染色质上的相互间隔的连续区域，通常这些区域大小为1~10Mb，每个区域内的点具有相似的全基因组交互模式，根据交互模式的差异，这些区域可以分为两类：A类区室和B类区室。相同类型的区室具有相似的全基因组交互模式，其交互频率要显著高于不同类型区室之间的交互。A类区室往往代表基因富集的常染色质区域，B类区室则对应着基因稀疏的异染色质区域</li>
<li>拓扑相关结构域(TAD)则是位于高等动物染色质的更精细的结构单元，TAD被定义为这样一块块连续的染色质区域，区域内部互作强度要显著强于区域之间的互作。每个TAD通常只有200Kb~1Mb。</li>
<li>染色质位点的相互作用存在某种固有的模式，而这些模式与特定生物学过程/功能是无关的</li>
</ul>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/171203/eeCi4f49Ag.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CpG位点(CpG sites，CG位点)：指DNA的某个区域，其上的碱基序列以胞嘧啶接着鸟嘌呤出现。CpG是“—C—磷酸—G—”的缩写，指磷酸二脂键连接了胞嘧啶和鸟嘌呤，其中C位于5’端而G位于3’端。在CpG位点中的胞嘧啶可以被甲基化为5-甲基胞嘧啶，基因内CpG位点的甲基化会改变基因的表达
    
    </summary>
    
      <category term="bioinformatics" scheme="https://ytlogos.github.io/categories/bioinformatics/"/>
    
    
      <category term="Hi-C" scheme="https://ytlogos.github.io/tags/Hi-C/"/>
    
      <category term="DHSs" scheme="https://ytlogos.github.io/tags/DHSs/"/>
    
  </entry>
  
  <entry>
    <title>生物信息学学习笔记（二）</title>
    <link href="https://ytlogos.github.io/2017/11/29/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <id>https://ytlogos.github.io/2017/11/29/生物信息学学习笔记（二）/</id>
    <published>2017-11-29T13:19:05.000Z</published>
    <updated>2017-11-29T12:05:48.985Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171129/dlGEdblL4H.png?imageslim" alt="mark"></p>
<h2 id="Hi-C"><a href="#Hi-C" class="headerlink" title="Hi-C"></a>Hi-C</h2><ul>
<li>拓扑相关结构域(TAD)是基因组上空间上分隔的一些DNA序列，TAD平均长度在1M左右，其中包含一个或数个基因以及基因的调控元件——增强子(enhancer)。增强子不仅控制基因的表达时间还控制基因在不同细胞中的选择性表达。TAD由边界原件(boundary elements，也称为绝缘子)相互隔离，因此TAD内部的基因活性独立于其它TAD</li>
</ul>
<a id="more"></a>
<h2 id="群体进化"><a href="#群体进化" class="headerlink" title="群体进化"></a>群体进化</h2><p>今天逛<a href="http://biotrainee.com/forum.php/" target="_blank" rel="external">生信技能树</a>的时候发现了<strong>ydchen</strong>写的一篇关于群体进化名词解释的<a href="http://www.biotrainee.com:8080/thread-321-1-1.html" target="_blank" rel="external">帖子</a>，写的很不错，所以我这里就copy一下了。要想生信学得好，还得多逛<a href="http://biotrainee.com/forum.php/" target="_blank" rel="external">生信技能树</a></p>
<ul>
<li>等位基因频率：在一个群体中某类等位基因占该基因位点上全部等位基因数的比率</li>
<li>基因型频率：群体中某一基因型个体占群体总个数的比例。可以反映某一基因型个体在群体中的相对数量</li>
<li>群体：指生活在一定空间范围内，能够互相交配并生育具有正常生殖能力后代的同种个体群</li>
<li>遗传平衡定律(又称为哈迪·温伯格定律)：一个不发生突变、迁移和选择的无限大的相互交配的群体中，群体的基因频率和基因型频率将逐代保持不变</li>
<li>适合度：指一个个体能够生存并将基因传给下一代的能力，可用相同环境中不同个体的相对生育率来衡量</li>
<li>突变压力：一定条件下，一个群体的突变率可明显增加形成突变压力，使某个基因频率增高</li>
<li>选择压力：受某种环境条件的影响，某些突变型被选择所作用，使突变基因的频率降低</li>
<li>选择系数：指在选择作用下降低的适合度</li>
<li>群体分层：指群体内存在亚群的现象，亚群内部个体间的相互关系大于整个群体内部个体间的平均亲缘关系</li>
<li>核苷酸多态性(π)：衡量特定群体多态性高低的参数，是指在同一群体中随机挑选的两条DNA序列在各个核苷酸位点上变异的均值。π值越大说明其对应的亚群多态性越高</li>
<li>群体间固定指数(Fst)：衡量群体中等位基因频率是否偏离遗传平衡论比例的指标，用来研究不同群体间的分化程度。其取值为0到1，0代表两个群体未分化，其成员间是完全随机交配的；1代表两个群体完全分化，形成物种隔离，且无共同的多样性存在</li>
<li>θw：Watterson’s 多态性估值，从理论上讲，在中性条件下应当有θw=4Neμ的平衡状态，Ne表示有效群体大小，μ表示每一代的序列突变率</li>
<li>连锁不平衡：相邻位点间的非随机关联，当一个位点上的某一等位基因与另一位点上的某一等位基因共同出现的概率大于随机组合的概率，则这两个位点存在连锁不平衡</li>
<li>瓶颈效应：由于环境骤变(如火灾、地震、洪水等)或者人类活动(如人工选择、驯化)，使得某一生物种群的规模迅速较少，仅有一小部分个体能够顺利通过瓶颈事件，在之后的恢复期内产生大量后代</li>
<li>随机遗传漂变：当一个种群中的生物个体的数量较少时，下一代的个体容易因为有的个体没有产生后代，或是有的等位基因没有传给后代，而和上一代有不同的等位基因频率。一个等位基因可能(在经过一个以上的世代后)因此在这个群体中消失或者固定成为唯一的等位基因。这种现象就是随机遗传漂变</li>
<li>奠基者效应：有少数个体的基因频率决定了他们后代中的基因频率的效应，是一种极端的遗传漂变作用</li>
<li>迁移压力(又称为基因流)：由于某种原因，具有某一基因频率的群体的一部分移入基因频率与其不同的群体中并杂交定居，就会引起迁入群体的基因频率发生改变</li>
<li>有效群体大小：指与实际群体具有相同的基因频率方差或相同杂合度衰减率的理想群体大小，它反映了群体平均近交系数增量的大小以及群体遗传结构中基因的平均纯度</li>
<li>中性学说：认为分子水平上的大多数突变是中性的或近中性的，自然选择对它们不起作用，这些突变靠一代又一代的随机漂变而被保存或趋于消失，从而形成分子水平上的进化性变化或种内变异</li>
<li>Tajima’s D值检验：在原有的平衡状态中θT=θW=4Neμ，所以D值为0，但是如果群体中存在许多低频率的等位基因(稀有等位基因)，使θT&lt;θW，则D<0。相反，当群体中是中等频率的等位基因占主导时，θt>θW，D&gt;0。Tajima把过多低频率等位基因的存在归咎为定向选择时，选择性消除会削弱原有等位基因在群体中的频率，而是新等位基因以低频率补充进来成为稀有等位基因。相反，如果中等频率等位基因占主导，则可能是平衡选择的结果，或者是种群大小在经历瓶颈效应时使稀有等位基因丢失。因此当Tajima’s D显著大于0时，可用于推断瓶颈效应和平衡选择；Tajima’s D显著小于0时，可用于推断群体规模放大和定向选择。由于平衡选择和正向选择都属于正选择的范畴，因此只要D值显著偏离0就可能是自然选择的结果，而当D值不显著偏离0时则中性零假说不能被排除</0。相反，当群体中是中等频率的等位基因占主导时，θt></li>
<li>正选择：自然选择“选留”一些稀少的等位基因，拥有这些等位基因的个体能繁殖更多的后代，这样的突变基因往往具有与原来基因不同的功能，而且该功能使得拥有它的生物更能适应环境</li>
<li>负选择：自然选择淘汰一些稀少的等位基因，拥有这些等位基因的个体不能繁殖或者繁殖很少的后代，这些基因往往丧失了功能</li>
<li>平衡选择：是一种关于自然选择保持种群内遗传多态性的假说，是在一些等位基因上杂合的基因型的系列，这些等位基因的纯合体仅在正常的杂交群体中少量个体中存在，并且在适合度上低于杂合体，然后将会出现有利于在许多座位上发展复等位基因系列的选择压力</li>
<li>正向选择：是指生存环境中的方向性选择(自然选择)或品种的人工定向选择</li>
<li>选择性消除：指由于最近较强的正向自然选择，一个突变位点相邻DNA上的核苷酸之间的差异性下降或消除</li>
<li>微进化：群体在世代过程中等位基因频率的变化，成为微进化即发生在物种内的遗传变化</li>
<li>大进化：从现有物种中产生新物种的过程，是微进化扩展、累积的结果</li>
<li>趋同进化：在突变和选择的作用下，不同物种间具有趋同进化的趋势，这种现象称为趋同进化</li>
<li>遗传负荷：如果一个群体的突变不断积累，并且这些突变是有害的，就会出现适合度下降。这种现象称为遗传负荷</li>
</ul>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/171129/dlGEdblL4H.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Hi-C&quot;&gt;&lt;a href=&quot;#Hi-C&quot; class=&quot;headerlink&quot; title=&quot;Hi-C&quot;&gt;&lt;/a&gt;Hi-C&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;拓扑相关结构域(TAD)是基因组上空间上分隔的一些DNA序列，TAD平均长度在1M左右，其中包含一个或数个基因以及基因的调控元件——增强子(enhancer)。增强子不仅控制基因的表达时间还控制基因在不同细胞中的选择性表达。TAD由边界原件(boundary elements，也称为绝缘子)相互隔离，因此TAD内部的基因活性独立于其它TAD&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="bioinformatics" scheme="https://ytlogos.github.io/categories/bioinformatics/"/>
    
    
      <category term="evolution" scheme="https://ytlogos.github.io/tags/evolution/"/>
    
      <category term="Hi-C" scheme="https://ytlogos.github.io/tags/Hi-C/"/>
    
  </entry>
  
  <entry>
    <title>生物信息学学习笔记（一）</title>
    <link href="https://ytlogos.github.io/2017/11/28/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <id>https://ytlogos.github.io/2017/11/28/生物信息学学习笔记（一）/</id>
    <published>2017-11-28T13:19:05.000Z</published>
    <updated>2017-11-28T13:31:46.880Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/171128/D6l28BlfFI.png?imageslim" alt="mark"></p>
<p>生物信息学学习笔记主要是我平常看文献以及一些资料时总结的一些东西，相对来说有点杂，所以我专门开辟出一个新的系列，以便后面可以持续更新。</p>
<a id="more"></a>
<ul>
<li><p>sequence logos方法利用每个位置的高度来表示其保守程度，这样特征高度就反映了相对的变化频率，比如说一个consensus sequence位置上可能是C或者T，sequence logos上C的高度代表了其出现的频率。</p>
</li>
<li><p>改良品种中LD显著增加，这是驯化正向选择的结果，栽培品种的π值、w值相比于野生种明显降低</p>
</li>
<li><p>顺式(cis-)指的是“分子内”，也就是说顺式作用就是自己作用于自己，就像顺式作用元件就是一段DNA序列作用于自己的临近序列，调节它的表达，比如我们常说的增强子、沉默子等。反式(tran-)指的是“分子间”的作用，所以反式作用因子就是一个蛋白质分子，是由A基因编码的，但是可以作用于B基因，调节B基因的表达。但是也存在少量的“顺式作用因子”。因子(factor)在分子生物学中就是特指DNA片段产生的物质，换句话说就是特指蛋白质，比如调节因子、转录因子等。元件(element)指的是DNA或者RNA具有某种特定功能的序列，换句话说就是DNA或者RNA的一片段。</p>
</li>
</ul>
<h2 id="染色质开放性"><a href="#染色质开放性" class="headerlink" title="染色质开放性"></a>染色质开放性</h2><ul>
<li>染色质开放性(chromatin accessibility)是指真核生物染色质DNA在核小体或转录因子等蛋白与其结合后，对其它蛋白能否再结合的开放程度。这一特征反映了染色质转录活跃程度，结合其他DNA修饰(如甲基化)信息，特定条件下的染色质开放性变化可以提供大量的基因表达调控信息，为各种蛋白质结合新位点的发现指明方向。</li>
</ul>
<blockquote>
<p>有趣的是染色质开放性变化往往是各种应激反应(stimulus response)、抗逆反应(stress response)或者发育阶段过渡(transition)发生时非常早期的细胞学事件。在癌症早期诊断和治疗、农作物逆境胁迫的早期防治等方面，染色质结构研究可以提供非常上游的宝贵信息。</p>
</blockquote>
<p>检测染色质开放性的手段主要是足迹法(footprinting)，即利用外来蛋白(如核酸酶、修饰酶等)处理细胞核，再利用酶切、电泳、测序等手段衡量这些蛋白与DNA的结合程度，以此来体现染色质开放性。<br>用于足迹法的外来蛋白主要是核酸酶，最开始简单除暴用的是Dnase Ⅰ，价格低廉，但需要大量的实验材料。DNase Ⅰ主要切割核小体未占据的DNA区域，生成的片段测序之后获得的就是染色质开放区域。后来又出现了MNase Ⅰ，其为外切酶，消化了开放区域之后，测序获得的就是当前状态下核小体或者转录因子等占据的封闭区域。因此二者互为补充。<br>得益于二代测序技术的发展，ATAC-seq(Assay for transposase Accessible Chromatin with sequencing)是其中具备高灵敏度的一种方法。ATAC-seq使用Tn5转座酶，在开放区域跳转，边切割边加上接头，利用PCR技术富集开放区域片段，因此灵敏度高，甚至可以做单细胞测序。<br>所有以核酸酶为基础的DNA足迹法都有一个致命的缺陷：核酸酶切割的偏好性(Bias)。有研究指出DNase Ⅰ切割无核小体和转录因子结合的“裸”DNA时展现出强烈的偏好性，之前许多DNase Ⅰ印记更多地反映是切割的偏好性而非真实的蛋白质结合情况，再加上植物材料由于其细胞结构的特殊性(主要是细胞壁的存在以及丰富的纤维素和多糖)，获取细胞核用于足迹法分析本身就是一个挑战。<br>MAPit(methyltransferase accessibility protocol for individual templates)技术的出现解决了上述部分难题，MAPit利用外源DNA甲基化转移酶处理细胞核，染色质开放区域中的特定“C”位点可被甲基化，封闭区域中的相应“C”位点则不被甲基化，之后进行甲基化测序(Bisulfite sequencing)，从而精确显示染色质的开放程度。该技术利用DNA甲基化组来显示染色质开放性，避免了核酸酶的偏好性问题，且结果同时提供了DNA甲基化组和染色质开放性的信息，配合转录组测序(RNA-seq)，可一次性组合出特定状态下全基因组的甲基化修饰、蛋白结合以及基因表达调控的复杂网络，是功能强大的组合型分析。</p>
<ul>
<li><p>单体型是指位于一条染色体特定区域的一组相互关联，并倾向于以整体遗传给后代的单核苷酸多态性的组合。简单地说就是同源染色体上同一位点的杂合SNP，如在某一位置同源染色体中一条为G，另一条染色体为A。单体型图谱能够将来自于亲本的遗传信息区分开，研究遗传变异。</p>
</li>
<li><p>Hi-C技术是染色体构象捕获(Chromosome Confirmation Capture,3C)的一种衍生技术，是指基于高通量进行染色体构象的捕获，它能够在全基因组范围内捕捉不同基因座位之间的空间交互，研究三维空间中调控基因的DNA元件。</p>
</li>
</ul>
<h2 id="Hi-C技术流程"><a href="#Hi-C技术流程" class="headerlink" title="Hi-C技术流程"></a>Hi-C技术流程</h2><ul>
<li>用甲醛对细胞进行交联固定，使DNA与蛋白、蛋白与蛋白之间进行交联，这样会导致相互作用的DNA片段被交联在一起。</li>
<li>进行酶切(如Hind Ⅲ等限制性内切酶)，使交联两侧产生粘性末端，加入过量限制性内切酶将未交联的DNA与交联的DNA相互分离。限制酶的选择取决于需要分析的基因座位的情况，限制序列较短(4bp)的内切酶切点密集，用于研究较短的座位(10~20kp),而限制序列较长(6bp)的内切酶用于研究较长的座位。</li>
<li>末端修复，引入生物素标记，连接</li>
<li>解交联，使DNA和蛋白、蛋白与蛋白分开，提取DNA，打断，捕获带有生物素标记的片段，进行建库</li>
<li>测序</li>
</ul>
<hr>
<ul>
<li><p>影响基因表达的染色质相互作用的例子之一是：染色体区域可以折叠将增强子以及相关转录因子带到基因附近。</p>
</li>
<li><p>拓扑关联结构域(TAD)是利用Hi-C map分析研究染色质构象信息时获取的一种图形现象，也是染色质局部相互作用较为强烈的一个作用单元，与基因转录表达调控有着密切关系。</p>
</li>
</ul>
<blockquote>
<p>2012年四个独立的研究小组利用Hi-C技术分析不同物种染色质构象信息时均发现了一种高度自我相互作用的基因组单元，并称之为拓扑关联结构域(TAD)，具有保守性</p>
</blockquote>
<ul>
<li>染色质环(chromatin loop)是染色质物理结构的特性之一。染色质中的调控元件一般都相距较远，比如启动子、增强子等距离调控基因位点均有一定间隔。随着3C技术和一些分子研究技术的证实，这些调控元件在三维空间上的距离要比它们之间的插入序列更近一些，因此形成了染色质环。染色质环通过控制启动子、增强子这些顺式调控元件来调控基因转录表达</li>
</ul>
<blockquote>
<p>拓扑关联结构域更像是染色质环在全基因组所有作用位点进行图谱分析时表现出来的一种现象</p>
</blockquote>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/171128/D6l28BlfFI.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;生物信息学学习笔记主要是我平常看文献以及一些资料时总结的一些东西，相对来说有点杂，所以我专门开辟出一个新的系列，以便后面可以持续更新。&lt;/p&gt;
    
    </summary>
    
      <category term="bioinformatics" scheme="https://ytlogos.github.io/categories/bioinformatics/"/>
    
    
  </entry>
  
</feed>
