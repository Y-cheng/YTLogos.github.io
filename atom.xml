<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Logos</title>
  <subtitle>Stay hungry,Stay foolish</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://ytlogos.github.io/"/>
  <updated>2018-02-28T04:01:09.751Z</updated>
  <id>https://ytlogos.github.io/</id>
  
  <author>
    <name>TaoYan</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>创建属于自己的调色板</title>
    <link href="https://ytlogos.github.io/2018/02/10/%E5%88%9B%E5%BB%BA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84%E8%B0%83%E8%89%B2%E6%9D%BF/"/>
    <id>https://ytlogos.github.io/2018/02/10/创建属于自己的调色板/</id>
    <published>2018-02-10T04:19:05.000Z</published>
    <updated>2018-02-28T04:01:09.751Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://os3hnmzbp.bkt.clouddn.com/palette.jpeg" alt=""></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>我们知道发表文章的时候不同杂志的配色方案是不同的，如果参加工作的话，不同公司的配色方案也是不一样的，每个人的色觉也是不一样的，所以如果可以创建属于自己的配色方案的话以后可视化就可以随心所欲了。</p>
<a id="more"></a>
<h2 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h2><p>接下来我将基于下面的几种颜色创建属于我自己的调色板</p>
<p><img src="http://os3hnmzbp.bkt.clouddn.com/color.png" alt=""></p>
<p>主要有以下几个方面：</p>
<ul>
<li>将颜色与其对应的十六进制矢量联系起来</li>
<li>创建访问十六进制矢量的函数</li>
<li>调色板命名</li>
<li>访问调用调色板</li>
<li>创建兼容<strong>ggplot2</strong>的尺度函数</li>
</ul>
<p>首先我们创建一个颜色变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">library(ggplot2)</div><div class="line">theme_set(theme_minimal())</div><div class="line">my_colors &lt;- c(</div><div class="line">  `purple` = &quot;#7b0099&quot;,</div><div class="line">  `yellow` = &quot;#ff9900&quot;,</div><div class="line">  `black`  = &quot;#221f1f&quot;,</div><div class="line">  `white`  = &quot;#f5f5f1&quot;,</div><div class="line">  `red`    = &quot;#e50914&quot;</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>后续如果需要对颜色进行修改或添加都可以在这个颜色变量中进行。<br>下面创建一个可以从该变量中提取颜色对应的十六进制的函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">#&apos; Function to extract my_colors as hex codes</div><div class="line">#&apos;</div><div class="line">#&apos; @param ... Character names of my_colors</div><div class="line">#&apos;</div><div class="line">my_cols &lt;- function(...)&#123;</div><div class="line">  cols &lt;- c(...)</div><div class="line">  </div><div class="line">  if (is.null(cols))</div><div class="line">    return(my_colors)</div><div class="line">  my_colors[cols]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>此时我们可以十分方便获取颜色的十六进制，下面演示一下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">my_cols()</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">##    purple    yellow     black     white       red </div><div class="line">## &quot;#7b0099&quot; &quot;#ff9900&quot; &quot;#221f1f&quot; &quot;#f5f5f1&quot; &quot;#e50914&quot;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">my_cols(&quot;purple&quot;)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">##    purple </div><div class="line">## &quot;#7b0099&quot;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">my_cols(&quot;purple&quot;,&quot;yellow&quot;)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">##    purple    yellow </div><div class="line">## &quot;#7b0099&quot; &quot;#ff9900&quot;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">my_cols(&quot;yellow&quot;,&quot;purple&quot;)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">##    yellow    purple </div><div class="line">## &quot;#ff9900&quot; &quot;#7b0099&quot;</div></pre></td></tr></table></figure>
<p>此时我们可以在<strong>ggplot2</strong>中调用这些颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#使用gapminder包中的数据集gapminder来演示</div><div class="line">library(gapminder)</div><div class="line">head(gapminder)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">## # A tibble: 6 x 6</div><div class="line">##   country     continent  year lifeExp      pop gdpPercap</div><div class="line">##   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</div><div class="line">## 1 Afghanistan Asia       1952    28.8  8425333       779</div><div class="line">## 2 Afghanistan Asia       1957    30.3  9240934       821</div><div class="line">## 3 Afghanistan Asia       1962    32.0 10267083       853</div><div class="line">## 4 Afghanistan Asia       1967    34.0 11537966       836</div><div class="line">## 5 Afghanistan Asia       1972    36.1 13079460       740</div><div class="line">## 6 Afghanistan Asia       1977    38.4 14880372       786</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ggplot(gapminder, aes(gdpPercap, lifeExp))+</div><div class="line">  geom_point(color=my_cols(&quot;purple&quot;), size=2, alpha=0.8)+</div><div class="line">  scale_x_log10()</div></pre></td></tr></table></figure>
<p><img src="http://os3hnmzbp.bkt.clouddn.com/1-1.png" alt=""></p>
<h2 id="创建调色板"><a href="#创建调色板" class="headerlink" title="创建调色板"></a>创建调色板</h2><p>调色板就是一个颜色列表方便我们后面使用，将各种颜色组合搭配<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">my_palettes &lt;- list(</div><div class="line">  `main`  = my_cols(&quot;purple&quot;,&quot;yellow&quot;,&quot;red&quot;),</div><div class="line">  `cool`  = my_cols(&quot;purple&quot;,&quot;yellow&quot;),</div><div class="line">  `hot`   = my_cols(&quot;yellow&quot;,&quot;black&quot;,&quot;red&quot;),</div><div class="line">  `mixed` = my_cols(&quot;purple&quot;,&quot;yellow&quot;,&quot;white&quot;,&quot;red&quot;),</div><div class="line">  `bw`    = my_cols(&quot;black&quot;,&quot;white&quot;)</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>在这个颜色列表中实际上我们创建了好几种颜色组合，下面创建一个函数来访问并调用它们<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">#&apos; Return function to interpolate a my_palettes</div><div class="line">#&apos;</div><div class="line">#&apos; @param palette Character name of palette in my_palettes</div><div class="line">#&apos; @param reverse Boolean indicating whether the palette should be reversed</div><div class="line">#&apos; @param ... Additional arguments to pass to colorRampPalette()</div><div class="line">#&apos;</div><div class="line">my_pal &lt;- function(palette=&quot;main&quot;, reverse=FALSE, ...)&#123;</div><div class="line">  pal &lt;- my_palettes[[palette]]</div><div class="line">  if (reverse) pal &lt;- rev(pal)</div><div class="line">  colorRampPalette(pal, ...)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>该函数通过不同颜色组合名称从列表中获取一个颜色组合（默认条件下是<code>main</code>），同时可以设置是否颠倒颜色顺序，之后传递给函数colorRampPaette()创建调色板。因此其返回的是一个函数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">my_pal(&quot;cool&quot;)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">## function (n) </div><div class="line">## &#123;</div><div class="line">##     x &lt;- ramp(seq.int(0, 1, length.out = n))</div><div class="line">##     if (ncol(x) == 4L) </div><div class="line">##         rgb(x[, 1L], x[, 2L], x[, 3L], x[, 4L], maxColorValue = 255)</div><div class="line">##     else rgb(x[, 1L], x[, 2L], x[, 3L], maxColorValue = 255)</div><div class="line">## &#125;</div><div class="line">## &lt;bytecode: 0x55ade91b4b70&gt;</div><div class="line">## &lt;environment: 0x55ade91b3e20&gt;</div></pre></td></tr></table></figure>
<p>通过这个函数可以基于调色板返回不同数目的颜色，进而可以在原始颜色之间创建多级颜色梯度<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">my_pal(&quot;cool&quot;)(10)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">##  [1] &quot;#7B0099&quot; &quot;#891188&quot; &quot;#982277&quot; &quot;#A73266&quot; &quot;#B54455&quot; &quot;#C45544&quot; &quot;#D36533&quot;</div><div class="line">##  [8] &quot;#E17622&quot; &quot;#F08810&quot; &quot;#FF9900&quot;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pie(rep(1,10), col = my_pal(&quot;cool&quot;)(10))</div></pre></td></tr></table></figure>
<p><img src="http://os3hnmzbp.bkt.clouddn.com/2-1.png" alt=""></p>
<p>上图展示的10种颜色就是<code>my_pal(&quot;cool&quot;)(10)</code>返回的十六进制对应的颜色，这就为<strong>ggplot2</strong>中的尺度颜色函数创造了可能</p>
<h2 id="Scales-for-ggplot2"><a href="#Scales-for-ggplot2" class="headerlink" title="Scales for ggplot2"></a>Scales for ggplot2</h2><p><strong>ggplot2</strong>中颜色映射有<code>color</code>和<code>fill</code>即颜色和填充。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">#&apos; Color scale constructor for my_colors</div><div class="line">#&apos; </div><div class="line">#&apos; @param palette Character name of palette in my_palettes</div><div class="line">#&apos; @param discrete Boolean indicating whether color aesthetic is discrete or not</div><div class="line">#&apos; @param reverse Boolean indicating whether the palette should be reversed</div><div class="line">#&apos; @param ... Additional arguments passed to discrete_scale() or scale_color_gradientn(), used #&apos; #&apos; respectively when discrete is TRUE or FALSE</div><div class="line">#&apos; </div><div class="line">scale_color_my &lt;- function(palette=&quot;main&quot;, discrete=TRUE, reverse=FALSE, ...)&#123;</div><div class="line">  pal &lt;- my_pal(palette = palette, reverse = reverse)</div><div class="line">  </div><div class="line">  if (discrete)&#123;</div><div class="line">    discrete_scale(&quot;colour&quot;, paste0(&quot;my_&quot;, palette), palette = pal, ...)</div><div class="line">  &#125;else&#123;</div><div class="line">    scale_color_gradientn(colours = pal(256), ...)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">#&apos; Fill scale constructor for my_colors</div><div class="line">#&apos;</div><div class="line">#&apos; @param palette Character name of palette in my_palettes</div><div class="line">#&apos; @param discrete Boolean indicating whether color aesthetic is discrete or not</div><div class="line">#&apos; @param reverse Boolean indicating whether the palette should be reversed</div><div class="line">#&apos; @param ... Additional arguments passed to discrete_scale() or scale_color_gradientn(), used #&apos; #&apos; respectively when discrete is TRUE or FALSE</div><div class="line">#&apos; </div><div class="line">scale_fill_my &lt;- function(palette=&quot;main&quot;, discrete=TRUE, reverse=FALSE, ...)&#123;</div><div class="line">  pal &lt;- my_pal(palette = palette, reverse = reverse)</div><div class="line">  if (discrete)&#123;</div><div class="line">    discrete_scale(&quot;fill&quot;,paste0(&quot;my_&quot;, palette), palette = pal, ...)</div><div class="line">  &#125;else&#123;</div><div class="line">    scale_fill_gradientn(colours = pal(256), ...)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>上面每个函数都制定一个调色板（默认是<code>main</code>），调色板是基于离散变量或连续变量，以及是否颠倒颜色顺序，同时还传递给了相关的<strong>ggplot2</strong>函数。下面可以试试它们在绘图过程中的表现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ggplot(gapminder,aes(gdpPercap, lifeExp, color=continent))+</div><div class="line">  geom_point(size=2, alpha=0.8)+</div><div class="line">  scale_x_log10()+</div><div class="line">  scale_color_my()</div></pre></td></tr></table></figure></p>
<p><img src="http://os3hnmzbp.bkt.clouddn.com/3-1.png" alt=""></p>
<p>我们可以更换调色板试试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ggplot(gapminder,aes(gdpPercap, lifeExp, color=continent))+</div><div class="line">  geom_point(size=2, alpha=0.8)+</div><div class="line">  scale_x_log10()+</div><div class="line">  scale_color_my(palette = &quot;hot&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://os3hnmzbp.bkt.clouddn.com/4-1.png" alt=""></p>
<p>如果是连续变量的话<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ggplot(iris, aes(Sepal.Width, Sepal.Length, color = Sepal.Length)) +</div><div class="line">    geom_point(size = 4, alpha = .8) +</div><div class="line">    scale_color_my(discrete = FALSE, palette = &quot;bw&quot;, reverse = TRUE)</div></pre></td></tr></table></figure></p>
<p><img src="http://os3hnmzbp.bkt.clouddn.com/5-1.png" alt=""></p>
<p>上面是颜色，下面试试填充<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ggplot(mpg, aes(manufacturer, fill = manufacturer)) +</div><div class="line">    geom_bar() +</div><div class="line">    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +</div><div class="line">    scale_fill_my(palette = &quot;mixed&quot;, guide = &quot;none&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://os3hnmzbp.bkt.clouddn.com/6-1.png" alt=""></p>
<h2 id="包的创建"><a href="#包的创建" class="headerlink" title="包的创建"></a>包的创建</h2><p>通过上面的内容可以看出，如果我们会创建包的话，将上述代码封装在一起再加上一些元素就形成了一个包，可以方便自己或他人后续使用。如果要创建包的话，可以学习<a href="https://twitter.com/hadleywickham" target="_blank" rel="external">Hadley Wickham</a>的书<a href="http://r-pkgs.had.co.nz/" target="_blank" rel="external">R packages</a>。</p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-pc-linux-gnu (64-bit)</div><div class="line">## Running under: Ubuntu 17.10</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## BLAS: /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3</div><div class="line">## LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3</div><div class="line">## </div><div class="line">## locale:</div><div class="line">##  [1] LC_CTYPE=zh_CN.UTF-8       LC_NUMERIC=C              </div><div class="line">##  [3] LC_TIME=zh_CN.UTF-8        LC_COLLATE=zh_CN.UTF-8    </div><div class="line">##  [5] LC_MONETARY=zh_CN.UTF-8    LC_MESSAGES=zh_CN.UTF-8   </div><div class="line">##  [7] LC_PAPER=zh_CN.UTF-8       LC_NAME=C                 </div><div class="line">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </div><div class="line">## [11] LC_MEASUREMENT=zh_CN.UTF-8 LC_IDENTIFICATION=C       </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">## [1] gapminder_0.3.0 ggplot2_2.2.1  </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.15     knitr_1.20       magrittr_1.5     munsell_0.4.3   </div><div class="line">##  [5] colorspace_1.3-2 rlang_0.2.0      stringr_1.3.0    plyr_1.8.4      </div><div class="line">##  [9] tools_3.4.3      grid_3.4.3       gtable_0.2.0     utf8_1.1.3      </div><div class="line">## [13] cli_1.0.0        htmltools_0.3.6  assertthat_0.2.0 yaml_2.1.16     </div><div class="line">## [17] lazyeval_0.2.1   rprojroot_1.3-2  digest_0.6.15    tibble_1.4.2    </div><div class="line">## [21] crayon_1.3.4     evaluate_0.10.1  rmarkdown_1.8    labeling_0.3    </div><div class="line">## [25] stringi_1.1.6    compiler_3.4.3   pillar_1.1.0     scales_0.5.0    </div><div class="line">## [29] backports_1.1.2</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410</p>
<p>Email: tyan@zju.edu.cn</p>
<p>QQ: 1051927088</p>
<p>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a></p>
<p>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a></p>
<p>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://os3hnmzbp.bkt.clouddn.com/palette.jpeg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;我们知道发表文章的时候不同杂志的配色方案是不同的，如果参加工作的话，不同公司的配色方案也是不一样的，每个人的色觉也是不一样的，所以如果可以创建属于自己的配色方案的话以后可视化就可以随心所欲了。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="调色板" scheme="https://ytlogos.github.io/tags/%E8%B0%83%E8%89%B2%E6%9D%BF/"/>
    
  </entry>
  
  <entry>
    <title>Shell编程：运算符</title>
    <link href="https://ytlogos.github.io/2018/02/09/Shell%E7%BC%96%E7%A8%8B%EF%BC%9A%E8%BF%90%E7%AE%97%E7%AC%A6/"/>
    <id>https://ytlogos.github.io/2018/02/09/Shell编程：运算符/</id>
    <published>2018-02-09T13:19:05.000Z</published>
    <updated>2018-02-27T14:24:31.906Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://os3hnmzbp.bkt.clouddn.com/yunsuanfu.jpeg" alt=""></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Shell支持多种运算符：</p>
<ul>
<li>算术运算符</li>
<li>布尔运算符</li>
<li>关系运算符</li>
<li>字符串运算符</li>
<li>文件测试运算符</li>
</ul>
<a id="more"></a>
<p>原生bash不支持简单的数学运算，但是可以通过expr等来实现。例如两个数相加：</p>
<blockquote>
<p>需要注意的是使用的是反引号`，而不是单引号’。另外表达式与运算符之间要有空格。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#创建测试脚本test.sh</div><div class="line"></div><div class="line">add=`expr 3 + 5`</div><div class="line">echo &quot;两数之和为：$add&quot;</div></pre></td></tr></table></figure>
<p>运行脚本之后结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ./test.sh        </div><div class="line">两数之和为：4</div></pre></td></tr></table></figure>
<h2 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h2><p>算术运算符主要如下：假设a=10,b=20</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>说明</th>
<th>例子</th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td>加法</td>
<td>`expr \$a + \$b`结果为30</td>
</tr>
<tr>
<td>-</td>
<td>减法</td>
<td>`expr \$a + \$b`结果为-10</td>
</tr>
<tr>
<td>*</td>
<td>乘法</td>
<td>`expr \$a*\$b`结果为200</td>
</tr>
<tr>
<td>/</td>
<td>除法</td>
<td>`expr \$b/\$a`结果为2</td>
</tr>
<tr>
<td>%</td>
<td>取余</td>
<td>`expr \$b\%\$a`结果为0</td>
</tr>
<tr>
<td>=</td>
<td>赋值</td>
<td>a=$b将变量b的值赋值给a</td>
</tr>
<tr>
<td>==</td>
<td>相等，用于比较两个数字是否相等，是则返回TRUE，否则返回FALSE</td>
<td>[ \$a==\$b ]结果返回FALSE</td>
</tr>
<tr>
<td>!=</td>
<td>不相等</td>
<td>[ \$a!=\$b ]结果返回TRUE</td>
</tr>
</tbody>
</table>
<blockquote>
<p>注意的是表达式要放在括号之间，并且要有空格。</p>
</blockquote>
<h3 id="举个例子说明"><a href="#举个例子说明" class="headerlink" title="举个例子说明"></a>举个例子说明</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#创建测试脚本test.sh</div><div class="line">m=12</div><div class="line">n=5</div><div class="line">#加法</div><div class="line">val=`expr $m + $n`</div><div class="line">echo &quot;m+n= $val&quot;</div><div class="line">#减法</div><div class="line">val=`expr $m - $n`</div><div class="line">echo &quot;m-n= $val&quot;</div><div class="line">#乘法</div><div class="line">val=`expr $m \* $n`</div><div class="line">echo &quot;m*n= $val&quot;</div><div class="line">#乘法</div><div class="line">val=`expr $m / $n`</div><div class="line">echo &quot;m/n= $val&quot;</div><div class="line">#乘法</div><div class="line">val=`expr $m % $n`</div><div class="line">echo &quot;m%n= $val&quot;</div><div class="line"></div><div class="line">#相等</div><div class="line">if [ $m == $n ]</div><div class="line">then</div><div class="line">        echo &quot;m=n&quot;</div><div class="line">fi</div><div class="line">#不相等</div><div class="line">if [ $m != $n ]</div><div class="line">then</div><div class="line">        echo &quot;m!=n&quot;</div></pre></td></tr></table></figure>
<p>运行脚本结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ ./test.sh </div><div class="line">m+n= 17</div><div class="line">m-n= 7</div><div class="line">m*n= 60</div><div class="line">m/n= 2</div><div class="line">m%n= 2</div><div class="line">m!=n</div></pre></td></tr></table></figure></p>
<h2 id="关系运算符"><a href="#关系运算符" class="headerlink" title="关系运算符"></a>关系运算符</h2><p>关系运算符只支持数字，假设a=10,b=20:</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>说明</th>
<th>例子</th>
</tr>
</thead>
<tbody>
<tr>
<td>-eq</td>
<td>是否相等</td>
<td>[ \$a -eq \$b ]结果返回FALSE</td>
</tr>
<tr>
<td>-ne</td>
<td>是否不相等</td>
<td>[ \$a -ne \$b ]结果返回TRUE</td>
</tr>
<tr>
<td>-gt</td>
<td>左边是否大于右边</td>
<td>[ \$a -gt \$b ]结果返回FALSE</td>
</tr>
<tr>
<td>-lt</td>
<td>左边是否小于是否右边</td>
<td>[ \$a -lt \$b ]结果返回TRUE</td>
</tr>
<tr>
<td>-ge</td>
<td>左边是否大于等于右边</td>
<td>[ \$a -ge \$b ]结果返回FALSE</td>
</tr>
<tr>
<td>-eq</td>
<td>左边是否小于等于右边</td>
<td>[ \$a -le \$b ]结果返回TRUE</td>
</tr>
</tbody>
</table>
<h3 id="举个例子说明-1"><a href="#举个例子说明-1" class="headerlink" title="举个例子说明"></a>举个例子说明</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># 创建测试脚本test.sh</div><div class="line"></div><div class="line">a=10</div><div class="line">b=20</div><div class="line"></div><div class="line">if [ $a -eq $b ]</div><div class="line">then</div><div class="line">   echo &quot;$a -eq $b : a 等于 b&quot;</div><div class="line">else</div><div class="line">   echo &quot;$a -eq $b: a 不等于 b&quot;</div><div class="line">fi</div><div class="line">if [ $a -ne $b ]</div><div class="line">then</div><div class="line">   echo &quot;$a -ne $b: a 不等于 b&quot;</div><div class="line">else</div><div class="line">   echo &quot;$a -ne $b : a 等于 b&quot;</div><div class="line">fi</div><div class="line">if [ $a -gt $b ]</div><div class="line">then</div><div class="line">   echo &quot;$a -gt $b: a 大于 b&quot;</div><div class="line">else</div><div class="line">   echo &quot;$a -gt $b: a 不大于 b&quot;</div><div class="line">fi</div><div class="line">if [ $a -lt $b ]</div><div class="line">then</div><div class="line">   echo &quot;$a -lt $b: a 小于 b&quot;</div><div class="line">else</div><div class="line">   echo &quot;$a -lt $b: a 不小于 b&quot;</div><div class="line">fi</div><div class="line">if [ $a -ge $b ]</div><div class="line">then</div><div class="line">   echo &quot;$a -ge $b: a 大于或等于 b&quot;</div><div class="line">else</div><div class="line">   echo &quot;$a -ge $b: a 小于 b&quot;</div><div class="line">fi</div><div class="line">if [ $a -le $b ]</div><div class="line">then</div><div class="line">   echo &quot;$a -le $b: a 小于或等于 b&quot;</div><div class="line">else</div><div class="line">   echo &quot;$a -le $b: a 大于 b&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行脚本结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ ./test.sh </div><div class="line">10 -eq 20: a 不等于 b</div><div class="line">10 -ne 20: a 不等于 b</div><div class="line">10 -gt 20: a 不大于 b</div><div class="line">10 -lt 20: a 小于 b</div><div class="line">10 -ge 20: a 小于 b</div><div class="line">10 -le 20: a 小于或等于 b</div></pre></td></tr></table></figure></p>
<h2 id="布尔运算符"><a href="#布尔运算符" class="headerlink" title="布尔运算符"></a>布尔运算符</h2><p>假设a=10,b=20</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>说明</th>
<th>例子</th>
</tr>
</thead>
<tbody>
<tr>
<td>！</td>
<td>非运算</td>
<td>[ !false ]返回TRUE</td>
</tr>
<tr>
<td>-o</td>
<td>或运算</td>
<td>[ \$a -lt 20 -o \$b -gt 100 ] 返回true。</td>
</tr>
<tr>
<td>-a</td>
<td>与运算</td>
<td>[ \$a -lt 20 -a \$b -gt 100 ] 返回false</td>
</tr>
</tbody>
</table>
<h3 id="举例说明"><a href="#举例说明" class="headerlink" title="举例说明"></a>举例说明</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># 创建测试脚本test.sh</div><div class="line"></div><div class="line">a=10</div><div class="line">b=20</div><div class="line"></div><div class="line">if [ $a != $b ]</div><div class="line">then</div><div class="line">   echo &quot;$a != $b : a 不等于 b&quot;</div><div class="line">else</div><div class="line">   echo &quot;$a != $b: a 等于 b&quot;</div><div class="line">fi</div><div class="line">if [ $a -lt 100 -a $b -gt 15 ]</div><div class="line">then</div><div class="line">   echo &quot;$a 小于 100 且 $b 大于 15 : 返回 true&quot;</div><div class="line">else</div><div class="line">   echo &quot;$a 小于 100 且 $b 大于 15 : 返回 false&quot;</div><div class="line">fi</div><div class="line">if [ $a -lt 100 -o $b -gt 100 ]</div><div class="line">then</div><div class="line">   echo &quot;$a 小于 100 或 $b 大于 100 : 返回 true&quot;</div><div class="line">else</div><div class="line">   echo &quot;$a 小于 100 或 $b 大于 100 : 返回 false&quot;</div><div class="line">fi</div><div class="line">if [ $a -lt 5 -o $b -gt 100 ]</div><div class="line">then</div><div class="line">   echo &quot;$a 小于 5 或 $b 大于 100 : 返回 true&quot;</div><div class="line">else</div><div class="line">   echo &quot;$a 小于 5 或 $b 大于 100 : 返回 false&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行脚本结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ ./test.sh </div><div class="line">10 != 20 : a 不等于 b</div><div class="line">10 小于 100 且 20 大于 15 : 返回 true</div><div class="line">10 小于 100 或 20 大于 100 : 返回 true</div><div class="line">10 小于 5 或 20 大于 100 : 返回 false</div></pre></td></tr></table></figure></p>
<h2 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h2><p>假设a=10,b=20</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>说明</th>
<th>例子</th>
</tr>
</thead>
<tbody>
<tr>
<td>&amp;&amp;</td>
<td>逻辑的AND</td>
<td>[[ \$a -lt 100 &amp;&amp; \$b -gt 100 ]] 返回 false</td>
</tr>
<tr>
<td>\</td>
<td>\</td>
<td></td>
<td>逻辑的OR</td>
<td>[[ \$a -lt 100 \</td>
<td>\</td>
<td>\$b -gt 100 ]] 返回 true</td>
</tr>
</tbody>
</table>
<h3 id="举例说明-1"><a href="#举例说明-1" class="headerlink" title="举例说明"></a>举例说明</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># 创建测试脚本test.sh</div><div class="line"></div><div class="line">a=10</div><div class="line">b=20</div><div class="line"></div><div class="line">if [[ $a -lt 100 &amp;&amp; $b -gt 100 ]]</div><div class="line">then</div><div class="line">   echo &quot;返回 true&quot;</div><div class="line">else</div><div class="line">   echo &quot;返回 false&quot;</div><div class="line">fi</div><div class="line"></div><div class="line">if [[ $a -lt 100 || $b -gt 100 ]]</div><div class="line">then</div><div class="line">   echo &quot;返回 true&quot;</div><div class="line">else</div><div class="line">   echo &quot;返回 false&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行脚本结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ ./test.sh </div><div class="line">返回 false</div><div class="line">返回 true</div></pre></td></tr></table></figure></p>
<h2 id="字符串运算符"><a href="#字符串运算符" class="headerlink" title="字符串运算符"></a>字符串运算符</h2><p>下表列出了常用的字符串运算符，假定变量 a 为 “abc”，变量 b 为 “efg”：<br>运算符|说明|例子<br>—|—-|—–<br>=|相等|[ \$a = \$b ] 返回 false<br>!=|不相等|[ \$a != \$b ] 返回 true<br>-z|字符串长度是否为0|[ -z \$a ] 返回 false<br>-n|字符串长度是否不为0|[ -n \$a ] 返回 true<br>str|字符串是否不为空|[ \$a ] 返回 true</p>
<h3 id="举例说明-2"><a href="#举例说明-2" class="headerlink" title="举例说明"></a>举例说明</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># 创建测试脚本test.sh</div><div class="line"></div><div class="line">a=&quot;abc&quot;</div><div class="line">b=&quot;efg&quot;</div><div class="line"></div><div class="line">if [ $a = $b ]</div><div class="line">then</div><div class="line">   echo &quot;$a = $b : a 等于 b&quot;</div><div class="line">else</div><div class="line">   echo &quot;$a = $b: a 不等于 b&quot;</div><div class="line">fi</div><div class="line">if [ $a != $b ]</div><div class="line">then</div><div class="line">   echo &quot;$a != $b : a 不等于 b&quot;</div><div class="line">else</div><div class="line">   echo &quot;$a != $b: a 等于 b&quot;</div><div class="line">fi</div><div class="line">if [ -z $a ]</div><div class="line">then</div><div class="line">   echo &quot;-z $a : 字符串长度为 0&quot;</div><div class="line">else</div><div class="line">   echo &quot;-z $a : 字符串长度不为 0&quot;</div><div class="line">fi</div><div class="line">if [ -n $a ]</div><div class="line">then</div><div class="line">   echo &quot;-n $a : 字符串长度不为 0&quot;</div><div class="line">else</div><div class="line">   echo &quot;-n $a : 字符串长度为 0&quot;</div><div class="line">fi</div><div class="line">if [ $a ]</div><div class="line">then</div><div class="line">   echo &quot;$a : 字符串不为空&quot;</div><div class="line">else</div><div class="line">   echo &quot;$a : 字符串为空&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行脚本结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ ./test.sh </div><div class="line">abc = efg: a 不等于 b</div><div class="line">abc != efg : a 不等于 b</div><div class="line">-z abc : 字符串长度不为 0</div><div class="line">-n abc : 字符串长度不为 0</div><div class="line">abc : 字符串不为空</div></pre></td></tr></table></figure></p>
<h2 id="文件运算符"><a href="#文件运算符" class="headerlink" title="文件运算符"></a>文件运算符</h2><p>文件运算符主要用于检测文件属性。这里就不讲解了。</p>
<p>本文主要参考<a href="http://www.runoob.com/linux/linux-shell-basic-operators.html" target="_blank" rel="external">菜鸟教程</a></p>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://os3hnmzbp.bkt.clouddn.com/yunsuanfu.jpeg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;Shell支持多种运算符：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;算术运算符&lt;/li&gt;
&lt;li&gt;布尔运算符&lt;/li&gt;
&lt;li&gt;关系运算符&lt;/li&gt;
&lt;li&gt;字符串运算符&lt;/li&gt;
&lt;li&gt;文件测试运算符&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Shell" scheme="https://ytlogos.github.io/categories/Shell/"/>
    
    
      <category term="运算符" scheme="https://ytlogos.github.io/tags/%E8%BF%90%E7%AE%97%E7%AC%A6/"/>
    
  </entry>
  
  <entry>
    <title>利用gganimate可视化R-Ladies发展情况</title>
    <link href="https://ytlogos.github.io/2018/02/08/%E5%88%A9%E7%94%A8gganimate%E5%8F%AF%E8%A7%86%E5%8C%96R-Ladies%E5%8F%91%E5%B1%95%E6%83%85%E5%86%B5/"/>
    <id>https://ytlogos.github.io/2018/02/08/利用gganimate可视化R-Ladies发展情况/</id>
    <published>2018-02-08T04:19:05.000Z</published>
    <updated>2018-02-08T06:02:39.920Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180208/g0hLljaEb9.gif" alt="mark"></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>这篇博客主要基于<a href="https://d4tagirl.com/2017/05/how-to-plot-animated-maps-with-gganimate" target="_blank" rel="external"><strong>d4tagirl</strong></a>,稍微有所修改。</p>
<a id="more"></a>
<h2 id="数据加载"><a href="#数据加载" class="headerlink" title="数据加载"></a>数据加载</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(pacman)</div><div class="line">p_load(tidyverse, gganomate, maps, ggthemes)</div><div class="line">rladies &lt;- read_csv(url(&quot;https://raw.githubusercontent.com/d4tagirl/R-Ladies-growth-maps/master/rladies.csv&quot;))%&gt;%</div><div class="line">  select(-1)</div><div class="line">head(rladies)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">## # A tibble: 6 x 7</div><div class="line">##   screen_name     location     created_at followers age_days     lon   lat</div><div class="line">##   &lt;chr&gt;           &lt;chr&gt;        &lt;date&gt;         &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;</div><div class="line">## 1 RLadiesSF       San Francis~ 2012-10-15       916     1673 -122     37.8</div><div class="line">## 2 RLadiesNYC      New York     2016-09-01       309      256 - 74.0   40.7</div><div class="line">## 3 RLadiesIstanbul &lt;U+0130&gt;stanbul, T~ 2016-09-06       436      251   29.0   41.0</div><div class="line">## 4 RLadiesBCN      Barcelona, ~ 2016-10-11       377      216    2.17  41.4</div><div class="line">## 5 RLadiesColumbus Columbus, OH 2016-10-04       179      223 - 83.0   40.0</div><div class="line">## 6 RLadiesBoston   Boston, MA   2016-09-06       259      251 - 71.1   42.4</div></pre></td></tr></table></figure>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><p>主要是根据地理位置信息映射到地图上<br><figure class="highlight plain"><figcaption><span>fig.height=18&#125;</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">ggplot()+</div><div class="line">  borders(&quot;world&quot;, color=&quot;gray85&quot;, fill=&quot;grey80&quot;)+</div><div class="line">  geom_point(data = rladies, aes(lon, lat, size=followers), color=&quot;purple&quot;, alpha=0.5)+</div><div class="line">  scale_size_continuous(range = c(8, 24), breaks = c(250, 500, 750, 1000))+</div><div class="line">  labs(size=&quot;Followers&quot;, title=&quot;                                             The development of R-Ladies’ Twitter accounts&quot;,x=NULL,y=NULL)+</div><div class="line">  theme(text = element_text(family = &quot;Times New Roman&quot;, color = &quot;#EEEEEE&quot;),</div><div class="line">        plot.title = element_text(size=40,color = &quot;#f9ba00&quot;),</div><div class="line">        plot.subtitle = element_text(size=14),</div><div class="line">        axis.ticks = element_blank(),</div><div class="line">        axis.text = element_blank(),</div><div class="line">        panel.grid = element_blank(),</div><div class="line">        panel.background = element_rect(fill=&quot;#333333&quot;),</div><div class="line">        plot.background = element_rect(fill = &quot;#333333&quot;),</div><div class="line">        legend.position = c(0.18,0.36),</div><div class="line">        legend.background = element_blank(),</div><div class="line">        legend.key = element_blank(),</div><div class="line">        legend.text = element_text(size = 28),</div><div class="line">        legend.title = element_text(size=28, color = &quot;#f9ba00&quot;))+</div><div class="line">  annotate(geom = &quot;text&quot;,</div><div class="line">           label=&quot;Made by Logos ytlogos.github.io\nOriginally from d4tagirl https://d4tagirl.com&quot;,</div><div class="line">           x=70, y=-55, size=10, family=&quot;Helvetica Black&quot;, color=&quot;#f9ba00&quot;, hjust=&quot;left&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180208/emDGG7e91G.png?imageslim" alt="mark"></p>
<h2 id="动画展示"><a href="#动画展示" class="headerlink" title="动画展示"></a>动画展示</h2><p>为了利用<strong>gganimate</strong>进行动态展示，需要构建一个映射变量：时间。同时为了使得可视化开始和结尾呈现的是空白，又构建了两个空白图层<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ghost_points_ini &lt;- tibble(created_at=as.Date(&quot;2011-09-01&quot;), followers=0, lon=0, lat=0)</div><div class="line">ghost_points_fin &lt;- tibble(created_at=seq(as.Date(&quot;2017-05-16&quot;), as.Date(&quot;2017-05-30&quot;),by=&quot;days&quot;), followers=0, lon=0,lat=0)</div></pre></td></tr></table></figure></p>
<p>添加frame映射<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">map &lt;- ggplot()+</div><div class="line">  borders(&quot;world&quot;, color=&quot;gray85&quot;, fill=&quot;grey80&quot;)+</div><div class="line">  geom_point(data = rladies, aes(lon, lat, size=followers, frame=created_at, cumulative=TRUE), color=&quot;purple&quot;, alpha=0.5)+</div><div class="line">  scale_size_continuous(range = c(4, 16), breaks = c(250, 500, 750, 1000))+</div><div class="line">  geom_point(data = ghost_points_ini, aes(lon, lat, size=followers, frame=created_at, cumulative=TRUE), alpha=0)+</div><div class="line">  geom_point(data = ghost_points_fin, aes(lon, lat, size=followers, frame=created_at, cumulative=TRUE), alpha=0)+</div><div class="line">  labs(size=&quot;Followers&quot;, title=&quot;The development of R-Ladies’ Twitter accounts&quot;,x=NULL,y=NULL)+</div><div class="line">  theme(text = element_text(family = &quot;Times New Roman&quot;, color = &quot;#EEEEEE&quot;),</div><div class="line">        plot.title = element_text(size=28, color = &quot;#f9ba00&quot;),</div><div class="line">        plot.subtitle = element_text(size=14),</div><div class="line">        axis.ticks = element_blank(),</div><div class="line">        axis.text = element_blank(),</div><div class="line">        panel.grid = element_blank(),</div><div class="line">        panel.background = element_rect(fill=&quot;#333333&quot;),</div><div class="line">        plot.background = element_rect(fill = &quot;#333333&quot;),</div><div class="line">        legend.position = c(0.18,0.36),</div><div class="line">        legend.background = element_blank(),</div><div class="line">        legend.key = element_blank(),</div><div class="line">        legend.text = element_text(size = 18),</div><div class="line">        legend.title = element_text(size=24, color = &quot;#f9ba00&quot;))+</div><div class="line">  annotate(geom = &quot;text&quot;,</div><div class="line">           label=&quot;Made by Logos ytlogos.github.io\nOriginally from d4tagirl https://d4tagirl.com&quot;,</div><div class="line">           x=70, y=-55, size=6, family=&quot;Helvetica Black&quot;, color=&quot;#f9ba00&quot;, hjust=&quot;left&quot;)</div><div class="line">animation::ani.options(interval=0.15, ani.width=1500, ani.height=800, units=&quot;in&quot;)</div><div class="line">gganimate::gganimate(map, filename = &quot;d4tagirlmap.gif&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180208/g0hLljaEb9.gif" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">##  [1] ggthemes_3.4.0       maps_3.2.0           BiocInstaller_1.28.0</div><div class="line">##  [4] forcats_0.2.0        stringr_1.2.0        dplyr_0.7.4         </div><div class="line">##  [7] purrr_0.2.4          readr_1.1.1          tidyr_0.8.0         </div><div class="line">## [10] tibble_1.4.2         ggplot2_2.2.1.9000   tidyverse_1.2.1     </div><div class="line">## [13] pacman_0.4.6        </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] reshape2_1.4.3    haven_1.1.1       lattice_0.20-35  </div><div class="line">##  [4] colorspace_1.3-2  htmltools_0.3.6   yaml_2.1.16      </div><div class="line">##  [7] utf8_1.1.3        rlang_0.1.6       pillar_1.1.0     </div><div class="line">## [10] foreign_0.8-69    glue_1.2.0        modelr_0.1.1     </div><div class="line">## [13] readxl_1.0.0      bindrcpp_0.2      bindr_0.1        </div><div class="line">## [16] plyr_1.8.4        munsell_0.4.3     gtable_0.2.0     </div><div class="line">## [19] cellranger_1.1.0  rvest_0.3.2       psych_1.7.8      </div><div class="line">## [22] evaluate_0.10.1   labeling_0.3      knitr_1.19       </div><div class="line">## [25] parallel_3.4.3    broom_0.4.3       Rcpp_0.12.15     </div><div class="line">## [28] scales_0.5.0.9000 backports_1.1.2   jsonlite_1.5     </div><div class="line">## [31] mnormt_1.5-5      hms_0.4.1         digest_0.6.15    </div><div class="line">## [34] stringi_1.1.6     grid_3.4.3        rprojroot_1.3-2  </div><div class="line">## [37] cli_1.0.0         tools_3.4.3       magrittr_1.5     </div><div class="line">## [40] lazyeval_0.2.1    crayon_1.3.4      pkgconfig_2.0.1  </div><div class="line">## [43] xml2_1.2.0        lubridate_1.7.1   assertthat_0.2.0 </div><div class="line">## [46] rmarkdown_1.8     httr_1.3.1        rstudioapi_0.7   </div><div class="line">## [49] R6_2.2.2          nlme_3.1-131      compiler_3.4.3</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410</p>
<p>Email: tyan@zju.edu.cn</p>
<p>QQ: 1051927088</p>
<p>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a></p>
<p>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a></p>
<p>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180208/g0hLljaEb9.gif&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;这篇博客主要基于&lt;a href=&quot;https://d4tagirl.com/2017/05/how-to-plot-animated-maps-with-gganimate&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;strong&gt;d4tagirl&lt;/strong&gt;&lt;/a&gt;,稍微有所修改。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="地图" scheme="https://ytlogos.github.io/tags/%E5%9C%B0%E5%9B%BE/"/>
    
      <category term="gganimate" scheme="https://ytlogos.github.io/tags/gganimate/"/>
    
  </entry>
  
  <entry>
    <title>利用R语言绘制世界航班路线图</title>
    <link href="https://ytlogos.github.io/2018/02/07/%E5%88%A9%E7%94%A8R%E8%AF%AD%E8%A8%80%E7%BB%98%E5%88%B6%E4%B8%96%E7%95%8C%E8%88%AA%E7%8F%AD%E8%B7%AF%E7%BA%BF%E5%9B%BE/"/>
    <id>https://ytlogos.github.io/2018/02/07/利用R语言绘制世界航班路线图/</id>
    <published>2018-02-07T04:19:05.000Z</published>
    <updated>2018-02-07T06:19:41.066Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180207/6HckGG7Jfc.png?imageslim" alt="mark"></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>本文基于<strong>NASA</strong>的<a href="https://www.nasa.gov/specials/blackmarble/2016/globalmaps/BlackMarble_2016_01deg.jpg" target="_blank" rel="external">夜间地图</a>的基础上进行世界航班路线可视化，参考多篇博客以及可视化案例。</p>
<a id="more"></a>
<h2 id="包加载"><a href="#包加载" class="headerlink" title="包加载"></a>包加载</h2><p>本博客使用的包较多，利用<strong>pacman</strong>包里的<code>p_load()</code>函数进行加载<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(pacman)</div><div class="line">p_load(tidyverse, data.table, geosphere, grid, jpeg, plyr)</div></pre></td></tr></table></figure></p>
<h2 id="数据准备"><a href="#数据准备" class="headerlink" title="数据准备"></a>数据准备</h2><p>使用的数据来自于<a href="https://openflights.org/data.html" target="_blank" rel="external">OpenFlights.org</a>。</p>
<h3 id="数据下载"><a href="#数据下载" class="headerlink" title="数据下载"></a>数据下载</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">download.file(&quot;https://raw.githubusercontent.com/jpatokal/openflights/master/data/airlines.dat&quot;,</div><div class="line">              destfile = &quot;airlines.dat&quot;, mode = &quot;wb&quot;)</div><div class="line">download.file(&quot;https://raw.githubusercontent.com/jpatokal/openflights/master/data/airports.dat&quot;, </div><div class="line">              destfile = &quot;airports.dat&quot;, mode = &quot;wb&quot;)</div><div class="line">download.file(&quot;https://raw.githubusercontent.com/jpatokal/openflights/master/data/routes.dat&quot;, </div><div class="line">              destfile = &quot;routes.dat&quot;, mode = &quot;wb&quot;)</div></pre></td></tr></table></figure>
<h3 id="数据导入"><a href="#数据导入" class="headerlink" title="数据导入"></a>数据导入</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">airlines &lt;- fread(&quot;airlines.dat&quot;, sep = &quot;,&quot;, skip = 1)</div><div class="line">airports &lt;- fread(&quot;airports.dat&quot;, sep = &quot;,&quot;)</div><div class="line">routes &lt;- fread(&quot;routes.dat&quot;, sep = &quot;,&quot;)</div></pre></td></tr></table></figure>
<h3 id="数据整理"><a href="#数据整理" class="headerlink" title="数据整理"></a>数据整理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">#添加列名</div><div class="line">colnames(airlines) &lt;- c(&quot;airline_id&quot;, &quot;name&quot;, &quot;alias&quot;, &quot;iata&quot;, &quot;icao&quot;, &quot;callisign&quot;, &quot;country&quot;, &quot;active&quot;)</div><div class="line">colnames(airports) &lt;- c(&quot;airport_id&quot;, &quot;name&quot;, &quot;city&quot;, &quot;country&quot;,&quot;iata&quot;, &quot;icao&quot;, &quot;latitude&quot;, &quot;longitude&quot;,&quot;altitude&quot;, &quot;timezone&quot;,&quot;dst&quot;,&quot;tz_database_time_zone&quot;,&quot;type&quot;, &quot;source&quot;)</div><div class="line">colnames(routes) &lt;- c(&quot;airline&quot;, &quot;airline_id&quot;, &quot;source_airport&quot;, &quot;source_airport_id&quot;,&quot;destination_airport&quot;,&quot;destination_airport_id&quot;,&quot;codeshare&quot;, &quot;stops&quot;,&quot;equipment&quot;)</div><div class="line"></div><div class="line">#类型转换</div><div class="line">routes$airline_id &lt;- as.numeric(routes$airline_id)</div><div class="line"># airlines与routes数据融合</div><div class="line">flights &lt;- left_join(routes, airlines, by=&quot;airline_id&quot;)</div><div class="line"># flights与airports数据融合</div><div class="line">airports_orig &lt;- airports[,c(5,7,8)]</div><div class="line">colnames(airports_orig) &lt;- c(&quot;source_airport&quot;,&quot;source_airport_lat&quot;, &quot;source_airport_long&quot;)</div><div class="line">airports_dest &lt;- airports[, c(5, 7, 8)]</div><div class="line">colnames(airports_dest) &lt;- c(&quot;destination_airport&quot;, &quot;destination_airport_lat&quot;, &quot;destination_airport_long&quot;)</div><div class="line">flights &lt;- left_join(flights, airports_orig, by = &quot;source_airport&quot;)</div><div class="line">flights &lt;- left_join(flights, airports_dest, by = &quot;destination_airport&quot;)</div><div class="line">#剔除缺失值</div><div class="line">flights &lt;- na.omit(flights, cols = c(&quot;source_airport_long&quot;, &quot;source_airport_lat&quot;, &quot;destination_airport_long&quot;, &quot;destination_airport_lat&quot;))</div><div class="line">#最后数据如下</div><div class="line">head(flights[,c(1:5)])</div></pre></td></tr></table></figure>
<p>下面就是准备地理信息数据</p>
<p>本文主要是可视化地理信息上的点与点之间的连接，这可以通过<strong>geosphere</strong>包里的函数<code>gcIntermediate()</code>很轻松实现。具体使用方法可以参考<a href="http://flowingdata.com/2011/05/11/how-to-map-connections-with-great-circles/" target="_blank" rel="external">这里</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"># 按航空公司拆分数据集</div><div class="line">flights_split &lt;- split(flights, flights$name)</div><div class="line"># Calculate intermediate points between each two locations</div><div class="line">flights_all &lt;- lapply(flights_split, function(x) gcIntermediate(x[, c(&quot;source_airport_long&quot;, &quot;source_airport_lat&quot;)], x[, c(&quot;destination_airport_long&quot;, &quot;destination_airport_lat&quot;)], n=100, breakAtDateLine = FALSE, addStartEnd = TRUE, sp = TRUE))</div><div class="line"></div><div class="line"># 转换为数据框</div><div class="line">flights_fortified &lt;- lapply(flights_all, function(x) ldply(x@lines, fortify))</div><div class="line"></div><div class="line"># Unsplit lists</div><div class="line">flights_fortified &lt;- do.call(&quot;rbind&quot;, flights_fortified)</div><div class="line"></div><div class="line"># Add and clean column with airline names</div><div class="line">flights_fortified$name &lt;- rownames(flights_fortified)</div><div class="line">flights_fortified$name &lt;- gsub(&quot;\\..*&quot;, &quot;&quot;, flights_fortified$name)</div><div class="line"></div><div class="line"># Extract first and last observations for plotting source and destination points (i.e., airports)</div><div class="line">flights_points &lt;- flights_fortified %&gt;%</div><div class="line">  group_by(group) %&gt;%</div><div class="line">  filter(row_number() == 1 | row_number() == n())</div></pre></td></tr></table></figure>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><p>接下来就是进行可视化了，前面讲了我们只是在<strong>NASA</strong>提供的夜间地球图上面进行数据映射，所以第一我们需要获取该背景地图。</p>
<h3 id="图片获取并渲染"><a href="#图片获取并渲染" class="headerlink" title="图片获取并渲染"></a>图片获取并渲染</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#下载图片</div><div class="line">download.file(&quot;https://www.nasa.gov/specials/blackmarble/2016/globalmaps/BlackMarble_2016_01deg.jpg&quot;,</div><div class="line">              destfile = &quot;BlackMarble_2016_01deg.jpg&quot;, mode = &quot;wb&quot;)</div><div class="line">#加载并渲染图片</div><div class="line">earth &lt;- readJPEG(&quot;BlackMarble_2016_01deg.jpg&quot;, native = TRUE)</div><div class="line">earth &lt;- rasterGrob(earth, interpolate = TRUE)</div></pre></td></tr></table></figure>
<h3 id="数据映射"><a href="#数据映射" class="headerlink" title="数据映射"></a>数据映射</h3><p>由于航空公司十分多，就挑选几个有名的航空公司进行可视化。</p>
<h4 id="Lufthansa-德国汉莎航空公司"><a href="#Lufthansa-德国汉莎航空公司" class="headerlink" title="Lufthansa(德国汉莎航空公司)"></a>Lufthansa(德国汉莎航空公司)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">ggplot() +</div><div class="line">  annotation_custom(earth, xmin = -180, xmax = 180, ymin = -90, ymax = 90) +</div><div class="line">  geom_path(aes(long, lat, group = id, color = name), alpha = 0.0, size = 0.0, data = flights_fortified) + </div><div class="line">  geom_path(aes(long, lat, group = id, color = name), alpha = 0.2, size = 0.3, color = &quot;#f9ba00&quot;, data = flights_fortified[flights_fortified$name == &quot;Lufthansa&quot;, ]) + </div><div class="line">  geom_point(data = flights_points[flights_points$name == &quot;Lufthansa&quot;, ], aes(long, lat), alpha = 0.8, size = 0.1, colour = &quot;white&quot;) +</div><div class="line">  theme(panel.background = element_rect(fill = &quot;#05050f&quot;, colour = &quot;#05050f&quot;), </div><div class="line">        panel.grid.major = element_blank(),</div><div class="line">        panel.grid.minor = element_blank(), </div><div class="line">        axis.title = element_blank(), </div><div class="line">        axis.text = element_blank(), </div><div class="line">        axis.ticks.length = unit(0, &quot;cm&quot;),</div><div class="line">        legend.position = &quot;none&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -18, hjust = 0, size = 14,</div><div class="line">           label = paste(&quot;Lufthansa&quot;), color = &quot;#f9ba00&quot;, family = &quot;Helvetica Black&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -26, hjust = 0, size = 8, </div><div class="line">           label = paste(&quot;Flight routes&quot;), color = &quot;white&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -30, hjust = 0, size = 7, </div><div class="line">           label = paste(&quot;ytlogos.github.io || NASA.gov || OpenFlights.org&quot;), color = &quot;white&quot;, alpha = 0.5) +</div><div class="line">  coord_equal()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180207/5g2k5l3afB.png?imageslim" alt="mark"></p>
<h4 id="Emirates-阿联酋航空公司"><a href="#Emirates-阿联酋航空公司" class="headerlink" title="Emirates(阿联酋航空公司)"></a>Emirates(阿联酋航空公司)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">ggplot() +</div><div class="line">  annotation_custom(earth, xmin = -180, xmax = 180, ymin = -90, ymax = 90) +</div><div class="line">  geom_path(aes(long, lat, group = id, color = name), alpha = 0.0, size = 0.0, data = flights_fortified) + </div><div class="line">  geom_path(aes(long, lat, group = id, color = name), alpha = 0.2, size = 0.3, color = &quot;#ff0000&quot;, data = flights_fortified[flights_fortified$name == &quot;Emirates&quot;, ]) + </div><div class="line">  geom_point(data = flights_points[flights_points$name == &quot;Emirates&quot;, ], aes(long, lat), alpha = 0.8, size = 0.1, colour = &quot;white&quot;) +</div><div class="line">  theme(panel.background = element_rect(fill = &quot;#05050f&quot;, colour = &quot;#05050f&quot;), </div><div class="line">        panel.grid.major = element_blank(),</div><div class="line">        panel.grid.minor = element_blank(), </div><div class="line">        axis.title = element_blank(), </div><div class="line">        axis.text = element_blank(), </div><div class="line">        axis.ticks.length = unit(0, &quot;cm&quot;),</div><div class="line">        legend.position = &quot;none&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -18, hjust = 0, size = 14,</div><div class="line">           label = paste(&quot;Emirates&quot;), color = &quot;#ff0000&quot;, family = &quot;Fontin&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -26, hjust = 0, size = 8, </div><div class="line">           label = paste(&quot;Flight routes&quot;), color = &quot;white&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -30, hjust = 0, size = 7, </div><div class="line">           label = paste(&quot;ytlogos.github.io || NASA.gov || OpenFlights.org&quot;), color = &quot;white&quot;, alpha = 0.5) +</div><div class="line">  coord_equal()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180207/mgl6B5ecaJ.png?imageslim" alt="mark"></p>
<h4 id="British-Airways-英国航空公司"><a href="#British-Airways-英国航空公司" class="headerlink" title="British Airways(英国航空公司)"></a>British Airways(英国航空公司)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">ggplot() +</div><div class="line">  annotation_custom(earth, xmin = -180, xmax = 180, ymin = -90, ymax = 90) +</div><div class="line">  geom_path(aes(long, lat, group = id, color = name), alpha = 0.0, size = 0.0, data = flights_fortified) + </div><div class="line">  geom_path(aes(long, lat, group = id, color = name), alpha = 0.2, size = 0.3, color = &quot;#075aaa&quot;, data = flights_fortified[flights_fortified$name == &quot;British Airways&quot;, ]) + </div><div class="line">  geom_point(data = flights_points[flights_points$name == &quot;British Airways&quot;, ], aes(long, lat), alpha = 0.8, size = 0.1, colour = &quot;white&quot;) +</div><div class="line">  theme(panel.background = element_rect(fill = &quot;#05050f&quot;, colour = &quot;#05050f&quot;), </div><div class="line">        panel.grid.major = element_blank(),</div><div class="line">        panel.grid.minor = element_blank(), </div><div class="line">        axis.title = element_blank(), </div><div class="line">        axis.text = element_blank(), </div><div class="line">        axis.ticks.length = unit(0, &quot;cm&quot;),</div><div class="line">        legend.position = &quot;none&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -18, hjust = 0, size = 14,</div><div class="line">           label = paste(&quot;BRITISH AIRWAYS&quot;), color = &quot;#075aaa&quot;, family = &quot;Baker Signet Std&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -26, hjust = 0, size = 8, </div><div class="line">           label = paste(&quot;Flight routes&quot;), color = &quot;white&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -30, hjust = 0, size = 7, </div><div class="line">           label = paste(&quot;ytlogos.github.io || NASA.gov || OpenFlights.org&quot;), color = &quot;white&quot;, alpha = 0.5) +</div><div class="line">  coord_equal()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180207/7H0j1CdIka.png?imageslim" alt="mark"></p>
<h4 id="Air-China-中国国航"><a href="#Air-China-中国国航" class="headerlink" title="Air China(中国国航)"></a>Air China(中国国航)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">ggplot() +</div><div class="line">  annotation_custom(earth, xmin = -180, xmax = 180, ymin = -90, ymax = 90) +</div><div class="line">  geom_path(aes(long, lat, group = id, color = name), alpha = 0.0, size = 0.0, data = flights_fortified) + </div><div class="line">  geom_path(aes(long, lat, group = id, color = name), alpha = 0.2, size = 0.3, color = &quot;#F70C15&quot;, data = flights_fortified[flights_fortified$name == &quot;Air China&quot;, ]) + </div><div class="line">  geom_point(data = flights_points[flights_points$name == &quot;Air China&quot;, ], aes(long, lat), alpha = 0.8, size = 0.1, colour = &quot;white&quot;) +</div><div class="line">  theme(panel.background = element_rect(fill = &quot;#05050f&quot;, colour = &quot;#05050f&quot;), </div><div class="line">        panel.grid.major = element_blank(),</div><div class="line">        panel.grid.minor = element_blank(), </div><div class="line">        axis.title = element_blank(), </div><div class="line">        axis.text = element_blank(), </div><div class="line">        axis.ticks.length = unit(0, &quot;cm&quot;),</div><div class="line">        legend.position = &quot;none&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -18, hjust = 0, size = 14,</div><div class="line">           label = paste(&quot;Air China&quot;), color = &quot;#F70C15&quot;, family = &quot;Times New Roman&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -26, hjust = 0, size = 8, </div><div class="line">           label = paste(&quot;Flight routes&quot;), color = &quot;white&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -30, hjust = 0, size = 7, </div><div class="line">           label = paste(&quot;ytlogos.github.io || NASA.gov || OpenFlights.org&quot;), color = &quot;white&quot;, alpha = 0.5) +</div><div class="line">  coord_equal()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180207/e9hHgKI1AE.png?imageslim" alt="mark"></p>
<h4 id="China-Southern-Airlines-中国南航"><a href="#China-Southern-Airlines-中国南航" class="headerlink" title="China Southern Airlines(中国南航)"></a>China Southern Airlines(中国南航)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">ggplot() +</div><div class="line">  annotation_custom(earth, xmin = -180, xmax = 180, ymin = -90, ymax = 90) +</div><div class="line">  geom_path(aes(long, lat, group = id, color = name), alpha = 0.0, size = 0.0, data = flights_fortified) + </div><div class="line">  geom_path(aes(long, lat, group = id, color = name), alpha = 0.2, size = 0.3, color = &quot;#004D9D&quot;, data = flights_fortified[flights_fortified$name == &quot;China Southern Airlines&quot;, ]) + </div><div class="line">  geom_point(data = flights_points[flights_points$name == &quot;China Southern Airlines&quot;, ], aes(long, lat), alpha = 0.8, size = 0.1, colour = &quot;white&quot;) +</div><div class="line">  theme(panel.background = element_rect(fill = &quot;#05050f&quot;, colour = &quot;#05050f&quot;), </div><div class="line">        panel.grid.major = element_blank(),</div><div class="line">        panel.grid.minor = element_blank(), </div><div class="line">        axis.title = element_blank(), </div><div class="line">        axis.text = element_blank(), </div><div class="line">        axis.ticks.length = unit(0, &quot;cm&quot;),</div><div class="line">        legend.position = &quot;none&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -18, hjust = 0, size = 14,</div><div class="line">           label = paste(&quot;China Southern Airlines&quot;), color = &quot;#004D9D&quot;, family = &quot;Times New Roman&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -26, hjust = 0, size = 8, </div><div class="line">           label = paste(&quot;Flight routes&quot;), color = &quot;white&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -30, hjust = 0, size = 7, </div><div class="line">           label = paste(&quot;ytlogos.github.io || NASA.gov || OpenFlights.org&quot;), color = &quot;white&quot;, alpha = 0.5) +</div><div class="line">  coord_equal()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180207/D0GeF9BC62.png?imageslim" alt="mark"></p>
<h3 id="一次性映射多家航空公司航行路线"><a href="#一次性映射多家航空公司航行路线" class="headerlink" title="一次性映射多家航空公司航行路线"></a>一次性映射多家航空公司航行路线</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">#抽取数据集</div><div class="line">flights_subset &lt;- c(&quot;Lufthansa&quot;, &quot;Emirates&quot;, &quot;British Airways&quot;)</div><div class="line">flights_subset &lt;- flights_fortified[flights_fortified$name %in% flights_subset, ]</div><div class="line">flights_subset_points &lt;- flights_subset%&gt;%</div><div class="line">  group_by(group)%&gt;%</div><div class="line">  filter(row_number()==1|row_number()==n())</div><div class="line">#可视化</div><div class="line">ggplot() +</div><div class="line">  annotation_custom(earth, xmin = -180, xmax = 180, ymin = -90, ymax = 90) +</div><div class="line">  geom_path(aes(long, lat, group = id, color = name), alpha = 0.2, size = 0.3, data = flights_subset) + </div><div class="line">  geom_point(data = flights_subset_points, aes(long, lat), alpha = 0.8, size = 0.1, colour = &quot;white&quot;) +</div><div class="line">  scale_color_manual(values = c(&quot;#f9ba00&quot;, &quot;#ff0000&quot;, &quot;#075aaa&quot;)) +</div><div class="line">  theme(panel.background = element_rect(fill = &quot;#05050f&quot;, colour = &quot;#05050f&quot;), </div><div class="line">        panel.grid.major = element_blank(),</div><div class="line">        panel.grid.minor = element_blank(), </div><div class="line">        axis.title = element_blank(), </div><div class="line">        axis.text = element_blank(), </div><div class="line">        axis.ticks.length = unit(0, &quot;cm&quot;),</div><div class="line">        legend.position = &quot;none&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -4, hjust = 0, size = 14, </div><div class="line">           label = paste(&quot;Lufthansa&quot;), color = &quot;#f9ba00&quot;, family = &quot;Helvetica Black&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -11, hjust = 0, size = 14, </div><div class="line">           label = paste(&quot;Emirates&quot;), color = &quot;#ff0000&quot;, family = &quot;Fontin&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -18, hjust = 0, size = 14, </div><div class="line">           label = paste(&quot;BRITISH AIRWAYS&quot;), color = &quot;#075aaa&quot;, family = &quot;Baker Signet Std&quot;) + </div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -30, hjust = 0, size = 8, </div><div class="line">           label = paste(&quot;Flight routes&quot;), color = &quot;white&quot;) +</div><div class="line">  annotate(&quot;text&quot;, x = -150, y = -34, hjust = 0, size = 7, </div><div class="line">           label = paste(&quot;ytlogos.github.io || NASA.gov || OpenFlights.org&quot;), color = &quot;white&quot;, alpha = 0.5) +</div><div class="line">  coord_equal()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180207/6HckGG7Jfc.png?imageslim" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">R version 3.4.3 (2017-11-30)</div><div class="line">Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">Running under: Windows &gt;= 8 x64 (build 9200)</div><div class="line"></div><div class="line">Matrix products: default</div><div class="line"></div><div class="line">locale:</div><div class="line">[1] LC_COLLATE=Chinese (Simplified)_China.936  LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">[3] LC_MONETARY=Chinese (Simplified)_China.936 LC_NUMERIC=C                              </div><div class="line">[5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line"></div><div class="line">attached base packages:</div><div class="line">[1] grid      stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line"></div><div class="line">other attached packages:</div><div class="line"> [1] plyr_1.8.4          jpeg_0.1-8          geosphere_1.5-7     data.table_1.10.4-3</div><div class="line"> [5] forcats_0.2.0       stringr_1.2.0       dplyr_0.7.4         purrr_0.2.4        </div><div class="line"> [9] readr_1.1.1         tidyr_0.8.0         tibble_1.4.2        ggplot2_2.2.1.9000 </div><div class="line">[13] tidyverse_1.2.1     pacman_0.4.6       </div><div class="line"></div><div class="line">loaded via a namespace (and not attached):</div><div class="line"> [1] Rcpp_0.12.15      cellranger_1.1.0  pillar_1.1.0      compiler_3.4.3    bindr_0.1        </div><div class="line"> [6] tools_3.4.3       lubridate_1.7.1   jsonlite_1.5      nlme_3.1-131      gtable_0.2.0     </div><div class="line">[11] lattice_0.20-35   pkgconfig_2.0.1   rlang_0.1.6       psych_1.7.8       cli_1.0.0        </div><div class="line">[16] rstudioapi_0.7    yaml_2.1.16       parallel_3.4.3    haven_1.1.1       bindrcpp_0.2     </div><div class="line">[21] xml2_1.2.0        httr_1.3.1        knitr_1.19        hms_0.4.1         glue_1.2.0       </div><div class="line">[26] R6_2.2.2          readxl_1.0.0      foreign_0.8-69    sp_1.2-7          modelr_0.1.1     </div><div class="line">[31] reshape2_1.4.3    magrittr_1.5      scales_0.5.0.9000 rvest_0.3.2       assertthat_0.2.0 </div><div class="line">[36] mnormt_1.5-5      colorspace_1.3-2  stringi_1.1.6     lazyeval_0.2.1    munsell_0.4.3    </div><div class="line">[41] broom_0.4.3       crayon_1.3.4</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410</p>
<p>Email: tyan@zju.edu.cn</p>
<p>QQ: 1051927088</p>
<p>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a></p>
<p>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a></p>
<p>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180207/6HckGG7Jfc.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;本文基于&lt;strong&gt;NASA&lt;/strong&gt;的&lt;a href=&quot;https://www.nasa.gov/specials/blackmarble/2016/globalmaps/BlackMarble_2016_01deg.jpg&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;夜间地图&lt;/a&gt;的基础上进行世界航班路线可视化，参考多篇博客以及可视化案例。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="地图" scheme="https://ytlogos.github.io/tags/%E5%9C%B0%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>R语言可视化学习笔记之gganimate包</title>
    <link href="https://ytlogos.github.io/2018/02/06/R%E8%AF%AD%E8%A8%80%E5%8F%AF%E8%A7%86%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bgganimate%E5%8C%85/"/>
    <id>https://ytlogos.github.io/2018/02/06/R语言可视化学习笔记之gganimate包/</id>
    <published>2018-02-06T06:19:05.000Z</published>
    <updated>2018-02-06T09:30:29.592Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180206/kHCkkicfkh.gif" alt="mark"></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><a href="https://github.com/dgrtwo/gganimate" target="_blank" rel="external"><strong>gganimate</strong></a>包是<strong>ggplot2</strong>的扩展包，主要用于绘制动画。它在<strong>ggplot2</strong>的基础上了补充了一个美学映射<code>frame</code>，就像x,y,size,color,fill一样进行映射。</p>
<a id="more"></a>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">if(!require(devtools)) install.packages(&quot;devtools&quot;)</div><div class="line">devtools::install_github(&quot;dgrtwo/gganimate&quot;)</div></pre></td></tr></table></figure>
<blockquote>
<p>需要注意的是这个包依赖于<strong>ImageMagick</strong>来产生动画，如果自行安装的话在调用<strong>ImageMagick</strong>很容易出错，所以推荐在<strong>RStudio</strong>里面安装。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">install.packages(&quot;installr&quot;)</div><div class="line">installr::install.ImageMagick(&quot;http://www.imagemagick.org/script/download.php&quot;)</div></pre></td></tr></table></figure>
<p>安装好之后以管理员身份运行<strong>RStudio</strong></p>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><p>这里我们使用<strong>gapminder</strong>包里的数据集<code>gapminder</code>进行可视化<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(gapminder)</div><div class="line">library(ggplot2)</div><div class="line">library(gganimate)</div><div class="line">theme_set(theme_bw())</div><div class="line">head(gapminder)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># A tibble: 6 x 6</div><div class="line">  country     continent  year lifeExp      pop gdpPercap</div><div class="line">  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</div><div class="line">1 Afghanistan Asia       1952    28.8  8425333       779</div><div class="line">2 Afghanistan Asia       1957    30.3  9240934       821</div><div class="line">3 Afghanistan Asia       1962    32.0 10267083       853</div><div class="line">4 Afghanistan Asia       1967    34.0 11537966       836</div><div class="line">5 Afghanistan Asia       1972    36.1 13079460       740</div><div class="line">6 Afghanistan Asia       1977    38.4 14880372       786</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">p &lt;- ggplot(gapminder, aes(gdpPercap, lifeExp, size=pop, color=continent,frame=year))+</div><div class="line">  geom_point()+</div><div class="line">  scale_x_log10()</div><div class="line"> gganimate(p)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180206/cIEhbkd1CE.gif" alt="mark"></p>
<p>不管动画中的图形如何移动，坐标轴、图例等都是固定的。</p>
<h2 id="定制化"><a href="#定制化" class="headerlink" title="定制化"></a>定制化</h2><p>将<strong>gganimate</strong>与<strong>ggplot2</strong>结合起来可以定制化很多复杂的动画</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">p2 &lt;- ggplot(gapminder, aes(gdpPercap, lifeExp, size=pop))+</div><div class="line">  geom_point()+</div><div class="line">  geom_point(aes(frame=year), color=&quot;red&quot;)+</div><div class="line">  scale_x_log10()</div><div class="line">gganimate(p2)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180206/lcD6kdcA73.gif" alt="mark"></p>
<p>如果要绘制累积效果图，<strong>gganimate</strong>提供了<code>cumalative</code>参数，这对于路径图来说十分是有效的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">p3 &lt;- ggplot(gapminder, aes(gdpPercap, lifeExp, frame=year, color=continent))+</div><div class="line">  geom_path(aes(cumulative=TRUE, group=country))+</div><div class="line">  scale_x_log10()+</div><div class="line">  facet_wrap(~continent)</div><div class="line">gganimate(p3)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180206/D2g6l8d18K.gif" alt="mark"></p>
<p>一般来说我们都是将时间映射给<code>frame</code>，这也符合我们的直觉，但是这并不意味着我们只能将时间映射给<code>frame</code>，我们可以将任何想要的变量映射给<code>frame</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">p4 &lt;- ggplot(gapminder, aes(gdpPercap, lifeExp, size=pop, frame=continent))+</div><div class="line">  geom_point(color=&quot;blue&quot;)+</div><div class="line">  scale_x_log10()</div><div class="line">gganimate(p4)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180206/jcbklhff47.gif" alt="mark"></p>
<blockquote>
<p>需要注意的是如何我们绘制的图形涉及到统计汇总比如geom_smooth()，那么在geom_smooth()图层中需要添加group映射。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">p5 &lt;- ggplot(gapminder,aes(gdpPercap, lifeExp, size=pop, frame=year))+</div><div class="line">  geom_point()+</div><div class="line">  geom_smooth(aes(group=year),method = &quot;lm&quot;, show.legend = FALSE)+</div><div class="line">  facet_wrap(~continent, scales = &quot;free&quot;)+</div><div class="line">  scale_x_log10()</div><div class="line">gganimate(p5)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180206/Hb2aac620H.gif" alt="mark"></p>
<p>最后如果需要控制动画播放速度，使用<code>interval</code>参数控制</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gganimate(p, interval = .2)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180206/kHCkkicfkh.gif" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">R version 3.4.3 (2017-11-30)</div><div class="line">Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">Running under: Windows &gt;= 8 x64 (build 9200)</div><div class="line"></div><div class="line">Matrix products: default</div><div class="line"></div><div class="line">locale:</div><div class="line">[1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">[2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">[3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">[4] LC_NUMERIC=C                              </div><div class="line">[5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line"></div><div class="line">attached base packages:</div><div class="line">[1] stats     graphics  grDevices utils     datasets  methods  </div><div class="line">[7] base     </div><div class="line"></div><div class="line">other attached packages:</div><div class="line">[1] gganimate_0.1.0.9000 ggplot2_2.2.1.9000  </div><div class="line">[3] gapminder_0.3.0     </div><div class="line"></div><div class="line">loaded via a namespace (and not attached):</div><div class="line"> [1] Rcpp_0.12.15      rstudioapi_0.7    magrittr_1.5     </div><div class="line"> [4] munsell_0.4.3     colorspace_1.3-2  rlang_0.1.6      </div><div class="line"> [7] stringr_1.2.0     plyr_1.8.4        tools_3.4.3      </div><div class="line">[10] grid_3.4.3        gtable_0.2.0      utf8_1.1.3       </div><div class="line">[13] cli_1.0.0         withr_2.1.1.9000  htmltools_0.3.6  </div><div class="line">[16] yaml_2.1.16       lazyeval_0.2.1    assertthat_0.2.0 </div><div class="line">[19] digest_0.6.15     tibble_1.4.2      crayon_1.3.4     </div><div class="line">[22] base64enc_0.1-3   animation_2.5     labeling_0.3     </div><div class="line">[25] stringi_1.1.6     compiler_3.4.3    pillar_1.1.0     </div><div class="line">[28] installr_0.19.0   scales_0.5.0.9000</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410</p>
<p>Email: tyan@zju.edu.cn</p>
<p>QQ: 1051927088</p>
<p>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a></p>
<p>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a></p>
<p>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180206/kHCkkicfkh.gif&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/dgrtwo/gganimate&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;strong&gt;gganimate&lt;/strong&gt;&lt;/a&gt;包是&lt;strong&gt;ggplot2&lt;/strong&gt;的扩展包，主要用于绘制动画。它在&lt;strong&gt;ggplot2&lt;/strong&gt;的基础上了补充了一个美学映射&lt;code&gt;frame&lt;/code&gt;，就像x,y,size,color,fill一样进行映射。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="gganimate" scheme="https://ytlogos.github.io/tags/gganimate/"/>
    
  </entry>
  
  <entry>
    <title>R语言可视化学习笔记之ggridges包</title>
    <link href="https://ytlogos.github.io/2018/02/05/R%E8%AF%AD%E8%A8%80%E5%8F%AF%E8%A7%86%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bggridges%E5%8C%85/"/>
    <id>https://ytlogos.github.io/2018/02/05/R语言可视化学习笔记之ggridges包/</id>
    <published>2018-02-05T06:19:05.000Z</published>
    <updated>2018-02-05T06:47:15.776Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180205/bhlKJ09j0e.png?imageslim" alt="mark"></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><strong>ggridges</strong>包主要用来绘制山峦图。尤其是针对时间或者空间分布份可视化具有十分好的效果。<strong>ggridges</strong>主要提供两个几何图像函数：</p>
<ul>
<li>geom_ridgeline():主要绘制山脊线图</li>
<li>geom_density_ridges()：主要根据密度绘制山脊线图</li>
</ul>
<p>具体用法可以参考<a href="https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html" target="_blank" rel="external">官方文档</a></p>
<a id="more"></a>
<h2 id="geom-ridgeline"><a href="#geom-ridgeline" class="headerlink" title="geom_ridgeline()"></a>geom_ridgeline()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">library(ggridges)</div><div class="line">library(tidyverse)</div><div class="line">library(gridExtra)</div><div class="line">my_data &lt;- data.frame(x=1:5, y=rep(1,5), height=c(0,1,-1,3,2))</div><div class="line">plot_base &lt;- ggplot(my_data, aes(x, y, height=height))</div><div class="line">grid.arrange(plot_base+geom_ridgeline(), </div><div class="line">             plot_base+geom_ridgeline(min_height=-2), ncol=2)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180205/JjFA48a46m.png?imageslim" alt="mark"></p>
<h2 id="geom-density-ridges"><a href="#geom-density-ridges" class="headerlink" title="geom_density_ridges()"></a>geom_density_ridges()</h2><p>geom_density_ridges()函数首先会根据数据计算密度然后绘图，此时美学映射<code>height</code>没有必要写入函数中。下面使用<strong>lincoln_weather</strong>数据集。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(viridis)</div><div class="line">head(lincoln_weather[ ,1:4])</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">## # A tibble: 6 x 4</div><div class="line">##   CST      `Max Temperature [F]` `Mean Temperature [F]` `Min Temperature ~</div><div class="line">##   &lt;chr&gt;                    &lt;int&gt;                  &lt;int&gt;              &lt;int&gt;</div><div class="line">## 1 2016-1-1                    37                     24                 11</div><div class="line">## 2 2016-1-2                    41                     23                  5</div><div class="line">## 3 2016-1-3                    37                     23                  8</div><div class="line">## 4 2016-1-4                    30                     17                  4</div><div class="line">## 5 2016-1-5                    38                     29                 19</div><div class="line">## 6 2016-1-6                    34                     33                 32</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">ggplot(lincoln_weather, aes(x=`Mean Temperature [F]`, y=`Month`, fill=..x..))+</div><div class="line">  geom_density_ridges_gradient(scale=3, rel_min_height=0.01, gradient_lwd = 1.)+</div><div class="line">  scale_x_continuous(expand = c(0.01, 0))+</div><div class="line">  scale_y_discrete(expand = c(0.01,0))+</div><div class="line">  scale_fill_viridis(name=&quot;Temp. [F]&quot;, option = &quot;C&quot;)+</div><div class="line">  labs(title=&quot;Temperature in Lincoln NE&quot;,</div><div class="line">       subtitle=&quot;Mean temperature (Fahrenheit) by month for 2016\nData:Orogin CSV from the Weather Underground &quot;)+</div><div class="line">  theme_ridges(font_size = 13, grid = FALSE)+</div><div class="line">  theme(axis.title.y = element_blank())</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180205/bhlKJ09j0e.png?imageslim" alt="mark"></p>
<h2 id="cyclinal-scales"><a href="#cyclinal-scales" class="headerlink" title="cyclinal scales"></a>cyclinal scales</h2><p>为了使得<strong>ggridges</strong>绘制的图形可视化效果最好，同时为了减少用户对颜色设置的困难，作者提供了<strong>cyclinal scales</strong>用于颜色轮转映射。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ggplot(diamonds, aes(x=price, y=cut, fill=cut))+</div><div class="line">  geom_density_ridges(scale=4)+</div><div class="line">  scale_fill_cyclical(values = c(&quot;blue&quot;, &quot;green&quot;))+</div><div class="line">  theme_ridges(grid = FALSE)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180205/ljf8Gcjh08.png?imageslim" alt="mark"></p>
<p>默认的，<strong>cyclinal scales</strong>为了防止误解是不绘制图例的，但是可以通过选项<code>guide=&quot;legend&quot;</code>添加图例。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ggplot(diamonds, aes(x=price, y=cut, fill=cut))+</div><div class="line">  geom_density_ridges(scale=4)+</div><div class="line">  scale_fill_cyclical(values = c(&quot;blue&quot;, &quot;green&quot;), guide=&quot;legend&quot;)+</div><div class="line">  theme_ridges(grid = FALSE)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180205/iGh734gaCG.png?imageslim" alt="mark"></p>
<p>跟<strong>ggplot2</strong>一样，图例是可以修改的,其他参数比如大小、透明度、形状等都是可以通过<strong>cyclinal scales</strong>修改。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ggplot(diamonds, aes(x=price, y=cut, fill=cut))+</div><div class="line">  geom_density_ridges(scale=4)+</div><div class="line">  scale_fill_cyclical(values = c(&quot;blue&quot;, &quot;green&quot;), guide=&quot;legend&quot;,</div><div class="line">                      labels=c(&quot;Fair&quot;=&quot;blue&quot;, &quot;Good&quot;=&quot;green&quot;),</div><div class="line">                      name=&quot;Fill colors&quot;)+</div><div class="line">  theme_ridges(grid = FALSE)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180205/5kmJIcg7EB.png?imageslim" alt="mark"></p>
<p>还有很多用法有兴趣的可以查看<a href="https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html" target="_blank" rel="external">官方文档</a>继续学习。</p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">##  [1] viridis_0.5.0       viridisLite_0.3.0   gridExtra_2.3      </div><div class="line">##  [4] forcats_0.2.0       stringr_1.2.0       dplyr_0.7.4        </div><div class="line">##  [7] purrr_0.2.4         readr_1.1.1         tidyr_0.8.0        </div><div class="line">## [10] tibble_1.4.2        tidyverse_1.2.1     ggridges_0.4.1.9990</div><div class="line">## [13] ggplot2_2.2.1.9000 </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] reshape2_1.4.3    haven_1.1.1       lattice_0.20-35  </div><div class="line">##  [4] colorspace_1.3-2  htmltools_0.3.6   yaml_2.1.16      </div><div class="line">##  [7] utf8_1.1.3        rlang_0.1.6       pillar_1.1.0     </div><div class="line">## [10] foreign_0.8-69    glue_1.2.0        modelr_0.1.1     </div><div class="line">## [13] readxl_1.0.0      bindrcpp_0.2      bindr_0.1        </div><div class="line">## [16] plyr_1.8.4        munsell_0.4.3     gtable_0.2.0     </div><div class="line">## [19] cellranger_1.1.0  rvest_0.3.2       psych_1.7.8      </div><div class="line">## [22] evaluate_0.10.1   labeling_0.3      knitr_1.19       </div><div class="line">## [25] parallel_3.4.3    broom_0.4.3       Rcpp_0.12.15     </div><div class="line">## [28] scales_0.5.0.9000 backports_1.1.2   jsonlite_1.5     </div><div class="line">## [31] mnormt_1.5-5      hms_0.4.1         digest_0.6.15    </div><div class="line">## [34] stringi_1.1.6     grid_3.4.3        rprojroot_1.3-2  </div><div class="line">## [37] cli_1.0.0         tools_3.4.3       magrittr_1.5     </div><div class="line">## [40] lazyeval_0.2.1    crayon_1.3.4      pkgconfig_2.0.1  </div><div class="line">## [43] xml2_1.2.0        lubridate_1.7.1   assertthat_0.2.0 </div><div class="line">## [46] rmarkdown_1.8     httr_1.3.1        rstudioapi_0.7   </div><div class="line">## [49] R6_2.2.2          nlme_3.1-131      compiler_3.4.3</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410</p>
<p>Email: tyan@zju.edu.cn</p>
<p>QQ: 1051927088</p>
<p>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a></p>
<p>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a></p>
<p>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180205/bhlKJ09j0e.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;ggridges&lt;/strong&gt;包主要用来绘制山峦图。尤其是针对时间或者空间分布份可视化具有十分好的效果。&lt;strong&gt;ggridges&lt;/strong&gt;主要提供两个几何图像函数：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;geom_ridgeline():主要绘制山脊线图&lt;/li&gt;
&lt;li&gt;geom_density_ridges()：主要根据密度绘制山脊线图&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;具体用法可以参考&lt;a href=&quot;https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官方文档&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="ggridges" scheme="https://ytlogos.github.io/tags/ggridges/"/>
    
  </entry>
  
  <entry>
    <title>Shell编程：数组</title>
    <link href="https://ytlogos.github.io/2018/02/04/Shell%E7%BC%96%E7%A8%8B%EF%BC%9A%E6%95%B0%E7%BB%84/"/>
    <id>https://ytlogos.github.io/2018/02/04/Shell编程：数组/</id>
    <published>2018-02-04T13:19:05.000Z</published>
    <updated>2018-02-27T14:23:57.504Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://os3hnmzbp.bkt.clouddn.com/数组.png" alt="数组"></p>
<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><p>数组中可以存放多个值。Bash只支持一维数组，初始化时无需定义数组大小，数组元素下标从0开始。Shell数组用括号表示，元素之间由空号隔开：</p>
<a id="more"></a>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">array_name=(value1 value2 ... valuen)</div></pre></td></tr></table></figure>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><h3 id="创建数据"><a href="#创建数据" class="headerlink" title="创建数据"></a>创建数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">my_array=(A B &quot;C&quot; D)</div></pre></td></tr></table></figure>
<p>也可以通过下标赋值来定义数组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">array_name[0]=value0</div><div class="line">array_name[1]=value1</div><div class="line">array_name[2]=value2</div></pre></td></tr></table></figure>
<h3 id="读取数组"><a href="#读取数组" class="headerlink" title="读取数组"></a>读取数组</h3><p>读取数组的一般格式为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$&#123;array_name[index]&#125;</div></pre></td></tr></table></figure>
<p>现在创建一个脚本<code>test.sh</code>来演示一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#！/bin/bash</div><div class="line">#创建脚本test.sh</div><div class="line">my_array=(A B &quot;C&quot; D)</div><div class="line">echo &quot;第一个元素为：$&#123;my_array[0]&#125;&quot;</div><div class="line">echo &quot;第二个元素为：$&#123;my_array[1]&#125;&quot;</div><div class="line">echo &quot;第三个元素为：$&#123;my_array[2]&#125;&quot;</div><div class="line">echo &quot;第四个元素为：$&#123;my_array[3]&#125;&quot;</div></pre></td></tr></table></figure>
<p>执行脚本结果如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ chmod +x test.sh </div><div class="line">$ ./test.sh </div><div class="line">第一个元素为：A</div><div class="line">第二个元素为：B</div><div class="line">第三个元素为：C</div><div class="line">第四个元素为：D</div></pre></td></tr></table></figure></p>
<h3 id="获取数组中所有元素"><a href="#获取数组中所有元素" class="headerlink" title="获取数组中所有元素"></a>获取数组中所有元素</h3><p>使用@或者*可以获取数组中的所有元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># 创建脚本test.sh</div><div class="line"></div><div class="line">my_array[0]=A</div><div class="line">my_array[1]=B</div><div class="line">my_array[2]=C</div><div class="line">my_array[3]=D</div><div class="line"></div><div class="line">echo &quot;数组的元素为: $&#123;my_array[*]&#125;&quot;</div><div class="line">echo &quot;数组的元素为: $&#123;my_array[@]&#125;&quot;</div></pre></td></tr></table></figure>
<p>执行脚本结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ ./test.sh </div><div class="line">数组的元素为: A B C D</div><div class="line">数组的元素为: A B C D</div></pre></td></tr></table></figure></p>
<h3 id="获取数组长度"><a href="#获取数组长度" class="headerlink" title="获取数组长度"></a>获取数组长度</h3><p>获取数组长度的方法与获取字符串长度的方法相同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># 创建脚本test.sh</div><div class="line"></div><div class="line">my_array[0]=A</div><div class="line">my_array[1]=B</div><div class="line">my_array[2]=C</div><div class="line">my_array[3]=D</div><div class="line"></div><div class="line">echo &quot;数组元素个数为: $&#123;#my_array[*]&#125;&quot;</div><div class="line">echo &quot;数组元素个数为: $&#123;#my_array[@]&#125;&quot;</div></pre></td></tr></table></figure>
<p>执行脚本结果如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ ./test.sh </div><div class="line">数组元素个数为: 4</div><div class="line">数组元素个数为: 4</div></pre></td></tr></table></figure></p>
<h3 id="数组的值也可以写入变量"><a href="#数组的值也可以写入变量" class="headerlink" title="数组的值也可以写入变量"></a>数组的值也可以写入变量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># 创建脚本test.sh</div><div class="line"></div><div class="line">A=1</div><div class="line">my_array=($A B C D)</div><div class="line">echo &quot;第一个元素为：$&#123;my_array[0]&#125;&quot;</div><div class="line">echo &quot;第二个元素为：$&#123;my_array[1]&#125;&quot;</div><div class="line">echo &quot;第三个元素为：$&#123;my_array[2]&#125;&quot;</div><div class="line">echo &quot;第四个元素为：$&#123;my_array[3]&#125;&quot;</div></pre></td></tr></table></figure>
<p>执行脚本结果如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ ./test.sh </div><div class="line">第一个元素为：1</div><div class="line">第二个元素为：B</div><div class="line">第三个元素为：C</div><div class="line">第四个元素为：D</div></pre></td></tr></table></figure></p>
<h3 id="数组下标也可以为变量"><a href="#数组下标也可以为变量" class="headerlink" title="数组下标也可以为变量"></a>数组下标也可以为变量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># 创建脚本test.sh</div><div class="line"></div><div class="line">my_array=(A B C D)</div><div class="line"></div><div class="line">i=2</div><div class="line">echo $&#123;my_array[i]&#125;</div></pre></td></tr></table></figure>
<p>执行脚本结果如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ./test.sh </div><div class="line">C</div></pre></td></tr></table></figure>
<h3 id="数组遍历"><a href="#数组遍历" class="headerlink" title="数组遍历"></a>数组遍历</h3><p>这里讲解几种方法用于数据遍历</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># 创建演示脚本test.sh</div><div class="line">my_array=(A B C D E F G)</div><div class="line">echo &quot;---------for循环遍历数组-----------&quot;</div><div class="line">for i in $&#123;my_array[@]&#125;</div><div class="line">do</div><div class="line">        echo $i</div><div class="line">done</div><div class="line"></div><div class="line">echo &quot;--------while循环遍历数组，使用let i++自增-------------&quot;</div><div class="line">i=0</div><div class="line">#注意[与$之间要有空格，否则报错,下同</div><div class="line">while [ $i -lt $&#123;#my_array[@]&#125; ]</div><div class="line">do</div><div class="line">        echo $&#123;my_array[$i]&#125;</div><div class="line">        let i++</div><div class="line">done</div><div class="line"></div><div class="line">echo &quot;-------while循环遍历数组，使用let &quot;n++ &quot;自增：双引号可有可无，推荐加上双引号-----------&quot;</div><div class="line">n=0</div><div class="line">while [ $n -lt $&#123;#my_array[@]&#125; ]</div><div class="line">do</div><div class="line">        echo $&#123;my_array[$n]&#125;</div><div class="line">        let &quot;n++&quot;</div><div class="line">done</div><div class="line"></div><div class="line">echo &quot;-----------while循环遍历数组，使用let m+=1自增--------------&quot;</div><div class="line"></div><div class="line">m=0</div><div class="line">while [ $m -lt $&#123;#my_array[@]&#125; ]</div><div class="line">do</div><div class="line">        echo $&#123;my_array[$m]&#125;</div><div class="line">        let m+=1</div><div class="line">done</div><div class="line"></div><div class="line">echo &quot;------------------while循环遍历数组，使用a=$[$a+1]自增------------------&quot;</div><div class="line">a=0</div><div class="line">while [ $a -lt $&#123;#my_array[@]&#125; ]</div><div class="line">do</div><div class="line">        echo $&#123;my_array[$a]&#125;</div><div class="line">        a=$[$a+1]</div><div class="line">done</div></pre></td></tr></table></figure>
<p>执行脚本结果如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">$ ./test.sh </div><div class="line">---------for循环遍历数组-----------</div><div class="line">A</div><div class="line">B</div><div class="line">C</div><div class="line">D</div><div class="line">E</div><div class="line">F</div><div class="line">G</div><div class="line">--------while循环遍历数组，使用let i++自增-------------</div><div class="line">A</div><div class="line">B</div><div class="line">C</div><div class="line">D</div><div class="line">E</div><div class="line">F</div><div class="line">G</div><div class="line">-------while循环遍历数组，使用let n++ 自增：双引号可有可无，推荐加上双引号-----------</div><div class="line">A</div><div class="line">B</div><div class="line">C</div><div class="line">D</div><div class="line">E</div><div class="line">F</div><div class="line">G</div><div class="line">-----------while循环遍历数组，使用let m+=1自增--------------</div><div class="line">A</div><div class="line">B</div><div class="line">C</div><div class="line">D</div><div class="line">E</div><div class="line">F</div><div class="line">G</div><div class="line">------------------while循环遍历数组，使用a=$[$a+1]自增------------------</div><div class="line">A</div><div class="line">B</div><div class="line">C</div><div class="line">D</div><div class="line">E</div><div class="line">F</div><div class="line">G</div></pre></td></tr></table></figure></p>
<p>可以看出各种遍历方法大同小异，区别就在于自增方式的不同</p>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://os3hnmzbp.bkt.clouddn.com/数组.png&quot; alt=&quot;数组&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;数组&quot;&gt;&lt;a href=&quot;#数组&quot; class=&quot;headerlink&quot; title=&quot;数组&quot;&gt;&lt;/a&gt;数组&lt;/h2&gt;&lt;p&gt;数组中可以存放多个值。Bash只支持一维数组，初始化时无需定义数组大小，数组元素下标从0开始。Shell数组用括号表示，元素之间由空号隔开：&lt;/p&gt;
    
    </summary>
    
      <category term="Shell" scheme="https://ytlogos.github.io/categories/Shell/"/>
    
    
      <category term="数组" scheme="https://ytlogos.github.io/tags/%E6%95%B0%E7%BB%84/"/>
    
  </entry>
  
  <entry>
    <title>Shell编程：变量</title>
    <link href="https://ytlogos.github.io/2018/02/03/Shell/"/>
    <id>https://ytlogos.github.io/2018/02/03/Shell/</id>
    <published>2018-02-03T13:19:05.000Z</published>
    <updated>2018-03-06T02:58:44.022Z</updated>
    
    <content type="html"><![CDATA[<div class="output_wrapper" id="output_wrapper_id" style="font-size: 16px; color: rgb(62, 62, 62); line-height: 1.6; word-spacing: 0px; letter-spacing: 0px; font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;"><figure style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180205/gfihd4EIE0.png?imageslim" alt="" title="" style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;"><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;"></figcaption></figure><br><h3 id="hshell" style="line-height: inherit; margin: 1.5em 0px; font-weight: bold; font-size: 1.3em; margin-bottom: 2em; margin-right: 5px; padding: 8px 15px; letter-spacing: 2px; background-image: linear-gradient(to right bottom, rgb(0, 188, 212), rgb(63, 81, 181)); background-color: rgb(63, 81, 181); color: rgb(255, 255, 255); border-left: 10px solid rgb(51, 51, 51); border-radius: 5px; text-shadow: rgb(102, 102, 102) 1px 1px 1px; box-shadow: rgb(102, 102, 102) 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">shell传递参数</span></h3><br><p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">执行shell脚本时，向脚本传递参数，脚本内获取参数的格式为：$n。n代表数字，1为执行脚本的第一个参数，2为第二个，以此类推。</p><br><a id="more"></a><br><h3 id="h-1" style="line-height: inherit; margin: 1.5em 0px; font-weight: bold; font-size: 1.3em; margin-bottom: 2em; margin-right: 5px; padding: 8px 15px; letter-spacing: 2px; background-image: linear-gradient(to right bottom, rgb(0, 188, 212), rgb(63, 81, 181)); background-color: rgb(63, 81, 181); color: rgb(255, 255, 255); border-left: 10px solid rgb(51, 51, 51); border-radius: 5px; text-shadow: rgb(102, 102, 102) 1px 1px 1px; box-shadow: rgb(102, 102, 102) 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">实例</span></h3><br><p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">下面实例我们向脚本传递三个参数并分别输出，其中$0为执行的文件名：<br>新建一个脚本canshu.sh</p><br><pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="hljs bash" style="margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; color: rgb(169, 183, 198); background: rgb(40, 43, 46); overflow-x: auto; padding: 0.5em; display: block !important; white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important;"><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(91, 218, 237); word-wrap: inherit !important; word-break: inherit !important;">#!/bin/bash</span><br><span class="hljs-built_in" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">echo</span> <span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">“Shell 传递参数实例！”</span><br><span class="hljs-built_in" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">echo</span> <span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">“执行的文件名：<span class="hljs-variable" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 151, 85); word-wrap: inherit !important; word-break: inherit !important;">$0</span>“</span><br><span class="hljs-built_in" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">echo</span> <span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">“第一个参数为：<span class="hljs-variable" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 151, 85); word-wrap: inherit !important; word-break: inherit !important;">$1</span>“</span><br><span class="hljs-built_in" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">echo</span> <span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">“第二个参数为：<span class="hljs-variable" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 151, 85); word-wrap: inherit !important; word-break: inherit !important;">$2</span>“</span><br><span class="hljs-built_in" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">echo</span> <span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">“第三个参数为：<span class="hljs-variable" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 151, 85); word-wrap: inherit !important; word-break: inherit !important;">$3</span>“</span><br></code></pre><br><p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">运行：</p><br><pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="hljs ruby" style="margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; color: rgb(169, 183, 198); background: rgb(40, 43, 46); overflow-x: auto; padding: 0.5em; display: block !important; white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important;">$ ./canshu.sh <span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span> <span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">2</span> <span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">3</span><br>Shell 传递参数实例！<br>执行的文件名：./canshu.sh<br>第一个参数为：<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span><br>第二个参数为：<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">2</span><br>第三个参数为：<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">3</span><br></code></pre><br><blockquote style="line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(129, 145, 152); border-left: 6px solid rgb(220, 230, 240); background: rgb(242, 247, 251); overflow: auto; word-wrap: normal; word-break: normal;"><br>  <p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;">特殊字符处理参数</p><br></blockquote><br><table style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table; width: 100%; text-align: left;"><br><thead style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><br><tr style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: white;"><br><th style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left; font-weight: bold; background-color: rgb(240, 240, 240);">参数处理</th><br><th style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left; font-weight: bold; background-color: rgb(240, 240, 240);">说明</th><br></tr><br></thead><br><tbody style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; border: 0px;"><br><tr style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: white;"><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">$#</td><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">传递到脚本的参数个数</td><br></tr><br><tr style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: white;"><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">$<em></em></td><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">以一个单字符串显示所有向脚本传递的参数,以”<span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><span class="katex" style="font-family: Consolas, Inconsolata, Courier, monospace; white-space: nowrap; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><span class="katex-mathml" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;"></span><span class="katex-html" aria-hidden="true" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block;"><span class="strut" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em;"></span><span class="strut bottom" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;"></span><span class="base" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block;"><span class="mord mathrm" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-style: normal;">1</span></span></span></span></span>2 … $n”输出所有参数</td><br></tr><br><tr style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: white;"><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><span class="katex" style="font-family: Consolas, Inconsolata, Courier, monospace; white-space: nowrap; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><span class="katex-mathml" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;"></span><span class="katex-html" aria-hidden="true" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block;"><span class="strut" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0em;"></span><span class="strut bottom" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0em; vertical-align: 0em;"></span><span class="base" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block;"></span></span></span></span></td><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">脚本运行的当前进程ID号</td><br></tr><br><tr style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: white;"><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">$!</td><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">后台运行的最后一个进程ID号</td><br></tr><br><tr style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: white;"><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">$@</td><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">类似于$,但是以”$1” “\$2” … “\$n”输出参数</td><br></tr><br><tr style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: white;"><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">$-</td><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">显示shell使用的当前选项</td><br></tr><br><tr style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: white;"><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">$?</td><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">显示最后命令的退出状态。0表示没有错误，其他任何输出表明有错误</td><br></tr><br><tr style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: white;"><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">—</td><br><td style="color: inherit; line-height: inherit; margin: 0px; font-size: 1em; border: 1px solid rgb(204, 204, 204); padding: 0.5em 1em; text-align: left;">————\</td><br></tr><br></tbody><br></table><br><p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">修改上述脚本canshu.sh</p><br><pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="hljs bash" style="margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; color: rgb(169, 183, 198); background: rgb(40, 43, 46); overflow-x: auto; padding: 0.5em; display: block !important; white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important;"><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(91, 218, 237); word-wrap: inherit !important; word-break: inherit !important;">#!/bin/bash</span><br><span class="hljs-built_in" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">echo</span> <span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">“Shell 传递参数实例！”</span><br><span class="hljs-built_in" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">echo</span> <span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">“第一个参数为：<span class="hljs-variable" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 151, 85); word-wrap: inherit !important; word-break: inherit !important;">$1</span>“</span><br><span class="hljs-built_in" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">echo</span> <span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">“参数个数为：<span class="hljs-variable" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 151, 85); word-wrap: inherit !important; word-break: inherit !important;">$#</span>“</span><br><span class="hljs-built_in" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">echo</span> <span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">“传递的参数作为一个字符串显示：$<em>“</em></span><br></code></pre><br><p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">运行：</p><br><pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="hljs ruby" style="margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; color: rgb(169, 183, 198); background: rgb(40, 43, 46); overflow-x: auto; padding: 0.5em; display: block !important; white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important;">$ ./canshu.sh <span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span> <span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">2</span> <span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">3</span><br>Shell 传递参数实例！<br>第一个参数为：<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span><br>参数个数为：<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">3</span><br>传递的参数作为一个字符串显示：<span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span> <span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">2</span> <span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">3</span><br></code></pre><br><blockquote style="line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(129, 145, 152); border-left: 6px solid rgb(220, 230, 240); background: rgb(242, 247, 251); overflow: auto; word-wrap: normal; word-break: normal;"><br>  <p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;">需要注意的是$与\$@的区别</p><br></blockquote><br><ul style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;"><br><li style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">相同点：都是引用所有参数</span></li><br><li style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">不同点：只有在双引号中体现出来。假设在脚本运行时写了三个参数1、2、3，则”<em>“等价于”1 2 3”（传递了一个参数），而”@”等价于”1”,”2”,”3”(传递了三个参数)</em></span></li><br></ul><br><p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">下面通过一个脚本来说明,新建脚本compare.sh</p><br><pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="hljs bash" style="margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; color: rgb(169, 183, 198); background: rgb(40, 43, 46); overflow-x: auto; padding: 0.5em; display: block !important; white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important;"><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(91, 218, 237); word-wrap: inherit !important; word-break: inherit !important;">#!/bin/bash</span><br><span class="hljs-built_in" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">echo</span> <span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">“– \$ 演示 —“</span><br><span class="hljs-keyword" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">for</span> i <span class="hljs-keyword" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">in</span> <span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">“$<em>“</em></span>;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">do</span><br><span class="hljs-built_in" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">echo</span> <span class="hljs-variable" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 151, 85); word-wrap: inherit !important; word-break: inherit !important;">$i</span><br><span class="hljs-keyword" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">done</span><br><span class="hljs-built_in" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">echo</span> <span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">“– \$@ 演示 —“</span><br><span class="hljs-keyword" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">for</span> i <span class="hljs-keyword" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">in</span> <span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(238, 220, 112); word-wrap: inherit !important; word-break: inherit !important;">“<span class="hljs-variable" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 151, 85); word-wrap: inherit !important; word-break: inherit !important;">$@</span>“</span>;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">do</span><br><span class="hljs-built_in" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">echo</span> <span class="hljs-variable" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 151, 85); word-wrap: inherit !important; word-break: inherit !important;">$i</span><br><span class="hljs-keyword" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(248, 35, 117); word-wrap: inherit !important; word-break: inherit !important;">done</span><br></code></pre><br><p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">运行脚本</p><br><pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="hljs ruby" style="margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; color: rgb(169, 183, 198); background: rgb(40, 43, 46); overflow-x: auto; padding: 0.5em; display: block !important; white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important;">$ ./compare.sh <span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span> <span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">2</span> <span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">3</span><br>– $ 演示 —<br><span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span> <span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">2</span> <span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">3</span><br>– $@ 演示 —<br><span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">1</span><br><span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">2</span><br><span class="hljs-number" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(174, 135, 250); word-wrap: inherit !important; word-break: inherit !important;">3</span><br></code></pre><br><p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">区别一目了然。</p><br><h2 id="h" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; font-size: 1.4em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">联系方式：</span></h2><br><p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;output_wrapper&quot; id=&quot;output_wrapper_id&quot; style=&quot;font-size: 16px; color: rgb(62, 62, 62); line-height: 1.6; word-spacing: 0px; letter-spacing: 0px; font-family: &#39;Helvetica Neue&#39;, Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft YaHei&#39;, Arial, sans-serif;&quot;&gt;&lt;figure style=&quot;font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;&quot;&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180205/gfihd4EIE0.png?imageslim&quot; alt=&quot;&quot; title=&quot;&quot; style=&quot;font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;&quot;&gt;&lt;figcaption style=&quot;line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;&quot;&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;br&gt;&lt;h3 id=&quot;hshell&quot; style=&quot;line-height: inherit; margin: 1.5em 0px; font-weight: bold; font-size: 1.3em; margin-bottom: 2em; margin-right: 5px; padding: 8px 15px; letter-spacing: 2px; background-image: linear-gradient(to right bottom, rgb(0, 188, 212), rgb(63, 81, 181)); background-color: rgb(63, 81, 181); color: rgb(255, 255, 255); border-left: 10px solid rgb(51, 51, 51); border-radius: 5px; text-shadow: rgb(102, 102, 102) 1px 1px 1px; box-shadow: rgb(102, 102, 102) 1px 1px 2px;&quot;&gt;&lt;span style=&quot;font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;&quot;&gt;shell传递参数&lt;/span&gt;&lt;/h3&gt;&lt;br&gt;&lt;p style=&quot;font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;&quot;&gt;执行shell脚本时，向脚本传递参数，脚本内获取参数的格式为：$n。n代表数字，1为执行脚本的第一个参数，2为第二个，以此类推。&lt;/p&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Shell" scheme="https://ytlogos.github.io/categories/Shell/"/>
    
    
  </entry>
  
  <entry>
    <title>Shell编程：传参</title>
    <link href="https://ytlogos.github.io/2018/02/03/Shell%E7%BC%96%E7%A8%8B%EF%BC%9A%E4%BC%A0%E5%8F%82/"/>
    <id>https://ytlogos.github.io/2018/02/03/Shell编程：传参/</id>
    <published>2018-02-03T13:19:05.000Z</published>
    <updated>2018-02-05T12:18:46.856Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180205/gfihd4EIE0.png?imageslim" alt="mark"></p>
<h2 id="shell传递参数"><a href="#shell传递参数" class="headerlink" title="shell传递参数"></a>shell传递参数</h2><p>执行shell脚本时，向脚本传递参数，脚本内获取参数的格式为：$n。n代表数字，1为执行脚本的第一个参数，2为第二个，以此类推。</p>
<a id="more"></a>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>下面实例我们向脚本传递三个参数并分别输出，其中$0为执行的文件名：<br>新建一个脚本canshu.sh</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">echo &quot;Shell 传递参数实例！&quot;</div><div class="line">echo &quot;执行的文件名：$0&quot;</div><div class="line">echo &quot;第一个参数为：$1&quot;</div><div class="line">echo &quot;第二个参数为：$2&quot;</div><div class="line">echo &quot;第三个参数为：$3&quot;</div></pre></td></tr></table></figure>
<p>运行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ ./canshu.sh 1 2 3</div><div class="line">Shell 传递参数实例！</div><div class="line">执行的文件名：./canshu.sh</div><div class="line">第一个参数为：1</div><div class="line">第二个参数为：2</div><div class="line">第三个参数为：3</div></pre></td></tr></table></figure></p>
<blockquote>
<p>特殊字符处理参数</p>
</blockquote>
<table>
<thead>
<tr>
<th>参数处理</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>$#</td>
<td>传递到脚本的参数个数</td>
</tr>
<tr>
<td>$*</td>
<td>以一个单字符串显示所有向脚本传递的参数,以”$1 $2 … $n”输出所有参数</td>
</tr>
<tr>
<td>$$</td>
<td>脚本运行的当前进程ID号</td>
</tr>
<tr>
<td>$!</td>
<td>后台运行的最后一个进程ID号</td>
</tr>
<tr>
<td>$@</td>
<td>类似于$*,但是以”$1” “\$2” … “\$n”输出参数</td>
</tr>
<tr>
<td>$-</td>
<td>显示shell使用的当前选项</td>
</tr>
<tr>
<td>$?</td>
<td>显示最后命令的退出状态。0表示没有错误，其他任何输出表明有错误</td>
</tr>
</tbody>
</table>
<p>修改上述脚本canshu.sh<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">echo &quot;Shell 传递参数实例！&quot;</div><div class="line">echo &quot;第一个参数为：$1&quot;</div><div class="line">echo &quot;参数个数为：$#&quot;</div><div class="line">echo &quot;传递的参数作为一个字符串显示：$*&quot;</div></pre></td></tr></table></figure></p>
<p>运行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ ./canshu.sh 1 2 3</div><div class="line">Shell 传递参数实例！</div><div class="line">第一个参数为：1</div><div class="line">参数个数为：3</div><div class="line">传递的参数作为一个字符串显示：1 2 3</div></pre></td></tr></table></figure></p>
<blockquote>
<p>需要注意的是$*与\$@的区别</p>
</blockquote>
<ul>
<li>相同点：都是引用所有参数</li>
<li>不同点：只有在双引号中体现出来。假设在脚本运行时写了三个参数1、2、3，则”*”等价于”1 2 3”（传递了一个参数），而”@”等价于”1”,”2”,”3”(传递了三个参数)</li>
</ul>
<p>下面通过一个脚本来说明,新建脚本compare.sh<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">echo &quot;-- \$* 演示 ---&quot;</div><div class="line">for i in &quot;$*&quot;;do</div><div class="line">echo $i</div><div class="line">done</div><div class="line"></div><div class="line">echo &quot;-- \$@ 演示 ---&quot;</div><div class="line">for i in &quot;$@&quot;;do</div><div class="line">echo $i</div><div class="line">done</div></pre></td></tr></table></figure></p>
<p>运行脚本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ ./compare.sh 1 2 3</div><div class="line">-- $* 演示 ---</div><div class="line">1 2 3</div><div class="line">-- $@ 演示 ---</div><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td></tr></table></figure></p>
<p>区别一目了然。</p>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180205/gfihd4EIE0.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;shell传递参数&quot;&gt;&lt;a href=&quot;#shell传递参数&quot; class=&quot;headerlink&quot; title=&quot;shell传递参数&quot;&gt;&lt;/a&gt;shell传递参数&lt;/h2&gt;&lt;p&gt;执行shell脚本时，向脚本传递参数，脚本内获取参数的格式为：$n。n代表数字，1为执行脚本的第一个参数，2为第二个，以此类推。&lt;/p&gt;
    
    </summary>
    
      <category term="Shell" scheme="https://ytlogos.github.io/categories/Shell/"/>
    
    
  </entry>
  
  <entry>
    <title>Shell编程：变量</title>
    <link href="https://ytlogos.github.io/2018/02/02/Shell%E7%BC%96%E7%A8%8B%EF%BC%9A%E5%8F%98%E9%87%8F/"/>
    <id>https://ytlogos.github.io/2018/02/02/Shell编程：变量/</id>
    <published>2018-02-02T13:19:05.000Z</published>
    <updated>2018-02-05T05:21:56.946Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180204/7bEcJiH4l2.png?imageslim" alt="mark"></p>
<a id="more"></a>
<h2 id="Shell变量"><a href="#Shell变量" class="headerlink" title="Shell变量"></a>Shell变量</h2><p>定义变量时，变量名不加美元符号<code>$</code>，如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ my_name=&quot;logos&quot;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>需要注意的是，变量名与等号之间不能有空格。同时变量命名遵循以下规则：</p>
</blockquote>
<ul>
<li>只能使用英文字母，数字与下划线，首个字符不能以数字开头</li>
<li>中间不能有空格，可以使用下划线</li>
<li>不能使用标点符号</li>
<li>不能使用bash里的关键字</li>
</ul>
<h2 id="使用变量"><a href="#使用变量" class="headerlink" title="使用变量"></a>使用变量</h2><p>使用已经定义过的变量只需在变量名前加美元符号<code>$</code>即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ echo $my-name</div><div class="line">$ echo $my_name</div><div class="line">logos</div><div class="line">$ echo $&#123;my_name&#125;</div><div class="line">logos</div></pre></td></tr></table></figure></p>
<p>变量名外面的花括号是可选的，加花括号是为了帮助解释器识别变量边界，因此推荐使用花括号。另已经定义过的变量可以重新被定义。</p>
<h2 id="只读变量"><a href="#只读变量" class="headerlink" title="只读变量"></a>只读变量</h2><p>使用<code>readonly</code>命令可以将变量定义为只读变量，只读变量的值不能被改变<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ my_name=&quot;logos&quot;</div><div class="line">$ readonly my_name</div><div class="line">$ my_name=&quot;other&quot;</div><div class="line">zsh: read-only variable: my_name</div></pre></td></tr></table></figure></p>
<h2 id="删除变量"><a href="#删除变量" class="headerlink" title="删除变量"></a>删除变量</h2><p>使用<code>unset</code>命令可以删除变量，但是无法删除只读变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ unset my_name</div></pre></td></tr></table></figure></p>
<h2 id="变量类型"><a href="#变量类型" class="headerlink" title="变量类型"></a>变量类型</h2><p>运行shell时，会同时存在三种变量</p>
<ul>
<li>局部变量：局部变量在脚本或命令中定义，仅在当前shell实例中有效，其他shell启动的程序不能访问局部变量</li>
<li>环境变量：所有程序包括shell启动的程序都能访问环境变量</li>
<li>shell变量：由shell设置的特殊变量。shell变量中一部分是局部变量，一部分是环境变量。这些变量保证shell的正常运行</li>
</ul>
<h2 id="shell字符串"><a href="#shell字符串" class="headerlink" title="shell字符串"></a>shell字符串</h2><p>字符串是最常用的数据类型，可以用单引号、双引号，也可以不用引号。</p>
<h3 id="单引号"><a href="#单引号" class="headerlink" title="单引号"></a>单引号</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ str=&apos;This is a string&apos;</div></pre></td></tr></table></figure>
<p>单引号字符串的限制：</p>
<ul>
<li>单引号里的任意字符都会原样输出，单引号字符串中的变量是无效的</li>
<li>单引号字符串中不能出现单引号,使用转义符也没用</li>
</ul>
<h2 id="双引号"><a href="#双引号" class="headerlink" title="双引号"></a>双引号</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ my_name=&apos;logos&apos;</div><div class="line">$ str=&quot;Hello, I know you are \&quot;$&#123;my_name&#125;\&quot;! \n&quot;</div><div class="line">$ echo $&#123;str&#125;</div><div class="line">Hello, I know you are &quot;logos&quot;!</div></pre></td></tr></table></figure>
<p>双引号的优点：</p>
<ul>
<li>双引号里面可以有变量</li>
<li>双引号里可以出现转义符</li>
</ul>
<h2 id="拼接字符串"><a href="#拼接字符串" class="headerlink" title="拼接字符串"></a>拼接字符串</h2><p>新建一个脚本string.sh<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">my_name=&quot;logos&quot;</div><div class="line">greeting=&quot;hello, &quot;$my_name&quot; !&quot;</div><div class="line">greeting_1=&quot;hello, $&#123;my_name&#125; !&quot;</div><div class="line">echo $greeting $greeting_1</div></pre></td></tr></table></figure></p>
<p>运行脚本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ bash string.sh</div><div class="line">hello, logos ! hello, logos !</div></pre></td></tr></table></figure></p>
<h2 id="获取字符串长度"><a href="#获取字符串长度" class="headerlink" title="获取字符串长度"></a>获取字符串长度</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$string=&quot;abcde&quot;</div><div class="line">$echo $&#123;#string&#125;</div><div class="line">5</div></pre></td></tr></table></figure>
<blockquote>
<p>计算字符串长度也可以用<strong>length</strong></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ expr length &quot;$url&quot;</div><div class="line">26</div></pre></td></tr></table></figure>
<h2 id="字符串截取"><a href="#字符串截取" class="headerlink" title="字符串截取"></a>字符串截取</h2><p>字符串截取主要有4个截取符：<code>#</code>、<code>##</code>、<code>%</code>、<code>%%</code>：删除包含了指定的字符</p>
<ul>
<li>#、##表示从左边开始截取，#表示从左边删除到指定的第一个字符；##表示从左边删除到最后一个指定的字符</li>
<li>%、%%表示从右边开始删除，%表示从右边删除到指定的第一个字符；%%表示从右边删除到最后一个指定的字符</li>
</ul>
<blockquote>
<p>linux的字符串截取有八种方法</p>
</blockquote>
<p>假设我们有变量url=<a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h3 id="截取，删除左边字符，保留右边字符"><a href="#截取，删除左边字符，保留右边字符" class="headerlink" title="#截取，删除左边字符，保留右边字符"></a><code>#</code>截取，删除左边字符，保留右边字符</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ echo $&#123;url#*//&#125;</div><div class="line">ytlogos.github.io/</div></pre></td></tr></table></figure>
<p>其中url是变量名，#是字符截取运算符，*//表示从左边开始删除第一个<code>//</code>及其左边所有字符，即删除<code>https://</code>。</p>
<h3 id="截取，删除左边字符，保留右边字符-1"><a href="#截取，删除左边字符，保留右边字符-1" class="headerlink" title="##截取，删除左边字符，保留右边字符"></a><code>##</code>截取，删除左边字符，保留右边字符</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ echo $&#123;url##*/&#125;</div></pre></td></tr></table></figure>
<p>##*/表示从左边开始删除指定的最后一个字符<code>/</code>及其左边所有字符，所以上述结果就是空的。</p>
<h3 id="截取，删除右边字符，保留左边字符"><a href="#截取，删除右边字符，保留左边字符" class="headerlink" title="%截取，删除右边字符，保留左边字符"></a><code>%</code>截取，删除右边字符，保留左边字符</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ echo $&#123;url%/*&#125;</div><div class="line">https://ytlogos.github.io</div></pre></td></tr></table></figure>
<p>%/*表示从右边开始删除第一个<code>/</code>及其右边字符</p>
<h3 id="截取，删除右边字符，保留左边字符-1"><a href="#截取，删除右边字符，保留左边字符-1" class="headerlink" title="%%截取，删除右边字符，保留左边字符"></a><code>%%</code>截取，删除右边字符，保留左边字符</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ echo $&#123;url%%/*&#125;</div><div class="line">https:</div></pre></td></tr></table></figure>
<p><code>%%</code>表示从右边开始删除最后一个<code>/</code>及其右边的字符</p>
<h3 id="从左边第几个字符开始及字符个数"><a href="#从左边第几个字符开始及字符个数" class="headerlink" title="从左边第几个字符开始及字符个数"></a>从左边第几个字符开始及字符个数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ echo $&#123;url:0:5&#125;</div><div class="line">https</div></pre></td></tr></table></figure>
<p>上述命令表示从左边第一个字符开始截取5个字符</p>
<h3 id="从左边开始第几个字符开始一直到结束"><a href="#从左边开始第几个字符开始一直到结束" class="headerlink" title="从左边开始第几个字符开始一直到结束"></a>从左边开始第几个字符开始一直到结束</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ echo $&#123;url:5&#125;</div><div class="line">://ytlogos.github.io/</div></pre></td></tr></table></figure>
<h3 id="从右边第几个字符开始及字符个数"><a href="#从右边第几个字符开始及字符个数" class="headerlink" title="从右边第几个字符开始及字符个数"></a>从右边第几个字符开始及字符个数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ echo $&#123;url:0-4:3&#125;</div><div class="line">.io</div></pre></td></tr></table></figure>
<p>上述命令表示从右边第四个字符开始向右截取3个字符</p>
<h3 id="从右边第几个字符开始一直到结束"><a href="#从右边第几个字符开始一直到结束" class="headerlink" title="从右边第几个字符开始一直到结束"></a>从右边第几个字符开始一直到结束</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ echo $&#123;url:0-7&#125;</div><div class="line">hub.io/</div></pre></td></tr></table></figure>
<blockquote>
<p>左边第一个字符用0表示，右边第一个字符用0-1表示</p>
</blockquote>
<h2 id="查找子字符串"><a href="#查找子字符串" class="headerlink" title="查找子字符串"></a>查找子字符串</h2><p>查找字符<code>g</code>的位置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ echo `expr index &quot;$url&quot; g`</div><div class="line">13</div></pre></td></tr></table></figure></p>
<blockquote>
<p>如果字符串中不含那个字符的话，结果显示为0，另外如果查找多个字符的话只显示排在前面的字符</p>
<p>还有一点需要注意的是上面的是反引号`而不是单引号’</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ echo `expr index &quot;$url&quot; gt`</div><div class="line">2</div></pre></td></tr></table></figure>
<h2 id="shell数组"><a href="#shell数组" class="headerlink" title="shell数组"></a>shell数组</h2><p>bash支持一维数组（不支持多维数组），并且没有限定数组大小，数组元素下标从0开始，可以是整数或算术表达式。</p>
<h3 id="定义数组"><a href="#定义数组" class="headerlink" title="定义数组"></a>定义数组</h3><p>shell中数组的定义用括号表示，数组元素用<code>空格</code>分隔开。定义数组形式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">数组名=(值1 值2 ... 值n)</div></pre></td></tr></table></figure>
<p>具体如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">array_name=(v0 v1 v2 v3 v4 v5)</div></pre></td></tr></table></figure></p>
<p>或<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">array_name=(</div><div class="line">    v0</div><div class="line">    v1</div><div class="line">    v2</div><div class="line">    v3</div><div class="line">    v4</div><div class="line">    v5</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>还可以通过赋值单独定义数组各个分量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">array_name[0]=v0</div><div class="line">array_name[1]=v1</div><div class="line">.</div><div class="line">.</div><div class="line">.</div></pre></td></tr></table></figure>
<blockquote>
<p>可以不使用连续的下标，而且下标范围没有限制</p>
</blockquote>
<h2 id="数组读取"><a href="#数组读取" class="headerlink" title="数组读取"></a>数组读取</h2><p>数组读取的一帮格式如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$&#123;数组名[下标]&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ echo $&#123;array_name[2]&#125;</div><div class="line">v1</div></pre></td></tr></table></figure>
<p>使用@符号可以获取数组中所有元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ echo $&#123;array_name[@]&#125;</div><div class="line">v0 v1 v2 v3 v4 v5</div></pre></td></tr></table></figure></p>
<h3 id="获取数组长度"><a href="#获取数组长度" class="headerlink" title="获取数组长度"></a>获取数组长度</h3><p>获取数组长度的方法与获取字符串长度的方法相同：首先获取数组元素个数，再获取长度</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ echo $&#123;#array_name[@]&#125;</div><div class="line">6</div><div class="line"># 或</div><div class="line">$ echo $&#123;#array_name[*]&#125;</div><div class="line">6</div></pre></td></tr></table></figure>
<h2 id="shell注释"><a href="#shell注释" class="headerlink" title="shell注释"></a>shell注释</h2><p>注释行都是以<code>#</code>开头，会被解释器忽略。不支持多行注释。</p>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180204/7bEcJiH4l2.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Shell" scheme="https://ytlogos.github.io/categories/Shell/"/>
    
    
  </entry>
  
  <entry>
    <title>Shell编程：简介</title>
    <link href="https://ytlogos.github.io/2018/02/01/Shell%E7%BC%96%E7%A8%8B%EF%BC%9A%E7%AE%80%E4%BB%8B/"/>
    <id>https://ytlogos.github.io/2018/02/01/Shell编程：简介/</id>
    <published>2018-02-01T13:19:05.000Z</published>
    <updated>2018-02-04T10:59:24.055Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180204/GhihcB409F.png?imageslim" alt="mark"></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Shell是一个用C语言编写的程序，提供用户使用linux的桥梁。它既是一种命令语言，又是一种程序设计语言。Shell脚本(Shell script)shiyizhongweiShel编写的脚本程序。通常我们说的Shell就是指的Shell脚本，但是应该记住的是Shell与Shell脚本是两个不同的概念。linux的Shell种类众多，但是我们常用的是bash。</p>
<a id="more"></a>
<h2 id="Shell脚本"><a href="#Shell脚本" class="headerlink" title="Shell脚本"></a>Shell脚本</h2><p>由于Shell种类众多，所以我们编写Shell脚本的时候解释该脚本的Shell程序。所以第一行我们通常写成这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div></pre></td></tr></table></figure>
<p><strong>#!</strong>是一个约定的标记，用来告诉系统这个脚本用什么解释器来执行，也就是使用哪一种Shell来执行，这里我们指定由bash来执行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">!#/bin/bash</div><div class="line">echo &quot;Hello World !&quot;</div></pre></td></tr></table></figure>
<p><code>echo</code>命令用于向窗口输出文本。</p>
<h2 id="运行脚本"><a href="#运行脚本" class="headerlink" title="运行脚本"></a>运行脚本</h2><p>运行脚本有两种方法</p>
<ul>
<li>作为可执行程序</li>
</ul>
<p>将上面的代码保存为hello.sh，然后进入其所在的目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#使脚本具有执行权限</div><div class="line">chmod +x ./hello.sh</div><div class="line">#执行脚本</div><div class="line">./hello.sh</div></pre></td></tr></table></figure></p>
<blockquote>
<p>需要注意的是，一定要写成./hello.sh，而不是./hello.sh，运行其他二进制的程序也一样。如果直接写成hello.sh的话，linux系统会去PATH里寻找有没有hello.sh这个文本，但是只有/bin,/sbin,/usr/bin等在PATH里，当前目录通常不在PATH里，所以写成hello.sh是找不到命令的，要用./hello.sh告诉系统就在当前目录找。</p>
</blockquote>
<ul>
<li>作为解释器参数<br>这种运行方式是直接运行解释器，参数就是shell脚本文件名。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/bin/sh hello.sh</div></pre></td></tr></table></figure>
<p>此时就无需声明解释器了，因为已经在命令中指定了</p>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180204/GhihcB409F.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;Shell是一个用C语言编写的程序，提供用户使用linux的桥梁。它既是一种命令语言，又是一种程序设计语言。Shell脚本(Shell script)shiyizhongweiShel编写的脚本程序。通常我们说的Shell就是指的Shell脚本，但是应该记住的是Shell与Shell脚本是两个不同的概念。linux的Shell种类众多，但是我们常用的是bash。&lt;/p&gt;
    
    </summary>
    
      <category term="Shell" scheme="https://ytlogos.github.io/categories/Shell/"/>
    
    
  </entry>
  
  <entry>
    <title>关于如何修改坐标轴表达式以及分面图例的一个例子</title>
    <link href="https://ytlogos.github.io/2018/01/31/%E5%85%B3%E4%BA%8E%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E5%9D%90%E6%A0%87%E8%BD%B4%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%BB%A5%E5%8F%8A%E5%88%86%E9%9D%A2%E5%9B%BE%E4%BE%8B%E7%9A%84%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90/"/>
    <id>https://ytlogos.github.io/2018/01/31/关于如何修改坐标轴表达式以及分面图例的一个例子/</id>
    <published>2018-01-31T11:43:11.000Z</published>
    <updated>2018-02-01T03:30:29.055Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/ElKca96m2c.png?imageslim" alt="mark"></p>
<p><strong>ggplot2</strong>绘制的图形如果需要修改细节的话，没有对<strong>ggplot2</strong>有一定的了解的话是十分困难的，毕竟连创建这个包的作者<strong>Hadley Wickham</strong>都自称自己使用<strong>ggplot2</strong>的时候都需要查文档。在对<strong>ggplot2</strong>有一定了解的基础上如果需要修改ggplot图的话稍微查查文档基本能解决。</p>
<a id="more"></a>
<h2 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h2><p>这两天有人问我如何修改她的图形，她绘制的图如下：</p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/5fA4FDKGJB.png?imageslim" alt="mark"></p>
<p>她希望修改三点：</p>
<ul>
<li>各个分面的图例比如DK、NL等是否可以修改，使得大一点</li>
<li>Y轴标题中的-1如何变成上标</li>
<li>平均值虚线如何针对不同物种画相对应的虚线平均值</li>
</ul>
<p>她是使用<strong>ggpubr</strong>包绘制的，这个包就是对一些<strong>ggplot2</strong>函数的一些封装及继承，本质上来说是可以通过<strong>ggplot2</strong>来修改参数的。我参考了一部分的官方文档之后解决了这三个问题，所以写了这篇博客。</p>
<h2 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(tidyverse)</div><div class="line">library(ggpubr)</div><div class="line">ICP&lt;-read.csv(&quot;C:/Users/taoyan/Desktop/element.csv&quot;)</div><div class="line">ICP$Order &lt;- factor(ICP$Species, levels = c(&quot;DK&quot;, &quot;NL&quot;, &quot;RO&quot;, &quot;IT&quot;, &quot;TL&quot;, &quot;AP&quot;, &quot;AD&quot;))</div><div class="line">head(ICP)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   Species Treatment       Na       Ca        P</div><div class="line">## 1      DK         A 268.4234 3021.933 1791.317</div><div class="line">## 2      DK         A 301.9390 3314.308 1595.479</div><div class="line">## 3      DK         A 261.1024 3417.643 1547.596</div><div class="line">## 4      DK         A 229.1169 3069.978 1735.703</div><div class="line">## 5      DK         A 265.1454 3205.965 1667.524</div><div class="line">## 6      DK         B 330.7135 4028.279 1638.113</div></pre></td></tr></table></figure>
<h2 id="构造数据"><a href="#构造数据" class="headerlink" title="构造数据"></a>构造数据</h2><p>由于后面需要用到平均值，所以需要构造含有平均值的数据集<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">meanvalue &lt;- ICP%&gt;%group_by(Species)%&gt;%summarise(mean=mean(Na))</div><div class="line">data &lt;- left_join(ICP,meanvalue,by=c(&apos;Species&apos;=&apos;Species&apos;))</div><div class="line">head(data[,c(1:4,13)])</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   Species Treatment       Na       Ca     mean</div><div class="line">## 1      DK         A 268.4234 3021.933 426.6542</div><div class="line">## 2      DK         A 301.9390 3314.308 426.6542</div><div class="line">## 3      DK         A 261.1024 3417.643 426.6542</div><div class="line">## 4      DK         A 229.1169 3069.978 426.6542</div><div class="line">## 5      DK         A 265.1454 3205.965 426.6542</div><div class="line">## 6      DK         B 330.7135 4028.279 426.6542</div></pre></td></tr></table></figure>
<h2 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">p &lt;- ggboxplot(ICP, x=&quot;Treatment&quot;, y=&quot;Na&quot;,group=&quot;Species&quot;, color=&quot;Treatment&quot;,</div><div class="line">add=&quot;mean_se&quot;,facet.by = &quot;Order&quot;,ncol=4, legend=&quot;none&quot;)+</div><div class="line">geom_hline(aes(yintercept=mean),data,linetype=2)+ #由于要在不同的分面里绘制水平线，这里要mapping</div><div class="line">stat_compare_means(method=&quot;anova&quot;,label=&quot;p.format&quot;,label.y=3500,size=8)+</div><div class="line">stat_compare_means(label=&quot;p.signif&quot;,size=8,method=&quot;wilcox.test&quot;,ref.group=&quot;.all.&quot;,hide.ns=TRUE)</div><div class="line">ggpar(p,palette = &quot;npg&quot;,font.tickslab = c(18,&quot;bold&quot;))+</div><div class="line">  theme(strip.text = element_text(size=15,face = &quot;bold&quot;))+ #调整分面legend</div><div class="line">  labs(x=&quot;Treatment&quot;, y=expression(bold(paste(&quot;Na (  &quot;, &apos;mg Kg&apos;^&#123;-1&#125;,&quot;)&quot;,&apos; DM&apos;))))+</div><div class="line">  theme(axis.title = element_text(face = &quot;bold&quot;, size=18))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/ElKca96m2c.png?imageslim" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo()"></a>SessionInfo()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">##  [1] bindrcpp_0.2       ggpubr_0.1.6       magrittr_1.5      </div><div class="line">##  [4] forcats_0.2.0      stringr_1.2.0      dplyr_0.7.4       </div><div class="line">##  [7] purrr_0.2.4        readr_1.1.1        tidyr_0.7.2       </div><div class="line">## [10] tibble_1.4.2       ggplot2_2.2.1.9000 tidyverse_1.2.1   </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] tidyselect_0.2.3  reshape2_1.4.3    haven_1.1.1      </div><div class="line">##  [4] lattice_0.20-35   colorspace_1.3-2  htmltools_0.3.6  </div><div class="line">##  [7] yaml_2.1.16       rlang_0.1.6       pillar_1.1.0     </div><div class="line">## [10] foreign_0.8-69    glue_1.2.0        modelr_0.1.1     </div><div class="line">## [13] readxl_1.0.0      bindr_0.1         plyr_1.8.4       </div><div class="line">## [16] munsell_0.4.3     gtable_0.2.0      cellranger_1.1.0 </div><div class="line">## [19] rvest_0.3.2       ggsci_2.8         psych_1.7.8      </div><div class="line">## [22] evaluate_0.10.1   labeling_0.3      knitr_1.18       </div><div class="line">## [25] parallel_3.4.3    broom_0.4.3       Rcpp_0.12.15     </div><div class="line">## [28] scales_0.5.0.9000 backports_1.1.2   jsonlite_1.5     </div><div class="line">## [31] mnormt_1.5-5      hms_0.4.1         digest_0.6.14    </div><div class="line">## [34] stringi_1.1.6     grid_3.4.3        rprojroot_1.3-2  </div><div class="line">## [37] cli_1.0.0         tools_3.4.3       lazyeval_0.2.1   </div><div class="line">## [40] crayon_1.3.4      pkgconfig_2.0.1   xml2_1.2.0       </div><div class="line">## [43] lubridate_1.7.1   assertthat_0.2.0  rmarkdown_1.8    </div><div class="line">## [46] httr_1.3.1        rstudioapi_0.7    R6_2.2.2         </div><div class="line">## [49] nlme_3.1-131      compiler_3.4.3</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410</p>
<p>Email: tyan@zju.edu.cn</p>
<p>QQ: 1051927088</p>
<p>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a></p>
<p>简书: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a></p>
<p>博客: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛</p>
<p>浙江大学作物遗传育种在读研究生（生物信息学方向）</p>
<p>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/ElKca96m2c.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ggplot2&lt;/strong&gt;绘制的图形如果需要修改细节的话，没有对&lt;strong&gt;ggplot2&lt;/strong&gt;有一定的了解的话是十分困难的，毕竟连创建这个包的作者&lt;strong&gt;Hadley Wickham&lt;/strong&gt;都自称自己使用&lt;strong&gt;ggplot2&lt;/strong&gt;的时候都需要查文档。在对&lt;strong&gt;ggplot2&lt;/strong&gt;有一定了解的基础上如果需要修改ggplot图的话稍微查查文档基本能解决。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="R" scheme="https://ytlogos.github.io/tags/R/"/>
    
      <category term="visualization" scheme="https://ytlogos.github.io/tags/visualization/"/>
    
      <category term="ggplot2" scheme="https://ytlogos.github.io/tags/ggplot2/"/>
    
      <category term="ggpubr" scheme="https://ytlogos.github.io/tags/ggpubr/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 08 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/31/%20Lesson%2008%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/31/ Lesson 08 for Plotting in R for Biologists/</id>
    <published>2018-01-31T04:19:05.000Z</published>
    <updated>2018-02-03T07:57:05.975Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Jfea06AiAF.png?imageslim" alt="mark"></p>
<p>这节课是最后一节课，主要将如何绘制热图(heatmap)。实际上关于热图的绘制，我以前写了一篇博客：<a href="https://ytlogos.github.io/2017/08/21/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E7%83%AD%E5%9B%BE%E7%BB%98%E5%88%B6/">R语言学习笔记之热图绘制</a>，里面写的十分详细。但是今天热图绘制主要利用一个新的R包<strong>ComplexHeatmap</strong>进行绘制。</p>
<a id="more"></a>
<h2 id="包安装"><a href="#包安装" class="headerlink" title="包安装"></a>包安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">source(&quot;https://bioconductor.org/biocLite.R&quot;)</div><div class="line">options(BioC_mirror=&quot;http://mirrors.ustc.edu.cn/bioc/&quot;)</div><div class="line">biocLite(&quot;ComplexHeatmap&quot;)</div></pre></td></tr></table></figure>
<h2 id="数据加载"><a href="#数据加载" class="headerlink" title="数据加载"></a>数据加载</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(ComplexHeatmap)</div><div class="line">my_data &lt;- read.table(&quot;copy_number_data.txt&quot;, sep = &quot;\t&quot;, quote=&quot;&quot;, stringsAsFactors = FALSE, header = TRUE)</div><div class="line">head(my_data[,1:6])</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##    CHR     START       END X.SRR089523. X.SRR089526. X.SRR089529.</div><div class="line">## 1 chr1  53440429  53494914    1.1002112    1.1000844    1.0487301</div><div class="line">## 2 chr1 105459037 105514187    1.1860780    0.6553897    0.4980016</div><div class="line">## 3 chr1 183998520 184048557    1.3791250    1.2024487    0.5735184</div><div class="line">## 4 chr1 236135655 236186012    0.8987158    1.1182392    0.6396842</div><div class="line">## 5 chr2  38944803  38996507    1.0788216    0.9663390    1.0473623</div><div class="line">## 6 chr2  97248366  97298651    1.0459629    1.0658991    1.0473623</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#绘制热图前先进行矩阵化</div><div class="line">my_matrix &lt;- as.matrix(my_data[, c(4:100)])</div><div class="line">head(my_matrix[,1:4])</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##      X.SRR089523. X.SRR089526. X.SRR089529. X.SRR089533.</div><div class="line">## [1,]    1.1002112    1.1000844    1.0487301    0.5656784</div><div class="line">## [2,]    1.1860780    0.6553897    0.4980016    0.5656784</div><div class="line">## [3,]    1.3791250    1.2024487    0.5735184    1.0362551</div><div class="line">## [4,]    0.8987158    1.1182392    0.6396842    0.4659238</div><div class="line">## [5,]    1.0788216    0.9663390    1.0473623    1.1702930</div><div class="line">## [6,]    1.0459629    1.0658991    1.0473623    1.2298119</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#将染色体信息存储好以便后续热图注释</div><div class="line">chromosome_info &lt;- data.frame(chrom=my_data$CHR)</div></pre></td></tr></table></figure>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Heatmap(my_matrix)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Aj4Gc126K4.png?imageslim" alt="mark"></p>
<p>可以看到使用默认参数热图时十分不美观，可以进行部分调整<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#坐标旋转</div><div class="line">my_matrix &lt;- t(my_matrix)</div><div class="line">Heatmap(my_matrix)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/f2bambd0De.png?imageslim" alt="mark"></p>
<p>坐标标签还是十分乱，还得进行调整<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Heatmap(my_matrix, cluster_columns = FALSE)#列不聚类</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/j5Aabgh1hH.png?imageslim" alt="mark"></p>
<p>将坐标标签位置置于左边<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Heatmap(my_matrix, </div><div class="line">        cluster_columns = FALSE, </div><div class="line">        row_names_side = &quot;left&quot;, </div><div class="line">        row_hclust_side = &quot;left&quot;, </div><div class="line">        row_names_gp = gpar(cex=0.6)</div><div class="line">        )</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/FAIF0CElla.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Heatmap(my_matrix,</div><div class="line">        cluster_columns = FALSE,</div><div class="line">        row_names_side = &quot;left&quot;,</div><div class="line">        row_hclust_side = &quot;left&quot;,</div><div class="line">        row_names_gp = gpar(cex=0.6),</div><div class="line">        row_hclust_width = unit(3, &quot;cm&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/c34HgC083C.png?imageslim" alt="mark"></p>
<p>热图绘制的时候可以使用不同的距离计算方式以及聚类方法，具体的用法可以参考我以前的博客：<a href="https://ytlogos.github.io/2017/08/21/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E7%83%AD%E5%9B%BE%E7%BB%98%E5%88%B6/">R语言学习笔记之热图绘制</a>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Heatmap(my_matrix,</div><div class="line">        cluster_columns = FALSE,</div><div class="line">        row_names_side = &quot;left&quot;,</div><div class="line">        row_hclust_side = &quot;left&quot;,</div><div class="line">        row_names_gp = gpar(cex=0.6),</div><div class="line">        row_hclust_width = unit(3, &quot;cm&quot;),</div><div class="line">        clustering_distance_rows = &quot;maximum&quot;,</div><div class="line">        clustering_method_rows = &quot;ward.D&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/iEiafB44Ad.png?imageslim" alt="mark"></p>
<h2 id="热图注释"><a href="#热图注释" class="headerlink" title="热图注释"></a>热图注释</h2><p>主要是对聚成的类进行颜色标记<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">library(dendextend)</div><div class="line">dend &lt;- hclust(dist(my_matrix, method = &quot;maximum&quot;), method = &quot;ward.D&quot;)</div><div class="line">Heatmap(my_matrix,</div><div class="line">        cluster_columns = FALSE,</div><div class="line">        row_names_side = &quot;left&quot;,</div><div class="line">        row_hclust_side = &quot;left&quot;,</div><div class="line">        row_names_gp = gpar(cex=0.6),</div><div class="line">        row_hclust_width = unit(3, &quot;cm&quot;),</div><div class="line">        cluster_rows = color_branches(dend, k=3))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/k0d1H4Fahj.png?imageslim" alt="mark"></p>
<h3 id="将热图分类"><a href="#将热图分类" class="headerlink" title="将热图分类"></a>将热图分类</h3><p>随便你先分成几类，但是一般来说有一个最佳分类数，可参考我的另一篇博客：<a href="https://ytlogos.github.io/2017/06/25/R语言学习笔记之聚类分析/">R语言学习笔记之聚类分析</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Heatmap(my_matrix,</div><div class="line">        cluster_columns = FALSE,</div><div class="line">        row_names_side = &quot;left&quot;,</div><div class="line">        row_hclust_side = &quot;left&quot;,</div><div class="line">        row_names_gp = gpar(cex=0.6),</div><div class="line">        row_hclust_width = unit(3, &quot;cm&quot;),</div><div class="line">        clustering_distance_rows = &quot;maximum&quot;,</div><div class="line">        clustering_method_rows = &quot;ward.D&quot;,</div><div class="line">        km=2)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/d4hLf0EfgF.png?imageslim" alt="mark"></p>
<h3 id="根据染色体信息进行注释"><a href="#根据染色体信息进行注释" class="headerlink" title="根据染色体信息进行注释"></a>根据染色体信息进行注释</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">chromosome_colors &lt;- c(rep(c(&quot;black&quot;,&quot;white&quot;),11), &quot;red&quot;)</div><div class="line">names(chromosome_colors) &lt;- paste(&quot;chr&quot;,c(seq(1:22), &quot;X&quot;), sep = &quot;&quot;)</div><div class="line">Heatmap(my_matrix,</div><div class="line">        cluster_columns = FALSE,</div><div class="line">        row_names_side = &quot;left&quot;,</div><div class="line">        row_hclust_side = &quot;left&quot;,</div><div class="line">        row_names_gp = gpar(cex=0.6),</div><div class="line">        row_hclust_width = unit(3, &quot;cm&quot;),</div><div class="line">        clustering_distance_rows = &quot;maximum&quot;,</div><div class="line">        clustering_method_rows = &quot;ward.D&quot;,</div><div class="line">        km=2,</div><div class="line">        bottom_annotation = HeatmapAnnotation(chromosome_info, col = list(chrom=chromosome_colors), show_legend = FALSE))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Jfea06AiAF.png?imageslim" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] grid      stats     graphics  grDevices utils     datasets  methods  </div><div class="line">## [8] base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">## [1] dendextend_1.6.0      ComplexHeatmap_1.17.1</div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.15         DEoptimR_1.0-8       compiler_3.4.3      </div><div class="line">##  [4] pillar_1.1.0         RColorBrewer_1.1-2   plyr_1.8.4          </div><div class="line">##  [7] viridis_0.4.1        class_7.3-14         prabclus_2.2-6      </div><div class="line">## [10] tools_3.4.3          digest_0.6.15        mclust_5.4          </div><div class="line">## [13] viridisLite_0.3.0    evaluate_0.10.1      tibble_1.4.2        </div><div class="line">## [16] gtable_0.2.0         lattice_0.20-35      rlang_0.1.6         </div><div class="line">## [19] yaml_2.1.16          mvtnorm_1.0-7        gridExtra_2.3       </div><div class="line">## [22] trimcluster_0.1-2    stringr_1.2.0        knitr_1.19          </div><div class="line">## [25] cluster_2.0.6        GlobalOptions_0.0.12 fpc_2.1-11          </div><div class="line">## [28] diptest_0.75-7       nnet_7.3-12          stats4_3.4.3        </div><div class="line">## [31] rprojroot_1.3-2      robustbase_0.92-8    GetoptLong_0.1.6    </div><div class="line">## [34] flexmix_2.3-14       rmarkdown_1.8        kernlab_0.9-25      </div><div class="line">## [37] ggplot2_2.2.1.9000   magrittr_1.5         whisker_0.3-2       </div><div class="line">## [40] modeltools_0.2-21    backports_1.1.2      scales_0.5.0.9000   </div><div class="line">## [43] htmltools_0.3.6      MASS_7.3-48          shape_1.4.3         </div><div class="line">## [46] circlize_0.4.3       colorspace_1.3-2     stringi_1.1.6       </div><div class="line">## [49] lazyeval_0.2.1       munsell_0.4.3        rjson_0.2.15</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Jfea06AiAF.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;这节课是最后一节课，主要将如何绘制热图(heatmap)。实际上关于热图的绘制，我以前写了一篇博客：&lt;a href=&quot;https://ytlogos.github.io/2017/08/21/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E7%83%AD%E5%9B%BE%E7%BB%98%E5%88%B6/&quot;&gt;R语言学习笔记之热图绘制&lt;/a&gt;，里面写的十分详细。但是今天热图绘制主要利用一个新的R包&lt;strong&gt;ComplexHeatmap&lt;/strong&gt;进行绘制。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
      <category term="heatmap" scheme="https://ytlogos.github.io/tags/heatmap/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 07 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/30/%20Lesson%2007%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/30/ Lesson 07 for Plotting in R for Biologists/</id>
    <published>2018-01-30T04:19:05.000Z</published>
    <updated>2018-02-03T06:12:06.932Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/BcHLAECm5L.png?imageslim" alt="mark"></p>
<p>这节课主要两个知识点，一个是图形分面，一个是图形嵌入。</p>
<a id="more"></a>
<h2 id="数据加载及清洗"><a href="#数据加载及清洗" class="headerlink" title="数据加载及清洗"></a>数据加载及清洗</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(tidyverse)</div><div class="line">theme_set(theme_gray())</div><div class="line">my_data &lt;- read.csv(&quot;variants_from_assembly.bed&quot;, sep = &quot;\t&quot;, quote = &apos;&apos;, stringsAsFactors = TRUE, header = FALSE)</div><div class="line">names(my_data) &lt;- c(&quot;chrom&quot;,&quot;start&quot;,&quot;stop&quot;,&quot;name&quot;,&quot;size&quot;,&quot;strand&quot;,&quot;type&quot;,&quot;ref.dist&quot;,&quot;query.dist&quot;)</div><div class="line">head(my_data)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   chrom     start      stop name size strand      type ref.dist query.dist</div><div class="line">## 1     6 103832058 103832059  SV1  185      + Insertion        0        185</div><div class="line">## 2     6 102958468 102958469  SV2  317      + Insertion      -14        303</div><div class="line">## 3     6 102741692 102741693  SV3  130      +  Deletion      130          0</div><div class="line">## 4     6 102283759 102283760  SV4 1271      + Insertion      -12       1259</div><div class="line">## 5     6 101194032 101194033  SV5 2864      + Insertion      -13       2851</div><div class="line">## 6     6 101056644 101056645  SV6  265      + Insertion        0        265</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">my_data &lt;- my_data[my_data$chrom %in% c(seq(1:22), &quot;X&quot;,&quot;Y&quot;), ]</div><div class="line">my_data$chrom &lt;- factor(gsub(&quot;chr&quot;, &quot;&quot;,my_data$chrom), levels = c(seq(1:22),&quot;X&quot;,&quot;Y&quot;))</div><div class="line">my_data$type &lt;- factor(my_data$type, levels = c(&quot;Insertion&quot;,&quot;Deletion&quot;,&quot;Expansion&quot;,&quot;Contraction&quot;))</div></pre></td></tr></table></figure>
<h2 id="可视化-amp-分面"><a href="#可视化-amp-分面" class="headerlink" title="可视化&amp;分面"></a>可视化&amp;分面</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density(alpha=0.5)+xlim(0,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Ella96CC28.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density(alpha=0.5)+xlim(0,500)+facet_grid(type~.)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/G1jDEc7HFj.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density(alpha=0.5)+xlim(0,500)+facet_grid(.~type)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/e9jJEl1EHl.png?imageslim" alt="mark"></p>
<p>分面的规则语法是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plot+facet_grid(rows~columns)</div></pre></td></tr></table></figure></p>
<p>比如下面的图按染色体为行、type为列进行分面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density()+xlim(0,500)+facet_grid(chrom~type)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/BG7kecbglg.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#也可以反过来</div><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density()+xlim(0,500)+facet_grid(type~chrom)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/lIL4kkDecH.png?imageslim" alt="mark"></p>
<blockquote>
<p>可以根据自己的喜好以及数据的分布进行分面，有的时候数据不是很适合分面操作，需要慎重，不然越分越乱，无法直观地展示数据。</p>
</blockquote>
<h2 id="图形嵌入"><a href="#图形嵌入" class="headerlink" title="图形嵌入"></a>图形嵌入</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#先设置主题</div><div class="line">theme_set(theme_gray()+</div><div class="line">            theme(</div><div class="line">              axis.line = element_line(size=0.5),</div><div class="line">              panel.background = element_rect(fill=NA, size = rel(20)),</div><div class="line">              panel.grid.minor = element_line(colour = NA),</div><div class="line">              axis.text = element_text(size = 16),</div><div class="line">              axis.title = element_text(size = 16)</div><div class="line">            )</div><div class="line">          )</div><div class="line">big_plot &lt;- ggplot(my_data, aes(x=size, fill=type))+</div><div class="line">  geom_bar(binwidth = 100)+</div><div class="line">  guides(fill=FALSE)+</div><div class="line">  scale_y_continuous(expand = c(0,0))</div><div class="line">big_plot</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Jj3lGDhBE1.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">small_plot &lt;- ggplot(my_data, aes(x=size, fill=type))+</div><div class="line">  geom_bar(binwidth = 5)+</div><div class="line">  xlim(0, 500)+</div><div class="line">  theme(axis.title = element_blank())+</div><div class="line">  scale_y_continuous(expand = c(0,0))</div><div class="line">small_plot</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/Af79gm2c4B.png?imageslim" alt="mark"></p>
<p>图形嵌入需要使用包<strong>grid</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">library(grid)</div><div class="line">#构造画布，这一步需要不断调整位置</div><div class="line">vp &lt;- viewport(width = 0.8, height = 0.7, x=0.65, y=0.65)#分别设置需要嵌入的图形的宽度、高度以及坐标位置</div><div class="line">png(&quot;insert_plot.png&quot;)</div><div class="line">print(big_plot)</div><div class="line">print(small_plot, vp = vp)</div><div class="line">dev.off()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/BcHLAECm5L.png?imageslim" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] grid      stats     graphics  grDevices utils     datasets  methods  </div><div class="line">## [8] base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">## [1] forcats_0.2.0      stringr_1.2.0      dplyr_0.7.4       </div><div class="line">## [4] purrr_0.2.4        readr_1.1.1        tidyr_0.7.2       </div><div class="line">## [7] tibble_1.4.2       ggplot2_2.2.1.9000 tidyverse_1.2.1   </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.15      cellranger_1.1.0  pillar_1.1.0     </div><div class="line">##  [4] compiler_3.4.3    plyr_1.8.4        bindr_0.1        </div><div class="line">##  [7] tools_3.4.3       digest_0.6.15     lubridate_1.7.1  </div><div class="line">## [10] jsonlite_1.5      evaluate_0.10.1   nlme_3.1-131     </div><div class="line">## [13] gtable_0.2.0      lattice_0.20-35   pkgconfig_2.0.1  </div><div class="line">## [16] rlang_0.1.6       psych_1.7.8       cli_1.0.0        </div><div class="line">## [19] rstudioapi_0.7    yaml_2.1.16       parallel_3.4.3   </div><div class="line">## [22] haven_1.1.1       bindrcpp_0.2      xml2_1.2.0       </div><div class="line">## [25] httr_1.3.1        knitr_1.19        hms_0.4.1        </div><div class="line">## [28] rprojroot_1.3-2   glue_1.2.0        R6_2.2.2         </div><div class="line">## [31] readxl_1.0.0      foreign_0.8-69    rmarkdown_1.8    </div><div class="line">## [34] modelr_0.1.1      reshape2_1.4.3    magrittr_1.5     </div><div class="line">## [37] backports_1.1.2   scales_0.5.0.9000 htmltools_0.3.6  </div><div class="line">## [40] rvest_0.3.2       assertthat_0.2.0  mnormt_1.5-5     </div><div class="line">## [43] colorspace_1.3-2  labeling_0.3      stringi_1.1.6    </div><div class="line">## [46] lazyeval_0.2.1    munsell_0.4.3     broom_0.4.3      </div><div class="line">## [49] crayon_1.3.4</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180203/BcHLAECm5L.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;这节课主要两个知识点，一个是图形分面，一个是图形嵌入。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 06 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/29/%20Lesson%2006%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/29/ Lesson 06 for Plotting in R for Biologists/</id>
    <published>2018-01-29T04:19:05.000Z</published>
    <updated>2018-02-02T14:00:31.911Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/AFLB2JBHc7.png?imageslim" alt="veendiagram"></p>
<p>前面几节课绘制的图形只有条形图，但是我们科研过程中需要绘制各种各样的图形来展现我们的数据，这节课就主要讲一下利用<strong>ggplot2</strong>绘制各种图形，这也是<strong>ggplot2</strong>的魔力所在。相同的数据可以通过不同类型的图形来可视化。本节课主要将绘制以下几类图形：</p>
<ul>
<li>条形图</li>
<li>直方图</li>
<li>散点图</li>
<li>箱线图</li>
<li>小提琴图</li>
<li>密度图</li>
<li>点状图</li>
<li>线图</li>
<li>饼图</li>
<li>韦恩图</li>
</ul>
<a id="more"></a>
<h2 id="数据加载清洗"><a href="#数据加载清洗" class="headerlink" title="数据加载清洗"></a>数据加载清洗</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(tidyverse)</div><div class="line">theme_set(theme_gray(base_size = 18))</div><div class="line">my_data &lt;- read.csv(&quot;variants_from_assembly.bed&quot;, sep = &quot;\t&quot;, quote = &apos;&apos;, stringsAsFactors = FALSE)</div><div class="line">names(my_data) &lt;- c(&quot;chrom&quot;,&quot;start&quot;,&quot;stop&quot;,&quot;name&quot;,&quot;size&quot;,&quot;strand&quot;,&quot;type&quot;,&quot;ref.dist&quot;,&quot;query.dist&quot;)</div><div class="line">head(my_data)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   chrom     start      stop name size strand      type ref.dist query.dist</div><div class="line">## 1     6 102958468 102958469  SV2  317      + Insertion      -14        303</div><div class="line">## 2     6 102741692 102741693  SV3  130      +  Deletion      130          0</div><div class="line">## 3     6 102283759 102283760  SV4 1271      + Insertion      -12       1259</div><div class="line">## 4     6 101194032 101194033  SV5 2864      + Insertion      -13       2851</div><div class="line">## 5     6 101056644 101056645  SV6  265      + Insertion        0        265</div><div class="line">## 6     6 100407499 100407500  SV7  334      + Insertion        0        334</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">summary(my_data$chrom)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">##    Length     Class      Mode </div><div class="line">##      9555 character character</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#数据过滤</div><div class="line">my_data &lt;- my_data[my_data$chrom %in% c(seq(1:22), &quot;X&quot;, &quot;Y&quot;,&quot;MT&quot;), ]</div><div class="line">#染色体排序</div><div class="line">my_data$chrom &lt;- factor(my_data$chrom, levels = c(seq(1:22), &quot;X&quot;, &quot;Y&quot;,&quot;MT&quot;))</div><div class="line">#类型(type)排序</div><div class="line">my_data$type &lt;- factor(my_data$type, levels = c(&quot;Insertion&quot;,&quot;Deletion&quot;,&quot;Expansion&quot;,&quot;Contraction&quot;))</div><div class="line">head(my_data)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   chrom     start      stop name size strand      type ref.dist query.dist</div><div class="line">## 1     6 102958468 102958469  SV2  317      + Insertion      -14        303</div><div class="line">## 2     6 102741692 102741693  SV3  130      +  Deletion      130          0</div><div class="line">## 3     6 102283759 102283760  SV4 1271      + Insertion      -12       1259</div><div class="line">## 4     6 101194032 101194033  SV5 2864      + Insertion      -13       2851</div><div class="line">## 5     6 101056644 101056645  SV6  265      + Insertion        0        265</div><div class="line">## 6     6 100407499 100407500  SV7  334      + Insertion        0        334</div></pre></td></tr></table></figure>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><h3 id="条形图"><a href="#条形图" class="headerlink" title="条形图"></a>条形图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/Ij6mC3GFm8.png?imageslim" alt="mark"></p>
<h3 id="直方图"><a href="#直方图" class="headerlink" title="直方图"></a>直方图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_histogram()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/4ILKighKlg.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_histogram()+xlim(0,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/fI2i1chIJ9.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_histogram(binwidth = 5)+xlim(0,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/IKebffc1EI.png?imageslim" alt="mark"></p>
<h3 id="散点图"><a href="#散点图" class="headerlink" title="散点图"></a>散点图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#将type映射给颜色</div><div class="line">ggplot(my_data, aes(x=ref.dist, y=query.dist, color=type))+geom_point()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/f4fEKhAd35.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=ref.dist, y=query.dist, color=type))+geom_point()+xlim(-500,500)+ylim(-500,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/EGkhk29KlI.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#将数值型变量size映射给颜色</div><div class="line">ggplot(my_data, aes(x=ref.dist, y=query.dist, color=size))+geom_point()+xlim(-500,500)+ylim(-500,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/je4lgmC970.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=ref.dist, y=query.dist,color=size))+geom_point()+xlim(-500,500)+ylim(-500,500)+scale_color_gradient(limits=c(0, 500))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/fDg6K877F7.png?imageslim" alt="mark"></p>
<h3 id="箱线图"><a href="#箱线图" class="headerlink" title="箱线图"></a>箱线图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(type, y=size))+geom_boxplot()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/dI07A0I0Ah.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=type, y=size, fill=type))+geom_boxplot()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/76bb7i9f2F.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=type, y=size, fill=type))+geom_boxplot()+coord_flip()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/E8klE3m6EA.png?imageslim" alt="mark"></p>
<h3 id="小提琴图"><a href="#小提琴图" class="headerlink" title="小提琴图"></a>小提琴图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=type, y=size, fill=type))+geom_violin()+ylim(0,1000)+guides(fill=FALSE)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/AFkf5JgLAL.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=type, y=size, fill=type))+geom_violin(adjust=0.2)+ylim(0,1000)+guides(fill=FALSE)#adjust调整分辨率，默认为1，值越低，分辨率越高</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/51IFgFDCDc.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#坐标变换</div><div class="line">ggplot(my_data, aes(x=type, y=size, fill=type))+geom_violin()+scale_y_log10()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/JGjBHIKc80.png?imageslim" alt="mark"></p>
<h3 id="密度图"><a href="#密度图" class="headerlink" title="密度图"></a>密度图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density()+xlim(0,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/HjB54KeclD.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density(position = &quot;stack&quot;)+xlim(0,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/GDI76ijEJ8.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density(alpha=0.5)+xlim(0,500)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/BlLGm4G75l.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#图形分面</div><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_density()+xlim(0,500)+facet_grid(type~.)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/353a4gh1bK.png?imageslim" alt="mark"></p>
<h3 id="点状图"><a href="#点状图" class="headerlink" title="点状图"></a>点状图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=size, fill=type))+geom_dotplot()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/9AElbGEB3G.png?imageslim" alt="mark"></p>
<h3 id="线图"><a href="#线图" class="headerlink" title="线图"></a>线图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">time_cource &lt;- read.csv(&quot;time_course_data.txt&quot;, sep = &quot;,&quot;, quote = &apos;&apos;, stringsAsFactors = TRUE, header = TRUE)</div><div class="line">head(time_cource)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   seconds value sample</div><div class="line">## 1       0  0.00      A</div><div class="line">## 2       1  5.97      A</div><div class="line">## 3       2 13.42      A</div><div class="line">## 4       3 56.08      A</div><div class="line">## 5       4 98.04      A</div><div class="line">## 6       5 27.11      A</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(time_cource, aes(x=seconds, y=value, color=sample))+geom_line()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/kiA5jFAdCK.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(time_cource, aes(x=seconds, y=value, color=sample))+geom_line(size=3)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/bcGfGALGHl.png?imageslim" alt="mark"></p>
<h3 id="饼图"><a href="#饼图" class="headerlink" title="饼图"></a>饼图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">type_counts &lt;- summary(my_data$type)</div><div class="line">type_counts</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">##   Insertion    Deletion   Expansion Contraction </div><div class="line">##        3141        2256        2476        1674</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(RColorBrewer)</div><div class="line">pie(type_counts, col = brewer.pal(length(type_counts), &quot;Set1&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/90jhF097Fl.png?imageslim" alt="mark"></p>
<h3 id="韦恩图"><a href="#韦恩图" class="headerlink" title="韦恩图"></a>韦恩图</h3><p>这里利用四个基因集<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">listA &lt;- read.csv(&quot;genes_list_A.txt&quot;, header = FALSE)</div><div class="line">A &lt;- listA$V1</div><div class="line">listB &lt;- read.csv(&quot;genes_list_B.txt&quot;, header = FALSE)</div><div class="line">B &lt;- listB$V1</div><div class="line">listC &lt;- read.csv(&quot;genes_list_C.txt&quot;, header = FALSE)</div><div class="line">C &lt;- listC$V1</div><div class="line">listD &lt;- read.csv(&quot;genes_list_D.txt&quot;, header = FALSE)</div><div class="line">D &lt;- listD$V1</div><div class="line">library(VennDiagram)</div><div class="line">#注意这个包绘制的图只能直接保存在文件中，无法实时显示</div><div class="line">venn.diagram(list(A=A, B=B, C=C, D=D), fill=c(&quot;yellow&quot;,&quot;red&quot;,&quot;cyan&quot;,&quot;forestgreen&quot;), cex=1.5, filename = &quot;Venn_diagram_genes_4.png&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/AFLB2JBHc7.png?imageslim" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] grid      stats     graphics  grDevices utils     datasets  methods  </div><div class="line">## [8] base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">##  [1] VennDiagram_1.6.18  futile.logger_1.4.3 RColorBrewer_1.1-2 </div><div class="line">##  [4] forcats_0.2.0       stringr_1.2.0       dplyr_0.7.4        </div><div class="line">##  [7] purrr_0.2.4         readr_1.1.1         tidyr_0.7.2        </div><div class="line">## [10] tibble_1.4.2        ggplot2_2.2.1.9000  tidyverse_1.2.1    </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] reshape2_1.4.3       haven_1.1.1          lattice_0.20-35     </div><div class="line">##  [4] colorspace_1.3-2     htmltools_0.3.6      yaml_2.1.16         </div><div class="line">##  [7] rlang_0.1.6          pillar_1.1.0         foreign_0.8-69      </div><div class="line">## [10] glue_1.2.0           lambda.r_1.2         modelr_0.1.1        </div><div class="line">## [13] readxl_1.0.0         bindrcpp_0.2         bindr_0.1           </div><div class="line">## [16] plyr_1.8.4           munsell_0.4.3        gtable_0.2.0        </div><div class="line">## [19] cellranger_1.1.0     rvest_0.3.2          psych_1.7.8         </div><div class="line">## [22] evaluate_0.10.1      labeling_0.3         knitr_1.18          </div><div class="line">## [25] parallel_3.4.3       broom_0.4.3          Rcpp_0.12.15        </div><div class="line">## [28] scales_0.5.0.9000    backports_1.1.2      jsonlite_1.5        </div><div class="line">## [31] mnormt_1.5-5         hms_0.4.1            digest_0.6.14       </div><div class="line">## [34] stringi_1.1.6        rprojroot_1.3-2      cli_1.0.0           </div><div class="line">## [37] tools_3.4.3          magrittr_1.5         lazyeval_0.2.1      </div><div class="line">## [40] futile.options_1.0.0 crayon_1.3.4         pkgconfig_2.0.1     </div><div class="line">## [43] xml2_1.2.0           lubridate_1.7.1      assertthat_0.2.0    </div><div class="line">## [46] rmarkdown_1.8        httr_1.3.1           rstudioapi_0.7      </div><div class="line">## [49] R6_2.2.2             nlme_3.1-131         compiler_3.4.3</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/AFLB2JBHc7.png?imageslim&quot; alt=&quot;veendiagram&quot;&gt;&lt;/p&gt;
&lt;p&gt;前面几节课绘制的图形只有条形图，但是我们科研过程中需要绘制各种各样的图形来展现我们的数据，这节课就主要讲一下利用&lt;strong&gt;ggplot2&lt;/strong&gt;绘制各种图形，这也是&lt;strong&gt;ggplot2&lt;/strong&gt;的魔力所在。相同的数据可以通过不同类型的图形来可视化。本节课主要将绘制以下几类图形：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;条形图&lt;/li&gt;
&lt;li&gt;直方图&lt;/li&gt;
&lt;li&gt;散点图&lt;/li&gt;
&lt;li&gt;箱线图&lt;/li&gt;
&lt;li&gt;小提琴图&lt;/li&gt;
&lt;li&gt;密度图&lt;/li&gt;
&lt;li&gt;点状图&lt;/li&gt;
&lt;li&gt;线图&lt;/li&gt;
&lt;li&gt;饼图&lt;/li&gt;
&lt;li&gt;韦恩图&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 05 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/28/%20Lesson%2005%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/28/ Lesson 05 for Plotting in R for Biologists/</id>
    <published>2018-01-28T04:19:05.000Z</published>
    <updated>2018-02-02T10:45:23.792Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/g2ed2h7ckd.png?imageslim" alt="mark"></p>
<p>这节课作者命名为”Tweaking everything in a plot”。主要是对图形细节进行优化，包括：</p>
<ul>
<li>题目(title)、坐标轴标签、图例标签等</li>
<li>字体</li>
<li>颜色</li>
<li>背景</li>
<li>网格线等</li>
</ul>
<a id="more"></a>
<h2 id="数据加载及清洗"><a href="#数据加载及清洗" class="headerlink" title="数据加载及清洗"></a>数据加载及清洗</h2><p>这部分在上节课已经讲过了，这里就不再详述了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">library(tidyverse)</div><div class="line">library(plyr)</div><div class="line">my_data &lt;- read.csv(&quot;Encode_HMM_data.txt&quot;, sep = &quot;\t&quot;, header = FALSE)</div><div class="line">names(my_data)[1:4] &lt;- c(&quot;chrom&quot;,&quot;start&quot;,&quot;stop&quot;,&quot;type&quot;)</div><div class="line">my_data$chrom &lt;- factor(gsub(&quot;chr&quot;,&quot;&quot;, my_data$chrom, fixed = TRUE), levels = c(seq(1:22),&quot;X&quot;,&quot;Y&quot;))</div><div class="line">my_data &lt;- my_data[my_data$type %in% c(&quot;1_Active_Promoter&quot;,&quot;4_Strong_Enhancer&quot;,&quot;8_Insulator&quot;), ]</div><div class="line">my_data$type &lt;- revalue(my_data$type, c(&quot;1_Active_Promoter&quot;=&quot;Promoter&quot;, &quot;4_Strong_Enhancer&quot;=&quot;Enhancer&quot;,&quot;8_Insulator&quot;=&quot;Insulator&quot;))</div></pre></td></tr></table></figure>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><p>接下来就针对图形进行优化调整</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/L5cljj8kja.png?imageslim" alt="mark"></p>
<h3 id="添加标题"><a href="#添加标题" class="headerlink" title="添加标题"></a>添加标题</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()+labs(title=&quot;Regulatory features by chromosomes&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/gdJ67ALBG6.png?imageslim" alt="mark"></p>
<blockquote>
<p>需要注意的一点是，添加的title默认是位于左上角，如果要居中显示的话最简单的办法就是在标题前添加空格。</p>
</blockquote>
<h3 id="修改坐标轴以及图例标签"><a href="#修改坐标轴以及图例标签" class="headerlink" title="修改坐标轴以及图例标签"></a>修改坐标轴以及图例标签</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+</div><div class="line">  geom_bar()+</div><div class="line">  labs(x=&quot;Chromosome&quot;, y=&quot;Count&quot;, fill=&quot;Feature&quot;)#这里fill是对应ampping里面的fill映射，显示于图例</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/A7i5la4BCJ.png?imageslim" alt="mark"></p>
<h3 id="主题修改"><a href="#主题修改" class="headerlink" title="主题修改"></a>主题修改</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">basic &lt;- ggplot(my_data, aes(x=chrom, fill=type))+</div><div class="line">  geom_bar()+</div><div class="line">  labs(x=&quot;Chromosome&quot;, y=&quot;Count&quot;, fill=&quot;Feature&quot;)</div><div class="line">#设置文本大小</div><div class="line">(basic+theme_gray(base_size = 20))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/9D6dAECeh3.png?imageslim" alt="mark"></p>
<blockquote>
<p>如果想要使得主题适用于所有的图形，可以通过theme_set()进行设置。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">theme_set(theme_gray(base_size = 20))</div><div class="line">basic</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/gbGkg7GcmF.png?imageslim" alt="mark"></p>
<p>恢复默认设置主题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">theme_set(theme_gray())</div><div class="line">basic</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/LaC06a2e4E.png?imageslim" alt="mark"></p>
<h2 id="颜色"><a href="#颜色" class="headerlink" title="颜色"></a>颜色</h2><p>R有个包<strong>RColorNBrewer</strong>提供调色板<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(RColorBrewer)</div><div class="line">display.brewer.all()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/lEAGAHh6gI.png?imageslim" alt="mark"></p>
<p>下面测试一下这些调色板<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+scale_fill_brewer(palette = &quot;Set1&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/B5cHCji0cJ.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+scale_fill_brewer(palette = &quot;Pastel1&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/l9FJI7DLHi.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+scale_fill_brewer(palette = &quot;YlorRd&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/khfcGCelbA.png?imageslim" alt="mark"></p>
<p>不使用调色板的话也可以自己设置颜色，结合取色器的话很是很赞的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+scale_fill_manual(values = c(&quot;green&quot;, &quot;blue&quot;, &quot;red&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/e0J65fm8IL.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(colors())</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">## [1] &quot;white&quot;         &quot;aliceblue&quot;     &quot;antiquewhite&quot;  &quot;antiquewhite1&quot;</div><div class="line">## [5] &quot;antiquewhite2&quot; &quot;antiquewhite3&quot;</div></pre></td></tr></table></figure>
<p>有的时候我们需要很多种颜色，多到一个调色板都满足不了时怎么办？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chrom_plot &lt;- ggplot(my_data, aes(x=type, fill=chrom))+geom_bar()</div><div class="line">chrom_plot</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/4bhEI643Lb.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrom_plot+scale_fill_brewer(type = &quot;qual&quot;, palette = 1)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/mFkFIEJKk7.png?imageslim" alt="mark"></p>
<p><strong>ggplot</strong>默认调用的是rainbpw调色板，颜色容易让人误解，不好分辨，但是其他的调色板颜色数量是不足的。这时可以通过将好几个palette合并在一起组成一个新的palette。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">palette1 &lt;- brewer.pal(9, &quot;Set1&quot;)</div><div class="line">palette1</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">## [1] &quot;#E41A1C&quot; &quot;#377EB8&quot; &quot;#4DAF4A&quot; &quot;#984EA3&quot; &quot;#FF7F00&quot; &quot;#FFFF33&quot; &quot;#A65628&quot;</div><div class="line">## [8] &quot;#F781BF&quot; &quot;#999999&quot;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">palette2 &lt;- brewer.pal(8, &quot;Set2&quot;)</div><div class="line">palette2</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">## [1] &quot;#66C2A5&quot; &quot;#FC8D62&quot; &quot;#8DA0CB&quot; &quot;#E78AC3&quot; &quot;#A6D854&quot; &quot;#FFD92F&quot; &quot;#E5C494&quot;</div><div class="line">## [8] &quot;#B3B3B3&quot;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">palette3 &lt;- brewer.pal(9, &quot;Set3&quot;)</div><div class="line">palette3</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">## [1] &quot;#8DD3C7&quot; &quot;#FFFFB3&quot; &quot;#BEBADA&quot; &quot;#FB8072&quot; &quot;#80B1D3&quot; &quot;#FDB462&quot; &quot;#B3DE69&quot;</div><div class="line">## [8] &quot;#FCCDE5&quot; &quot;#D9D9D9&quot;</div></pre></td></tr></table></figure>
<p>通过饼图来查看一下这几个调色板<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pie(rep(1, length(palette1)), col = palette1)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/12IiLb3k9C.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pie(rep(1, length(palette2)), col = palette2)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/lEmK5k4hBc.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pie(rep(1, length(palette3)), col = palette3)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/64ckLkAA69.png?imageslim" alt="mark"></p>
<p>将这几个色斑合并成一个大的调色板<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">big_palette &lt;- c(palette1, palette2, palette3)</div><div class="line">pie(rep(1, length(big_palette)), col = big_palette)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/Deg5894HDl.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrom_plot+scale_fill_manual(values = big_palette)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/kAAB7AKgfl.png?imageslim" alt="mark"></p>
<p>也可以打乱颜色顺序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrom_plot+scale_fill_manual(values = sample(big_palette))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/lc0I79KfL3.png?imageslim" alt="mark"></p>
<h2 id="字体"><a href="#字体" class="headerlink" title="字体"></a>字体</h2><p>后续大部分调整都是通过theme来实现的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#对所有字体进行调整</div><div class="line">basic+theme_gray(base_size = 24, base_family = &quot;Times New Roman&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/e4F5cgcLj7.png?imageslim" alt="mark"></p>
<p>但是很多时候我们都是对特定字体、标签、颜色等进行特定的调整，这时就可以通过theme逐一调整。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(axis.text = element_text(size=20))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/3kGEkff3f3.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(axis.title = element_text(size = 20))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/ai6HcGJAJc.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.title = element_text(size = 20))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/756Fj36m0m.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.text = element_text(size=20, family = &quot;Times New Roman&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/K43IGFii0k.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.text = element_text(size=20, family = &quot;Times New Roman&quot;),</div><div class="line">            axis.title = element_text(size=30),</div><div class="line">            axis.text = element_text(size=20))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/fej6fe0E22.png?imageslim" alt="mark"></p>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(panel.background = element_rect(fill=&quot;pink&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/blhiiLg5lB.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(panel.background = element_rect(fill=&quot;white&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/06BCjfh0dF.png?imageslim" alt="mark"></p>
<h2 id="网格线"><a href="#网格线" class="headerlink" title="网格线"></a>网格线</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(panel.grid.major = element_line(colour = &quot;blue&quot;), panel.grid.minor = element_line(colour = &quot;red&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/GBe6CG68Ib.png?imageslim" alt="mark"></p>
<h3 id="移除所有的网格线"><a href="#移除所有的网格线" class="headerlink" title="移除所有的网格线"></a>移除所有的网格线</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">basic+theme(panel.grid.major = element_line(NA),</div><div class="line">            panel.grid.minor = element_line(NA))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/eL008ADBkA.png?imageslim" alt="mark"></p>
<h3 id="只保留y轴线"><a href="#只保留y轴线" class="headerlink" title="只保留y轴线"></a>只保留y轴线</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">basic+theme(panel.grid.major.y = element_line(colour = &quot;black&quot;, size = 0.20),</div><div class="line">            panel.grid.major.x = element_line(NA),</div><div class="line">            panel.grid.minor = element_line(NA))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/IBAb1m2be4.png?imageslim" alt="mark"></p>
<h2 id="修改刻度"><a href="#修改刻度" class="headerlink" title="修改刻度"></a>修改刻度</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(axis.ticks = element_line(size=0.2))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/96ckHBC006.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(axis.ticks = element_line(NA))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/FBJ2k0J7bB.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(axis.ticks = element_line(colour = &quot;blue&quot;, size = 2))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/blhAmIg3gF.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">basic+theme(axis.ticks = element_line(size=2),</div><div class="line">            axis.ticks.x = element_line(colour = &quot;blue&quot;),</div><div class="line">            axis.ticks.y = element_line(colour = &quot;red&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/b20AiC7AAC.png?imageslim" alt="mark"></p>
<h2 id="图例"><a href="#图例" class="headerlink" title="图例"></a>图例</h2><h3 id="修改图例位置"><a href="#修改图例位置" class="headerlink" title="修改图例位置"></a>修改图例位置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.position = &quot;top&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/6kJ5DLG298.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.position = &quot;bottom&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/I6GeiH36C1.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.position = c(0,0))#左下角</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/65Gh1EfA0J.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.position = c(1,1))#右上角</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/ci77mHfc1H.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+theme(legend.position = c(0.8,0.8))#通过坐标设置可以将图例置于任意位置</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/eBe2ee3KLB.png?imageslim" alt="mark"></p>
<h3 id="移除图例"><a href="#移除图例" class="headerlink" title="移除图例"></a>移除图例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+labs(fill=&quot;&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/7A21F6hEmD.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+labs(fill=&quot;&quot;)+theme(legend.position = c(0.8,0.8))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/6fg1A8l715.png?imageslim" alt="mark"></p>
<p>看看文章发表样式图形<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">publication_style &lt;- basic+guides(fill=FALSE)+</div><div class="line">  theme(axis.line = element_line(size = 0.5), </div><div class="line">        panel.background = element_rect(fill=NA, size = rel(20)),</div><div class="line">        panel.grid.minor = element_line(colour = NA),</div><div class="line">        axis.text = element_text(size=16),</div><div class="line">        axis.title = element_text(size = 18))</div><div class="line">publication_style</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/LLJ69769c9.png?imageslim" alt="mark"></p>
<p>将柱形图与x轴之间的距离消除<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">publication_style+scale_y_continuous(expand = c(0,0))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/69eLJ7CI2b.png?imageslim" alt="mark"></p>
<p>可以看到上述图形基本达到了文章发表的水平，因此我们可以将主题theme保存下来以后使用，通过设置全局主题来使所有图形有相同版式。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">theme_set(theme_gray()+</div><div class="line">            theme(axis.line = element_line(size = 0.5),</div><div class="line">                  panel.background = element_rect(fill=NA, size = rel(20)),</div><div class="line">                  panel.grid.minor = element_line(colour = NA),</div><div class="line">                  axis.text = element_text(size = 16),</div><div class="line">                  axis.title = element_text(size = 18)))</div><div class="line">basic</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/CK9CgB5Cme.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">basic+scale_y_continuous(expand = c(0,0))+guides(fill=FALSE)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/g2ed2h7ckd.png?imageslim" alt="mark"></p>
<p>如果需要还原主题设定的话，只要运行以下命令就行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">theme_set(theme_gray())</div></pre></td></tr></table></figure></p>
<h2 id="SessionInfO"><a href="#SessionInfO" class="headerlink" title="SessionInfO()"></a>SessionInfO()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">##  [1] RColorBrewer_1.1-2 plyr_1.8.4         forcats_0.2.0     </div><div class="line">##  [4] stringr_1.2.0      dplyr_0.7.4        purrr_0.2.4       </div><div class="line">##  [7] readr_1.1.1        tidyr_0.7.2        tibble_1.4.2      </div><div class="line">## [10] ggplot2_2.2.1.9000 tidyverse_1.2.1   </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.15      cellranger_1.1.0  pillar_1.1.0     </div><div class="line">##  [4] compiler_3.4.3    bindr_0.1         tools_3.4.3      </div><div class="line">##  [7] digest_0.6.14     lubridate_1.7.1   jsonlite_1.5     </div><div class="line">## [10] evaluate_0.10.1   nlme_3.1-131      gtable_0.2.0     </div><div class="line">## [13] lattice_0.20-35   pkgconfig_2.0.1   rlang_0.1.6      </div><div class="line">## [16] psych_1.7.8       cli_1.0.0         rstudioapi_0.7   </div><div class="line">## [19] yaml_2.1.16       parallel_3.4.3    haven_1.1.1      </div><div class="line">## [22] bindrcpp_0.2      xml2_1.2.0        httr_1.3.1       </div><div class="line">## [25] knitr_1.18        hms_0.4.1         rprojroot_1.3-2  </div><div class="line">## [28] grid_3.4.3        glue_1.2.0        R6_2.2.2         </div><div class="line">## [31] readxl_1.0.0      foreign_0.8-69    rmarkdown_1.8    </div><div class="line">## [34] modelr_0.1.1      reshape2_1.4.3    magrittr_1.5     </div><div class="line">## [37] backports_1.1.2   scales_0.5.0.9000 htmltools_0.3.6  </div><div class="line">## [40] rvest_0.3.2       assertthat_0.2.0  mnormt_1.5-5     </div><div class="line">## [43] colorspace_1.3-2  labeling_0.3      stringi_1.1.6    </div><div class="line">## [46] lazyeval_0.2.1    munsell_0.4.3     broom_0.4.3      </div><div class="line">## [49] crayon_1.3.4</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180202/g2ed2h7ckd.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;这节课作者命名为”Tweaking everything in a plot”。主要是对图形细节进行优化，包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;题目(title)、坐标轴标签、图例标签等&lt;/li&gt;
&lt;li&gt;字体&lt;/li&gt;
&lt;li&gt;颜色&lt;/li&gt;
&lt;li&gt;背景&lt;/li&gt;
&lt;li&gt;网格线等&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 04 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/25/%20Lesson%2004%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/25/ Lesson 04 for Plotting in R for Biologists/</id>
    <published>2018-01-25T04:19:05.000Z</published>
    <updated>2018-02-01T13:20:15.633Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/gHcHm3FdLC.png?imageslim" alt="mark"></p>
<p>上次将Lesson 02&amp;03一起讲解完了，在Lesson 04中主要解决下面几个问题</p>
<ul>
<li>剔除掉染色体前缀chr</li>
<li>对染色体进行正确排序</li>
<li>对数据进行过滤</li>
<li>对部分type重命名</li>
</ul>
<a id="more"></a>
<h2 id="加载数据"><a href="#加载数据" class="headerlink" title="加载数据"></a>加载数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(tidyverse)</div><div class="line">my_data &lt;- read.csv(&quot;Encode_HMM_data.txt&quot;, sep = &quot;\t&quot;, header = FALSE)</div><div class="line">head(my_data[, c(1:6)])</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##     V1    V2    V3                V4 V5 V6</div><div class="line">## 1 chr1 10000 10600 15_Repetitive/CNV  0  .</div><div class="line">## 2 chr1 10600 11137 13_Heterochrom/lo  0  .</div><div class="line">## 3 chr1 11137 11737       8_Insulator  0  .</div><div class="line">## 4 chr1 11737 11937       11_Weak_Txn  0  .</div><div class="line">## 5 chr1 11937 12137   7_Weak_Enhancer  0  .</div><div class="line">## 6 chr1 12137 14537       11_Weak_Txn  0  .</div></pre></td></tr></table></figure>
<h3 id="对数据部分列进行重命名"><a href="#对数据部分列进行重命名" class="headerlink" title="对数据部分列进行重命名"></a>对数据部分列进行重命名</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">names(my_data)[1:4] &lt;- c(&quot;chrom&quot;, &quot;start&quot;, &quot;stop&quot;,&quot;type&quot;)</div><div class="line">head(my_data[, c(1:4)])</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   chrom start  stop              type</div><div class="line">## 1  chr1 10000 10600 15_Repetitive/CNV</div><div class="line">## 2  chr1 10600 11137 13_Heterochrom/lo</div><div class="line">## 3  chr1 11137 11737       8_Insulator</div><div class="line">## 4  chr1 11737 11937       11_Weak_Txn</div><div class="line">## 5  chr1 11937 12137   7_Weak_Enhancer</div><div class="line">## 6  chr1 12137 14537       11_Weak_Txn</div></pre></td></tr></table></figure>
<h2 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/j2IB94I12k.png?imageslim" alt="mark"></p>
<h2 id="数据调整"><a href="#数据调整" class="headerlink" title="数据调整"></a>数据调整</h2><p>主要是针对上面提出的几个问题对数据进行调整</p>
<h3 id="剔除染色体前缀chr"><a href="#剔除染色体前缀chr" class="headerlink" title="剔除染色体前缀chr"></a>剔除染色体前缀chr</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">my_data$chrom &lt;- factor(gsub(&quot;chr&quot;, &quot;&quot;, my_data$chrom))</div><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/2ibGfgm9Gg.png?imageslim" alt="mark"></p>
<h3 id="对染色体进行排序"><a href="#对染色体进行排序" class="headerlink" title="对染色体进行排序"></a>对染色体进行排序</h3><p>这个关于人类的基因组数据，所以染色体顺序应该是1：22,X,Y。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">my_data$chrom &lt;- factor(my_data$chrom, levels = c(seq(1:22), &quot;X&quot;, &quot;Y&quot;))</div><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/G0i0aBH43a.png?imageslim" alt="mark"></p>
<p>这下看起来相对好一点</p>
<h3 id="选取type"><a href="#选取type" class="headerlink" title="选取type"></a>选取type</h3><p>只选取我们感兴趣的type进行可视化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">my_data &lt;- my_data[my_data$type %in% c(&quot;1_Active_Promoter&quot;, &quot;4_Strong_Enhancer&quot;, &quot;8_Insulator&quot;), ]</div></pre></td></tr></table></figure>
<h4 id="对选取的type进行重命名"><a href="#对选取的type进行重命名" class="headerlink" title="对选取的type进行重命名"></a>对选取的type进行重命名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(plyr)</div><div class="line">my_data$type &lt;- revalue(my_data$type,c(&quot;1_Active_Promoter&quot;=&quot;Promoter&quot;,&quot;4_Strong_Enhancer&quot;=&quot;Enhancer&quot;,&quot;8_Insulator&quot;=&quot;Insulator&quot;))</div><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/gHcHm3FdLC.png?imageslim" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">##  [1] plyr_1.8.4         forcats_0.2.0      stringr_1.2.0     </div><div class="line">##  [4] dplyr_0.7.4        purrr_0.2.4        readr_1.1.1       </div><div class="line">##  [7] tidyr_0.7.2        tibble_1.4.2       ggplot2_2.2.1.9000</div><div class="line">## [10] tidyverse_1.2.1   </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.15      cellranger_1.1.0  pillar_1.1.0     </div><div class="line">##  [4] compiler_3.4.3    bindr_0.1         tools_3.4.3      </div><div class="line">##  [7] digest_0.6.14     lubridate_1.7.1   jsonlite_1.5     </div><div class="line">## [10] evaluate_0.10.1   nlme_3.1-131      gtable_0.2.0     </div><div class="line">## [13] lattice_0.20-35   pkgconfig_2.0.1   rlang_0.1.6      </div><div class="line">## [16] psych_1.7.8       cli_1.0.0         rstudioapi_0.7   </div><div class="line">## [19] yaml_2.1.16       parallel_3.4.3    haven_1.1.1      </div><div class="line">## [22] bindrcpp_0.2      xml2_1.2.0        httr_1.3.1       </div><div class="line">## [25] knitr_1.18        hms_0.4.1         rprojroot_1.3-2  </div><div class="line">## [28] grid_3.4.3        glue_1.2.0        R6_2.2.2         </div><div class="line">## [31] readxl_1.0.0      foreign_0.8-69    rmarkdown_1.8    </div><div class="line">## [34] modelr_0.1.1      reshape2_1.4.3    magrittr_1.5     </div><div class="line">## [37] backports_1.1.2   scales_0.5.0.9000 htmltools_0.3.6  </div><div class="line">## [40] rvest_0.3.2       assertthat_0.2.0  mnormt_1.5-5     </div><div class="line">## [43] colorspace_1.3-2  labeling_0.3      stringi_1.1.6    </div><div class="line">## [46] lazyeval_0.2.1    munsell_0.4.3     broom_0.4.3      </div><div class="line">## [49] crayon_1.3.4</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/gHcHm3FdLC.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;上次将Lesson 02&amp;amp;03一起讲解完了，在Lesson 04中主要解决下面几个问题&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;剔除掉染色体前缀chr&lt;/li&gt;
&lt;li&gt;对染色体进行正确排序&lt;/li&gt;
&lt;li&gt;对数据进行过滤&lt;/li&gt;
&lt;li&gt;对部分type重命名&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 02&amp;03 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/20/%20Lesson%2002&amp;03%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/20/ Lesson 02&amp;03 for Plotting in R for Biologists/</id>
    <published>2018-01-20T04:19:05.000Z</published>
    <updated>2018-02-01T12:37:07.349Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/dBhf13K3Ge.png?imageslim" alt="mark"></p>
<p>Lesson02主要讲了如何从Excel导入数据以及如何从UCSC、ENSEMBL和RENCODE上下载数据，因此我就将Lesson02并入Lesson03一起讲了。</p>
<a id="more"></a>
<h2 id="从ECXEl中导入数据"><a href="#从ECXEl中导入数据" class="headerlink" title="从ECXEl中导入数据"></a>从ECXEl中导入数据</h2><p>数据来源于文献<a href="https://www.nature.com/articles/1209254" target="_blank" rel="external">“Gene expression profiling of breast cell lines identifies potential new basal markers”</a>的补充数据集Supplementary Table 1。将之下载到工作目录区。数据读取的话只需要用<code>read.csv()</code>即可，指定<code>sep</code>。<strong>gtf</strong>、<strong>bed</strong>文件都可以通过<code>read.csv()</code>读取。即使是没有后缀的文件，只要知道其分隔符，就可以通过设置<code>sep</code>来读取数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">my_data &lt;- read.csv(&quot;micro_array_results_table1.txt&quot;, sep = &apos;\t&apos;, header = TRUE)</div><div class="line">head(my_data[,c(1:6)])</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   Probe.Set.ID Gene.Symbol Type  X184B5 BrCa.MZ.01   BT.20</div><div class="line">## 1    1007_s_at        DDR1 gene 1113.91     815.53 1564.76</div><div class="line">## 2      1053_at        RFC2 gene  159.02     253.24  320.22</div><div class="line">## 3       117_at       HSPA6 gene   60.76      33.91   26.39</div><div class="line">## 4       121_at        PAX8 gene  197.76     121.33  122.81</div><div class="line">## 5    1255_g_at      GUCA1A gene    6.73       7.88    6.28</div><div class="line">## 6      1294_at       UBE1L gene  118.82      57.24  432.24</div></pre></td></tr></table></figure>
<p>试试读取<strong>gtf</strong>文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Brassica_gtf &lt;- read.csv(&quot;E:/Brassica napus database/Brassica_napus.annotation_v5.gtf&quot;, sep = &quot;\t&quot;, header = FALSE)</div><div class="line">head(Brassica_gtf)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##       V1     V2   V3   V4   V5   V6 V7 V8                           V9</div><div class="line">## 1 chrA01 GazeA2 exon  831 1437 7.80  +  . transcript_id BnaA01g00010D;</div><div class="line">## 2 chrA01 GazeA2  CDS 1070 1345    .  +  0 transcript_id BnaA01g00010D;</div><div class="line">## 3 chrA01 GazeA2 exon 1487 2124 2.15  -  . transcript_id BnaA01g00020D;</div><div class="line">## 4 chrA01 GazeA2 exon 2256 2436 3.19  -  . transcript_id BnaA01g00020D;</div><div class="line">## 5 chrA01 GazeA2  CDS 1645 2124    .  -  0 transcript_id BnaA01g00020D;</div><div class="line">## 6 chrA01 GazeA2  CDS 2256 2282    .  -  0 transcript_id BnaA01g00020D;</div></pre></td></tr></table></figure>
<p>其他格式文件我这里就不试了，有兴趣的话可以自己去尝试。</p>
<h2 id="数据探索"><a href="#数据探索" class="headerlink" title="数据探索"></a>数据探索</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">library(tidyverse)</div><div class="line">#读取数据</div><div class="line">my_data &lt;- read.csv(&quot;Encode_HMM_data.txt&quot;, sep = &quot;\t&quot;, header = FALSE)</div><div class="line">dim(my_data)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">## [1] 571339      9</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(my_data[, c(1:6)])</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##     V1    V2    V3                V4 V5 V6</div><div class="line">## 1 chr1 10000 10600 15_Repetitive/CNV  0  .</div><div class="line">## 2 chr1 10600 11137 13_Heterochrom/lo  0  .</div><div class="line">## 3 chr1 11137 11737       8_Insulator  0  .</div><div class="line">## 4 chr1 11737 11937       11_Weak_Txn  0  .</div><div class="line">## 5 chr1 11937 12137   7_Weak_Enhancer  0  .</div><div class="line">## 6 chr1 12137 14537       11_Weak_Txn  0  .</div></pre></td></tr></table></figure>
<p>对数据部分列进行重命名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">names(my_data)[1:4] &lt;- c(&quot;chrom&quot;, &quot;start&quot;, &quot;stop&quot;, &quot;type&quot;)</div></pre></td></tr></table></figure></p>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><p>先初步看一下不同染色体上的type类型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(my_data, aes(x=chrom, fill=type))+geom_bar()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/dBhf13K3Ge.png?imageslim" alt="mark"></p>
<p>从这个图中可以看到还有很多缺陷</p>
<ul>
<li>染色体顺序错乱，前缀chr在坐标轴上排列乱</li>
<li>类型太多了，我们只需要可视化我们感兴趣的type</li>
<li>类型的名字乱</li>
</ul>
<p>这几个问题将在Lesson04解决</p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo()"></a>SessionInfo()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">## [1] forcats_0.2.0      stringr_1.2.0      dplyr_0.7.4       </div><div class="line">## [4] purrr_0.2.4        readr_1.1.1        tidyr_0.7.2       </div><div class="line">## [7] tibble_1.4.2       ggplot2_2.2.1.9000 tidyverse_1.2.1   </div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.15      cellranger_1.1.0  pillar_1.1.0     </div><div class="line">##  [4] compiler_3.4.3    plyr_1.8.4        bindr_0.1        </div><div class="line">##  [7] tools_3.4.3       digest_0.6.14     lubridate_1.7.1  </div><div class="line">## [10] jsonlite_1.5      evaluate_0.10.1   nlme_3.1-131     </div><div class="line">## [13] gtable_0.2.0      lattice_0.20-35   pkgconfig_2.0.1  </div><div class="line">## [16] rlang_0.1.6       psych_1.7.8       cli_1.0.0        </div><div class="line">## [19] rstudioapi_0.7    yaml_2.1.16       parallel_3.4.3   </div><div class="line">## [22] haven_1.1.1       bindrcpp_0.2      xml2_1.2.0       </div><div class="line">## [25] httr_1.3.1        knitr_1.18        hms_0.4.1        </div><div class="line">## [28] rprojroot_1.3-2   grid_3.4.3        glue_1.2.0       </div><div class="line">## [31] R6_2.2.2          readxl_1.0.0      foreign_0.8-69   </div><div class="line">## [34] rmarkdown_1.8     modelr_0.1.1      reshape2_1.4.3   </div><div class="line">## [37] magrittr_1.5      backports_1.1.2   scales_0.5.0.9000</div><div class="line">## [40] htmltools_0.3.6   rvest_0.3.2       assertthat_0.2.0 </div><div class="line">## [43] mnormt_1.5-5      colorspace_1.3-2  labeling_0.3     </div><div class="line">## [46] stringi_1.1.6     lazyeval_0.2.1    munsell_0.4.3    </div><div class="line">## [49] broom_0.4.3       crayon_1.3.4</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/dBhf13K3Ge.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;Lesson02主要讲了如何从Excel导入数据以及如何从UCSC、ENSEMBL和RENCODE上下载数据，因此我就将Lesson02并入Lesson03一起讲了。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
  </entry>
  
  <entry>
    <title>Lesson 01 for Plotting in R for Biologists</title>
    <link href="https://ytlogos.github.io/2018/01/15/%20Lesson%2001%20for%20Plotting%20in%20R%20for%20Biologists/"/>
    <id>https://ytlogos.github.io/2018/01/15/ Lesson 01 for Plotting in R for Biologists/</id>
    <published>2018-01-15T04:19:05.000Z</published>
    <updated>2018-02-01T02:40:18.262Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/f6L6BHLm15.png?imageslim" alt="mark"></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>老早之前就知道了这门课<a href="http://omgenomics.com/plotting-in-r-for-biologists/" target="_blank" rel="external"><strong>Plotting in R for Biologists</strong></a>,一直没有去学习一下，最近花时间看了一遍videos，发现讲的很不错，虽然有一节有一知识点讲的不是很清楚。学了一遍之后记点笔记，这是lesson1的学习笔记。这一节主要讲了数据读取、快速绘图以及图形保存。</p>
<a id="more"></a>
<h2 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(ggplot2)</div><div class="line">filename &lt;- &quot;/home/taoyan/Plotting in R for Biologists/Lesson-01/Encode_HMM_data.txt&quot;</div><div class="line">my_data &lt;- read.csv(filename, sep=&quot;\t&quot;, header=FALSE)</div><div class="line"># 查看一下数据</div><div class="line">head(my_data)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##     V1    V2    V3                V4 V5 V6    V7    V8          V9</div><div class="line">## 1 chr1 10000 10600 15_Repetitive/CNV  0  . 10000 10600 245,245,245</div><div class="line">## 2 chr1 10600 11137 13_Heterochrom/lo  0  . 10600 11137 245,245,245</div><div class="line">## 3 chr1 11137 11737       8_Insulator  0  . 11137 11737  10,190,254</div><div class="line">## 4 chr1 11737 11937       11_Weak_Txn  0  . 11737 11937 153,255,102</div><div class="line">## 5 chr1 11937 12137   7_Weak_Enhancer  0  . 11937 12137   255,252,4</div><div class="line">## 6 chr1 12137 14537       11_Weak_Txn  0  . 12137 14537 153,255,102</div></pre></td></tr></table></figure>
<p>对数据列名重命名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">names(my_data)[1:4] &lt;- c(&quot;chrom&quot;,&quot;start&quot;,&quot;end&quot;,&quot;type&quot;)</div><div class="line">head(my_data)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   chrom start   end              type V5 V6    V7    V8          V9</div><div class="line">## 1  chr1 10000 10600 15_Repetitive/CNV  0  . 10000 10600 245,245,245</div><div class="line">## 2  chr1 10600 11137 13_Heterochrom/lo  0  . 10600 11137 245,245,245</div><div class="line">## 3  chr1 11137 11737       8_Insulator  0  . 11137 11737  10,190,254</div><div class="line">## 4  chr1 11737 11937       11_Weak_Txn  0  . 11737 11937 153,255,102</div><div class="line">## 5  chr1 11937 12137   7_Weak_Enhancer  0  . 11937 12137   255,252,4</div><div class="line">## 6  chr1 12137 14537       11_Weak_Txn  0  . 12137 14537 153,255,102</div></pre></td></tr></table></figure>
<h2 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h2><p>对不同染色体上的不同type绘制柱形图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ggplot(data = my_data, aes(x= chrom, fill= type))+geom_bar()</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/A6geh7Hf22.png?imageslim" alt="mark"></p>
<h2 id="保存"><a href="#保存" class="headerlink" title="保存"></a>保存</h2><p>如果想直接保存图片到文件中，可以用<code>dev.off</code>，R语言支持多种图形类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">png(&quot;Lesson-01/plot.png&quot;)</div><div class="line">ggplot(my_data,aes(x=chrom,fill=type)) + geom_bar()</div><div class="line">dev.off()</div><div class="line"></div><div class="line">tiff(&quot;Lesson-01/plot.tiff&quot;)</div><div class="line">ggplot(my_data,aes(x=chrom,fill=type)) + geom_bar()</div><div class="line">dev.off()</div><div class="line"></div><div class="line">jpeg(&quot;Lesson-01/plot.jpg&quot;)</div><div class="line">ggplot(my_data,aes(x=chrom,fill=type)) + geom_bar()</div><div class="line">dev.off()</div><div class="line"></div><div class="line">pdf(&quot;Lesson-01/plot.pdf&quot;)</div><div class="line">ggplot(my_data,aes(x=chrom,fill=type)) + geom_bar()</div><div class="line">dev.off()</div><div class="line"></div><div class="line"># 设置清晰度</div><div class="line">png(&quot;Lesson-01/plot_hi_res.png&quot;,1000,1000)</div><div class="line">ggplot(my_data,aes(x=chrom,fill=type)) + geom_bar()</div><div class="line">dev.off()</div></pre></td></tr></table></figure>
<p>这节课比较简单，没什么知识点，当然如果R语言没入门的话读个数据都困难重重，所以如果基础不太好的可以直接去youtube看视频，讲的很详细。</p>
<p>##SessionInfo<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-pc-linux-gnu (64-bit)</div><div class="line">## Running under: Ubuntu 17.10</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## BLAS: /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3</div><div class="line">## LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3</div><div class="line">## </div><div class="line">## locale:</div><div class="line">##  [1] LC_CTYPE=zh_CN.UTF-8       LC_NUMERIC=C              </div><div class="line">##  [3] LC_TIME=zh_CN.UTF-8        LC_COLLATE=zh_CN.UTF-8    </div><div class="line">##  [5] LC_MONETARY=zh_CN.UTF-8    LC_MESSAGES=zh_CN.UTF-8   </div><div class="line">##  [7] LC_PAPER=zh_CN.UTF-8       LC_NAME=C                 </div><div class="line">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </div><div class="line">## [11] LC_MEASUREMENT=zh_CN.UTF-8 LC_IDENTIFICATION=C       </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">## [1] ggplot2_2.2.1</div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] Rcpp_0.12.14     digest_0.6.14    rprojroot_1.3-2  plyr_1.8.4      </div><div class="line">##  [5] grid_3.4.3       gtable_0.2.0     backports_1.1.2  magrittr_1.5    </div><div class="line">##  [9] evaluate_0.10.1  scales_0.5.0     pillar_1.1.0     rlang_0.1.6     </div><div class="line">## [13] stringi_1.1.6    lazyeval_0.2.1   rmarkdown_1.8    labeling_0.3    </div><div class="line">## [17] tools_3.4.3      stringr_1.2.0    munsell_0.4.3    yaml_2.1.16     </div><div class="line">## [21] compiler_3.4.3   colorspace_1.3-2 htmltools_0.3.6  knitr_1.18      </div><div class="line">## [25] tibble_1.4.1</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180201/f6L6BHLm15.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;老早之前就知道了这门课&lt;a href=&quot;http://omgenomics.com/plotting-in-r-for-biologists/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;strong&gt;Plotting in R for Biologists&lt;/strong&gt;&lt;/a&gt;,一直没有去学习一下，最近花时间看了一遍videos，发现讲的很不错，虽然有一节有一知识点讲的不是很清楚。学了一遍之后记点笔记，这是lesson1的学习笔记。这一节主要讲了数据读取、快速绘图以及图形保存。&lt;/p&gt;
    
    </summary>
    
      <category term="可视化" scheme="https://ytlogos.github.io/categories/%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
    
      <category term="Biologists" scheme="https://ytlogos.github.io/tags/Biologists/"/>
    
  </entry>
  
  <entry>
    <title>一步步教你如何绘制GWAS中的曼哈顿图以及QQ图</title>
    <link href="https://ytlogos.github.io/2018/01/11/%E4%B8%80%E6%AD%A5%E6%AD%A5%E6%95%99%E4%BD%A0%E5%A6%82%E4%BD%95%E7%BB%98%E5%88%B6GWAS%E4%B8%AD%E7%9A%84%E6%9B%BC%E5%93%88%E9%A1%BF%E5%9B%BE%E4%BB%A5%E5%8F%8AQQ%E5%9B%BE/"/>
    <id>https://ytlogos.github.io/2018/01/11/一步步教你如何绘制GWAS中的曼哈顿图以及QQ图/</id>
    <published>2018-01-11T04:19:05.000Z</published>
    <updated>2018-01-11T04:22:08.954Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/EE3ce1m2L2.png?imageslim" alt="mark"></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>GWAS研究中的曼哈顿图以及QQ图可以说是标配了，至于具体如何理解这两个图，可以参考我以前的博客。上周我利用自己的数据跑了个GWAS，我是利用<strong>GAPIT</strong>跑的，出的图感觉真心丑，大家可以看看：<br><a id="more"></a></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/iAm97eG6FD.png?imageslim" alt="Manhattan plot"><br><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/im6b1iJ7FE.png?imageslim" alt="QQ plot"></p>
<p>所以我利用<strong>GAPIT</strong>出来的数据重新画了图，用的就是包<strong>qqman</strong>。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>Github主页上提供了三种安装方式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Install the stable release from CRAn</div><div class="line">install.packages(&quot;qqman&quot;)</div><div class="line"># 直接从Github上安装</div><div class="line">devtools::install_github(&quot;stephenturner/qqman&quot;)</div><div class="line"># 从Github上安装最新的开发版</div><div class="line">devtools::install_github(&quot;stephenturner/qqman&quot;,ref=&quot;dev&quot;)</div></pre></td></tr></table></figure></p>
<h2 id="数据格式"><a href="#数据格式" class="headerlink" title="数据格式"></a>数据格式</h2><p><strong>qqman</strong>里内置了一套数据集<code>gwasResults</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(qqman)</div><div class="line">dim(gwasResults)</div><div class="line">## [1] 16470     4</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(gwasResults)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   SNP CHR BP         P</div><div class="line">## 1 rs1   1  1 0.9148060</div><div class="line">## 2 rs2   1  2 0.9370754</div><div class="line">## 3 rs3   1  3 0.2861395</div><div class="line">## 4 rs4   1  4 0.8304476</div><div class="line">## 5 rs5   1  5 0.6417455</div><div class="line">## 6 rs6   1  6 0.5190959</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">str(gwasResults)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">## &apos;data.frame&apos;:    16470 obs. of  4 variables:</div><div class="line">##  $ SNP: chr  &quot;rs1&quot; &quot;rs2&quot; &quot;rs3&quot; &quot;rs4&quot; ...</div><div class="line">##  $ CHR: int  1 1 1 1 1 1 1 1 1 1 ...</div><div class="line">##  $ BP : int  1 2 3 4 5 6 7 8 9 10 ...</div><div class="line">##  $ P  : num  0.915 0.937 0.286 0.83 0.642 ...</div></pre></td></tr></table></figure>
<p>可以看到该数据集共有16470行，4列，分别为SNP名、染色体、SNP位置以及P值。<br>该数据集不大，SNP标记十分少，通过每条染色体上的SNP标记可以看出<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">as.data.frame(table(gwasResults$CHR))</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">##    Var1 Freq</div><div class="line">## 1     1 1500</div><div class="line">## 2     2 1191</div><div class="line">## 3     3 1040</div><div class="line">## 4     4  945</div><div class="line">## 5     5  877</div><div class="line">## 6     6  825</div><div class="line">## 7     7  784</div><div class="line">## 8     8  750</div><div class="line">## 9     9  721</div><div class="line">## 10   10  696</div><div class="line">## 11   11  674</div><div class="line">## 12   12  655</div><div class="line">## 13   13  638</div><div class="line">## 14   14  622</div><div class="line">## 15   15  608</div><div class="line">## 16   16  595</div><div class="line">## 17   17  583</div><div class="line">## 18   18  572</div><div class="line">## 19   19  562</div><div class="line">## 20   20  553</div><div class="line">## 21   21  544</div><div class="line">## 22   22  535</div></pre></td></tr></table></figure>
<h2 id="Manhattan-plot"><a href="#Manhattan-plot" class="headerlink" title="Manhattan plot"></a>Manhattan plot</h2><p><strong>qqman</strong>提供了一个绘制Manhattan plot的函数<code>manhattan()</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(gwasResults)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/h6dGbBmlkI.png?imageslim" alt="mark"></p>
<p><code>manhattan()</code>提供了大量的参数设置：标题(main=)、y轴范围(ylim=)、控制点的大小(cex=)、x轴坐标轴标签的字体大小(cex.axis=)、颜色(col=)、阈值参考线控制(suggestiveline=, genomewideline=)、以及添加注释信息等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(gwasResults, main=&quot;Manhattan plot&quot;, ylim=c(0, 10), cex=0.6, cex.axis=0.9, col = c(&quot;blue&quot;,&quot;orange&quot;), suggestiveline = F, genomewideline = F, chrlabs = c(1:20, &quot;P&quot;,&quot;Q&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/LHmie5lJJI.png?imageslim" alt="mark"></p>
<p>还提供针对一条染色体数据进行绘图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(subset(gwasResults, CHR==3))</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/a7062c4K9L.png?imageslim" alt="mark"></p>
<p>对有显著性影响的SNP进行高亮(没有的话会忽略掉)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(gwasResults, highlight = snpsOfInterest)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/e3lD9c1706.png?imageslim" alt="mark"></p>
<p>针对特定染色体以及特定区间进行高亮<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(subset(gwasResults, CHR==3), highlight=snpsOfInterest, xlim=c(200, 500), main=&quot;Chr 3&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/el9mh4j8mJ.png?imageslim" alt="mark"></p>
<p><code>manhattan</code>注释的时候默认注释每条染色体中P值最小且超过我们设定的p值阈值的SNP点，默认的P值阈值为0.01<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(gwasResults, annotatePval = 0.01)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/36G2LmhlCm.png?imageslim" alt="mark"></p>
<p>我们可以通过自行设定参数注释所有超过P值阈值的SNP点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(gwasResults, annotatePval = 0.001, annotateTop = FALSE)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/0f84LHbID9.png?imageslim" alt="mark"></p>
<p><code>manhattan</code>可以绘制任意的value值，不限于p-value，只需要在设置中指定value值就行了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gwasResults &lt;- transform(gwasResults, zscore=qnorm(P/2, lower.tail = FALSE))</div><div class="line">head(gwasResults)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">##   SNP CHR BP         P    zscore</div><div class="line">## 1 rs1   1  1 0.9148060 0.1069785</div><div class="line">## 2 rs2   1  2 0.9370754 0.0789462</div><div class="line">## 3 rs3   1  3 0.2861395 1.0666287</div><div class="line">## 4 rs4   1  4 0.8304476 0.2141275</div><div class="line">## 5 rs5   1  5 0.6417455 0.4652597</div><div class="line">## 6 rs6   1  6 0.5190959 0.6447396</div></pre></td></tr></table></figure>
<p>接下来利用value值zscore来绘制图形<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">manhattan(gwasResults, p = &quot;zscore&quot;, logp = FALSE, ylab=&quot;Z-score&quot;, genomewideline = FALSE, suggestiveline = FALSE, main=&quot;Manhattan plot of Z-scores&quot;)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/d5K199L3lh.png?imageslim" alt="mark"></p>
<p>需要注意的几点：</p>
<ul>
<li>数据集列名默认是SNP、CHR、BP和P，因此如何自己的数据集列名与此不一致的话，要么转为一致，要么绘图时指定chr=、bp=、p=和snp=。具体情况可见help(manhattan)。</li>
<li>染色体编号那一列必须是数值型，如果数据集中有”X”、”Y”以及”MT”等染色体，想要转为数值型编号再在绘图时指定坐标名</li>
<li><code>manhattan</code>只提供了修改snp点的颜色参数，如果要修改阈值线、高亮、注释等的颜色，需要修改源码。</li>
</ul>
<h2 id="QQ图"><a href="#QQ图" class="headerlink" title="QQ图"></a>QQ图</h2><p><strong>qqman</strong>提供了绘制QQ图的函数<code>qq()</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qq(gwasResults)</div></pre></td></tr></table></figure>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/25aI37Ld3g.png?imageslim" alt="mark"></p>
<p>通过参数设置可以指定点的类型、大小、颜色等<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qq(gwasResults$P, main=&quot;Q-Q plot of GWAS p-value&quot;, xlim=c(0,7), ylim=c(0,12), pch=18, col = &quot;blue4&quot;, cex=1.5, las=1)</div></pre></td></tr></table></figure></p>
<p><img src="http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/9hlig1ajam.png?imageslim" alt="mark"></p>
<h2 id="SessionInfo"><a href="#SessionInfo" class="headerlink" title="SessionInfo"></a>SessionInfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">## R version 3.4.3 (2017-11-30)</div><div class="line">## Platform: x86_64-w64-mingw32/x64 (64-bit)</div><div class="line">## Running under: Windows 10 x64 (build 16299)</div><div class="line">## </div><div class="line">## Matrix products: default</div><div class="line">## </div><div class="line">## locale:</div><div class="line">## [1] LC_COLLATE=Chinese (Simplified)_China.936 </div><div class="line">## [2] LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">## [3] LC_MONETARY=Chinese (Simplified)_China.936</div><div class="line">## [4] LC_NUMERIC=C                              </div><div class="line">## [5] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line">## </div><div class="line">## attached base packages:</div><div class="line">## [1] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line">## </div><div class="line">## other attached packages:</div><div class="line">## [1] qqman_0.1.3</div><div class="line">## </div><div class="line">## loaded via a namespace (and not attached):</div><div class="line">##  [1] compiler_3.4.3  backports_1.1.2 magrittr_1.5    rprojroot_1.3-2</div><div class="line">##  [5] tools_3.4.3     htmltools_0.3.6 yaml_2.1.16     Rcpp_0.12.14   </div><div class="line">##  [9] calibrate_1.7.2 stringi_1.1.6   rmarkdown_1.8   knitr_1.18     </div><div class="line">## [13] stringr_1.2.0   digest_0.6.13   evaluate_0.10.1</div></pre></td></tr></table></figure>
<hr>
<h2 id="联系方式："><a href="#联系方式：" class="headerlink" title="联系方式："></a>联系方式：</h2><p>wechat: yt056410<br>Email: tyan@zju.edu.cn<br>QQ: 1051927088<br>GitHub: <a href="https://github.com/YTLogos" target="_blank" rel="external">https://github.com/YTLogos</a><br>JianShu: <a href="http://www.jianshu.com/u/bd001545cf0b" target="_blank" rel="external">http://www.jianshu.com/u/bd001545cf0b</a><br>Blog: <a href="https://ytlogos.github.io/">https://ytlogos.github.io/</a></p>
<h2 id="个人简介："><a href="#个人简介：" class="headerlink" title="个人简介："></a>个人简介：</h2><p>严涛<br>浙江大学作物遗传育种在读研究生（生物信息学方向）<br>伪码农，R语言爱好者，爱开源</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://ov520p4qw.bkt.clouddn.com/ytlogos/180111/EE3ce1m2L2.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;GWAS研究中的曼哈顿图以及QQ图可以说是标配了，至于具体如何理解这两个图，可以参考我以前的博客。上周我利用自己的数据跑了个GWAS，我是利用&lt;strong&gt;GAPIT&lt;/strong&gt;跑的，出的图感觉真心丑，大家可以看看：&lt;br&gt;
    
    </summary>
    
      <category term="GWAS" scheme="https://ytlogos.github.io/categories/GWAS/"/>
    
    
      <category term="GWAS" scheme="https://ytlogos.github.io/tags/GWAS/"/>
    
      <category term="QQ Plot" scheme="https://ytlogos.github.io/tags/QQ-Plot/"/>
    
      <category term="Manhattan Plot" scheme="https://ytlogos.github.io/tags/Manhattan-Plot/"/>
    
  </entry>
  
</feed>
